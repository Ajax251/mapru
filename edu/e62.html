<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <title>–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ü–ª–∞–Ω–µ—Ç –°–æ–ª–Ω–µ—á–Ω–æ–π –°–∏—Å—Ç–µ–º—ã</title>
  <style>
    :root {
      --panel-bg: rgba(8, 12, 21, 0.95);
      --panel-border: rgba(255, 255, 255, 0.1);
      --cyan: #00d4ff;
      --cyan-dark: #0099cc;
      --gold: #ffc107;
      --danger: #ff4757;
      --success: #2ed573;
      --glass: rgba(255, 255, 255, 0.03);
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body {
      width: 100%; height: 100%; overflow: hidden; background: #000;
      font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    }
    canvas { display: block; }
    #header {
      position: absolute; top: 30px; left: 50%; transform: translateX(-50%); color: white;
      text-align: center; z-index: 10; pointer-events: none;
    }
    #header h1 {
      font-size: 32px; font-weight: 200; letter-spacing: 8px;
      background: linear-gradient(135deg, #fff 0%, var(--cyan) 50%, #fff 100%);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
      margin-bottom: 8px;
    }
    #header p {
      font-size: 12px; color: rgba(255, 255, 255, 0.4); letter-spacing: 3px; text-transform: uppercase;
    }
    #ui {
      position: absolute; top: 30px; right: 30px; background: var(--panel-bg); padding: 24px;
      border-radius: 20px; border: 1px solid var(--panel-border); color: white; width: 300px;
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(20px); z-index: 10;
    }
    .ui-title {
      font-size: 11px; color: var(--cyan); margin-bottom: 18px; text-transform: uppercase;
      letter-spacing: 3px; font-weight: 600; display: flex; align-items: center; gap: 10px;
    }
    .ui-title::before {
      content: ''; width: 20px; height: 1px;
      background: linear-gradient(90deg, var(--cyan), transparent);
    }
    .planet-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-bottom: 20px; }
    .planet-btn {
      background: var(--glass); border: 1px solid rgba(255, 255, 255, 0.08);
      color: rgba(255, 255, 255, 0.8); padding: 14px 10px; border-radius: 12px;
      cursor: pointer; font-size: 13px; font-weight: 500;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative; overflow: hidden;
    }
    .planet-btn::after {
      content: ''; position: absolute; inset: 0;
      background: linear-gradient(135deg, var(--cyan), transparent);
      opacity: 0; transition: opacity 0.4s;
    }
    .planet-btn:hover {
      border-color: var(--cyan); color: white; transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(0, 212, 255, 0.2);
    }
    .planet-btn:hover::after { opacity: 0.1; }
    .planet-btn.added {
      background: rgba(46, 213, 115, 0.15); border-color: var(--success); color: var(--success);
    }
    .planet-btn.added::before {
      content: '‚úì'; position: absolute; right: 10px; top: 50%;
      transform: translateY(-50%); font-size: 12px;
    }
    .control-btn {
      width: 100%; background: transparent; border: 1px solid rgba(255, 71, 87, 0.4);
      color: var(--danger); padding: 14px; border-radius: 12px; cursor: pointer;
      font-size: 13px; font-weight: 500; transition: all 0.3s; margin-top: 5px;
    }
    .control-btn:hover {
      background: var(--danger); color: white; border-color: var(--danger);
      box-shadow: 0 10px 30px rgba(255, 71, 87, 0.3);
    }
    .modal-overlay {
      position: fixed; inset: 0; background: rgba(0, 0, 0, 0.8); backdrop-filter: blur(10px);
      z-index: 100; opacity: 0; visibility: hidden; transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex; align-items: center; justify-content: center;
    }
    .modal-overlay.visible { opacity: 1; visibility: visible; }
    .modal-content {
      background: linear-gradient(180deg, rgba(15, 25, 40, 0.98) 0%, rgba(8, 12, 21, 0.98) 100%);
      border-radius: 28px; border: 1px solid rgba(255, 255, 255, 0.1); max-width: 700px;
      width: 90%; max-height: 85vh; overflow-y: auto;
      transform: scale(0.9) translateY(30px); transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 50px 100px rgba(0, 0, 0, 0.6), 0 0 100px rgba(0, 212, 255, 0.1);
    }
    .modal-overlay.visible .modal-content { transform: scale(1) translateY(0); }
    .modal-header {
      padding: 40px 40px 30px; position: relative;
      background: linear-gradient(180deg, rgba(0, 212, 255, 0.08) 0%, transparent 100%);
    }
    .modal-header::after {
      content: ''; position: absolute; bottom: 0; left: 40px; right: 40px; height: 1px;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
    }
    .planet-title { font-size: 42px; font-weight: 200; letter-spacing: 4px; color: white; margin-bottom: 8px; }
    .planet-subtitle { font-size: 13px; color: var(--cyan); letter-spacing: 3px; text-transform: uppercase; font-weight: 500; }
    .close-modal {
      position: absolute; top: 25px; right: 25px; width: 44px; height: 44px;
      background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 50%; color: rgba(255, 255, 255, 0.6); font-size: 24px; cursor: pointer;
      display: flex; align-items: center; justify-content: center; transition: all 0.3s;
    }
    .close-modal:hover {
      background: rgba(255, 71, 87, 0.2); border-color: var(--danger); color: var(--danger);
      transform: rotate(90deg);
    }
    .modal-body { padding: 30px 40px 40px; }
    .stats-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 30px; }
    .stat-card {
      background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(255, 255, 255, 0.06);
      border-radius: 16px; padding: 20px; transition: all 0.3s;
    }
    .stat-card:hover {
      background: rgba(0, 212, 255, 0.05); border-color: rgba(0, 212, 255, 0.2);
      transform: translateY(-3px);
    }
    .stat-icon {
      width: 36px; height: 36px; border-radius: 10px;
      background: linear-gradient(135deg, var(--cyan), var(--cyan-dark));
      display: flex; align-items: center; justify-content: center;
      margin-bottom: 12px; font-size: 16px;
    }
    .stat-label {
      font-size: 10px; color: rgba(255, 255, 255, 0.4); text-transform: uppercase;
      letter-spacing: 1.5px; margin-bottom: 6px;
    }
    .stat-value { font-size: 15px; color: white; font-weight: 500; line-height: 1.4; }
    .fact-card {
      background: linear-gradient(135deg, rgba(0, 212, 255, 0.1) 0%, rgba(0, 212, 255, 0.02) 100%);
      border: 1px solid rgba(0, 212, 255, 0.2); border-radius: 16px; padding: 25px;
      position: relative; overflow: hidden;
    }
    .fact-card::before {
      content: '"'; position: absolute; top: -10px; left: 15px; font-size: 80px;
      color: rgba(0, 212, 255, 0.15); font-family: Georgia, serif; line-height: 1;
    }
    .fact-title {
      font-size: 11px; color: var(--cyan); text-transform: uppercase; letter-spacing: 2px;
      margin-bottom: 12px; font-weight: 600;
    }
    .fact-text { font-size: 14px; color: rgba(255, 255, 255, 0.8); line-height: 1.8; position: relative; z-index: 1; }
    #hints {
      position: absolute; bottom: 30px; left: 30px; color: rgba(255, 255, 255, 0.3);
      font-size: 11px; z-index: 5; line-height: 2;
    }
    .hint-item { display: flex; align-items: center; gap: 10px; }
    .hint-key {
      background: rgba(255, 255, 255, 0.08); padding: 4px 10px; border-radius: 6px;
      font-family: 'SF Mono', monospace; font-size: 10px; color: rgba(255, 255, 255, 0.5);
    }
    .planet-counter {
      display: flex; align-items: center; justify-content: center; gap: 8px; padding: 12px;
      background: rgba(0, 212, 255, 0.08); border-radius: 12px; margin-bottom: 15px;
      border: 1px solid rgba(0, 212, 255, 0.15);
    }
    .counter-value { font-size: 24px; font-weight: 300; color: var(--cyan); }
    .counter-label { font-size: 11px; color: rgba(255, 255, 255, 0.5); text-transform: uppercase; letter-spacing: 1px; }
    @media (max-width: 768px) {
      #ui { top: auto; bottom: 20px; right: 10px; left: 10px; width: auto; padding: 20px; }
      .planet-grid { grid-template-columns: repeat(4, 1fr); gap: 8px; }
      .planet-btn { padding: 10px 6px; font-size: 11px; }
      #header h1 { font-size: 22px; letter-spacing: 4px; }
      .stats-grid { grid-template-columns: repeat(2, 1fr); }
      .modal-header { padding: 30px 25px 20px; }
      .modal-body { padding: 20px 25px 30px; }
      .planet-title { font-size: 28px; }
      #hints { display: none; }
    }
  </style>
</head>
<body>

  <div id="header">
    <h1>–°–û–õ–ù–ï–ß–ù–ê–Ø –°–ò–°–¢–ï–ú–ê</h1>
    <p>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–æ–≤ –ø–ª–∞–Ω–µ—Ç</p>
  </div>

  <div id="hints">
    <div class="hint-item"><span class="hint-key">–õ–ö–ú + –¥–≤–∏–∂–µ–Ω–∏–µ</span> –í—Ä–∞—â–µ–Ω–∏–µ</div>
    <div class="hint-item"><span class="hint-key">–ö–æ–ª–µ—Å–æ</span> –ú–∞—Å—à—Ç–∞–±</div>
    <div class="hint-item"><span class="hint-key">–î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫</span> –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>
  </div>

  <div id="ui">
    <div class="ui-title">–í—ã–±–µ—Ä–∏—Ç–µ –ø–ª–∞–Ω–µ—Ç—ã</div>
    <div class="planet-counter">
      <span class="counter-value" id="planetCount">0</span>
      <span class="counter-label">–≤—ã–±—Ä–∞–Ω–æ</span>
    </div>
    <div class="planet-grid" id="planetButtons"></div>
    <button class="control-btn" onclick="clearAll()">‚ü≤ –°–±—Ä–æ—Å–∏—Ç—å –≤—ã–±–æ—Ä</button>
  </div>

  <div class="modal-overlay" id="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="planet-title" id="modalTitle"></h2>
        <p class="planet-subtitle" id="modalSubtitle"></p>
        <button class="close-modal" onclick="closeModal()">√ó</button>
      </div>
      <div class="modal-body">
        <div class="stats-grid" id="statsGrid"></div>
        <div class="fact-card">
          <div class="fact-title">–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç</div>
          <p class="fact-text" id="factText"></p>
        </div>
      </div>
    </div>
  </div>

  <script type="importmap">
    { "imports": { "three": "https://unpkg.com/three@0.160.0/build/three.module.js", "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/" } }
  </script>

  <script type="module">
    import * as THREE from "three";
    import { OrbitControls } from "three/addons/controls/OrbitControls.js";
    import { UnrealBloomPass } from "three/addons/postprocessing/UnrealBloomPass.js";
    import { EffectComposer } from "three/addons/postprocessing/EffectComposer.js";
    import { RenderPass } from "three/addons/postprocessing/RenderPass.js";

    const loadingManager = new THREE.LoadingManager();
    const textureLoader = new THREE.TextureLoader(loadingManager);

    const PLANETS = {
      –ú–µ—Ä–∫—É—Ä–∏–π: { order: 1, radius: 2439, tex: 'textures/mercury2.jpg', bump: 'textures/mercury2.jpg', type: '–ü–ª–∞–Ω–µ—Ç–∞ –∑–µ–º–Ω–æ–π –≥—Ä—É–ø–ø—ã', info: { mass: '3.3 √ó 10¬≤¬≥ –∫–≥', temp: '-173¬∞C –¥–æ +427¬∞C', day: '58.6 –∑–µ–º–Ω—ã—Ö —Å—É—Ç–æ–∫', distance: '57.9 –º–ª–Ω –∫–º –æ—Ç –°–æ–ª–Ω—Ü–∞', fact: '–ú–µ—Ä–∫—É—Ä–∏–π ‚Äî —Å–∞–º–∞—è –±—ã—Å—Ç—Ä–∞—è –ø–ª–∞–Ω–µ—Ç–∞, —Å–æ–≤–µ—Ä—à–∞—é—â–∞—è –æ–±–æ—Ä–æ—Ç –≤–æ–∫—Ä—É–≥ –°–æ–ª–Ω—Ü–∞ –∑–∞ 88 –∑–µ–º–Ω—ã—Ö –¥–Ω–µ–π. –£ –Ω–µ—ë –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ—Ç –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã, –ø–æ—ç—Ç–æ–º—É —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∫–æ–ª–µ–±–ª–µ—Ç—Å—è –æ—Ç —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ —Ö–æ–ª–æ–¥–Ω–æ–π –¥–æ –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ –∂–∞—Ä–∫–æ–π.' } },
      –í–µ–Ω–µ—Ä–∞: { order: 2, radius: 6051, tex: 'textures/venus.jpg', bump: 'textures/venus.jpg', glow: 0xffaa55, type: '–ü–ª–∞–Ω–µ—Ç–∞ –∑–µ–º–Ω–æ–π –≥—Ä—É–ø–ø—ã', info: { mass: '4.87 √ó 10¬≤‚Å¥ –∫–≥', temp: '+462¬∞C (—Å—Ä–µ–¥–Ω—è—è)', day: '243 –∑–µ–º–Ω—ã—Ö —Å—É—Ç–æ–∫', distance: '108.2 –º–ª–Ω –∫–º –æ—Ç –°–æ–ª–Ω—Ü–∞', fact: '–í–µ–Ω–µ—Ä–∞ ‚Äî —Å–∞–º–∞—è –≥–æ—Ä—è—á–∞—è –ø–ª–∞–Ω–µ—Ç–∞ –°–æ–ª–Ω–µ—á–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –±–ª–∞–≥–æ–¥–∞—Ä—è –ø–ª–æ—Ç–Ω–æ–π –∞—Ç–º–æ—Å—Ñ–µ—Ä–µ –∏–∑ —É–≥–ª–µ–∫–∏—Å–ª–æ–≥–æ –≥–∞–∑–∞, —Å–æ–∑–¥–∞—é—â–µ–π —Å–∏–ª—å–Ω–µ–π—à–∏–π –ø–∞—Ä–Ω–∏–∫–æ–≤—ã–π —ç—Ñ—Ñ–µ–∫—Ç. –û–Ω–∞ –≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –∏ –æ–¥–∏–Ω –¥–µ–Ω—å —Ç–∞–º –¥–ª–∏–Ω–Ω–µ–µ –≥–æ–¥–∞!' } },
      –ó–µ–º–ª—è: { order: 3, radius: 6371, tex: 'textures/earth-blue-marble.jpg', spec: 'textures/earth2.jpg', glow: 0x4488ff, type: '–ü–ª–∞–Ω–µ—Ç–∞ –∑–µ–º–Ω–æ–π –≥—Ä—É–ø–ø—ã', info: { mass: '5.97 √ó 10¬≤‚Å¥ –∫–≥', temp: '-89¬∞C –¥–æ +58¬∞C', day: '24 —á–∞—Å–∞', distance: '149.6 –º–ª–Ω –∫–º –æ—Ç –°–æ–ª–Ω—Ü–∞', fact: '–ó–µ–º–ª—è ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –∏–∑–≤–µ—Å—Ç–Ω–∞—è –ø–ª–∞–Ω–µ—Ç–∞ —Å –∂–∏–¥–∫–æ–π –≤–æ–¥–æ–π –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –∏ –∂–∏–∑–Ω—å—é. –û–∫–æ–ª–æ 71% –µ—ë –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –ø–æ–∫—Ä—ã—Ç–æ –æ–∫–µ–∞–Ω–∞–º–∏, –∞ –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –∫–æ—Å–º–∏—á–µ—Å–∫–æ–π —Ä–∞–¥–∏–∞—Ü–∏–∏.' } },
      –õ—É–Ω–∞: { order: 3.5, radius: 1737, tex: 'textures/moon.png', bump: 'textures/moon.png', type: '–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø—É—Ç–Ω–∏–∫', info: { mass: '7.35 √ó 10¬≤¬≤ –∫–≥', temp: '-173¬∞C –¥–æ +127¬∞C', day: '27.3 –∑–µ–º–Ω—ã—Ö —Å—É—Ç–æ–∫', distance: '384 400 –∫–º –æ—Ç –ó–µ–º–ª–∏', fact: '–õ—É–Ω–∞ ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø—É—Ç–Ω–∏–∫ –ó–µ–º–ª–∏ –∏ –ø—è—Ç—ã–π –ø–æ –≤–µ–ª–∏—á–∏–Ω–µ —Å–ø—É—Ç–Ω–∏–∫ –≤ –°–æ–ª–Ω–µ—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ. –û–Ω–∞ –≤—Å–µ–≥–¥–∞ –ø–æ–≤—ë—Ä–Ω—É—Ç–∞ –∫ –ó–µ–º–ª–µ –æ–¥–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω–æ–π –∏–∑-–∑–∞ –ø—Ä–∏–ª–∏–≤–Ω–æ–≥–æ –∑–∞—Ö–≤–∞—Ç–∞. –õ—É–Ω–Ω—ã–µ –º–æ—Ä—è ‚Äî —ç—Ç–æ –∑–∞—Å—Ç—ã–≤—à–∞—è –ª–∞–≤–∞ –¥—Ä–µ–≤–Ω–∏—Ö –∏–∑–≤–µ—Ä–∂–µ–Ω–∏–π.' } },
      –ú–∞—Ä—Å: { order: 4, radius: 3389, tex: 'textures/mars.jpg', bump: 'textures/mars2.jpg', glow: 0xff6644, type: '–ü–ª–∞–Ω–µ—Ç–∞ –∑–µ–º–Ω–æ–π –≥—Ä—É–ø–ø—ã', info: { mass: '6.42 √ó 10¬≤¬≥ –∫–≥', temp: '-87¬∞C –¥–æ -5¬∞C', day: '24.6 —á–∞—Å–∞', distance: '227.9 –º–ª–Ω –∫–º –æ—Ç –°–æ–ª–Ω—Ü–∞', fact: '–ú–∞—Ä—Å –∏–∑–≤–µ—Å—Ç–µ–Ω –∫–∞–∫ "–ö—Ä–∞—Å–Ω–∞—è –ø–ª–∞–Ω–µ—Ç–∞" –∏–∑-–∑–∞ –æ–∫—Å–∏–¥–∞ –∂–µ–ª–µ–∑–∞ –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏. –ù–∞ –Ω—ë–º –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Å–∞–º–∞—è –≤—ã—Å–æ–∫–∞—è –≥–æ—Ä–∞ –≤ –°–æ–ª–Ω–µ—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ ‚Äî –û–ª–∏–º–ø (21 –∫–º). –£—á—ë–Ω—ã–µ –∏—â—É—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏ –¥—Ä–µ–≤–Ω–µ–π –∂–∏–∑–Ω–∏ –≤ –º–∞—Ä—Å–∏–∞–Ω—Å–∫–∏—Ö –∫—Ä–∞—Ç–µ—Ä–∞—Ö.' } },
      –Æ–ø–∏—Ç–µ—Ä: { order: 5, radius: 69911, tex: 'textures/jupiter.jpg', glow: 0xffcc88, type: '–ì–∞–∑–æ–≤—ã–π –≥–∏–≥–∞–Ω—Ç', info: { mass: '1.9 √ó 10¬≤‚Å∑ –∫–≥', temp: '-108¬∞C (–≤ –æ–±–ª–∞–∫–∞—Ö)', day: '9.9 —á–∞—Å–∞', distance: '778.5 –º–ª–Ω –∫–º –æ—Ç –°–æ–ª–Ω—Ü–∞', fact: '–Æ–ø–∏—Ç–µ—Ä ‚Äî –∫—Ä—É–ø–Ω–µ–π—à–∞—è –ø–ª–∞–Ω–µ—Ç–∞ –°–æ–ª–Ω–µ—á–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã, –≥–∞–∑–æ–≤—ã–π –≥–∏–≥–∞–Ω—Ç —Å –º–∞—Å—Å–æ–π –≤ 2.5 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–ª–∞–Ω–µ—Ç –≤–º–µ—Å—Ç–µ –≤–∑—è—Ç—ã—Ö. –ë–æ–ª—å—à–æ–µ –ö—Ä–∞—Å–Ω–æ–µ –ü—è—Ç–Ω–æ ‚Äî —ç—Ç–æ —É—Ä–∞–≥–∞–Ω —Ä–∞–∑–º–µ—Ä–æ–º –±–æ–ª—å—à–µ –ó–µ–º–ª–∏, –±—É—à—É—é—â–∏–π —É–∂–µ 350+ –ª–µ—Ç!' } },
      –°–∞—Ç—É—Ä–Ω: { order: 6, radius: 58232, tex: 'textures/saturn.jpg', glow: 0xffdd99, type: '–ì–∞–∑–æ–≤—ã–π –≥–∏–≥–∞–Ω—Ç', ring: { tex: 'textures/saturn2.jpg', inner: 74500, outer: 140220 }, info: { mass: '5.68 √ó 10¬≤‚Å∂ –∫–≥', temp: '-139¬∞C (–≤ –æ–±–ª–∞–∫–∞—Ö)', day: '10.7 —á–∞—Å–∞', distance: '1.43 –º–ª—Ä–¥ –∫–º –æ—Ç –°–æ–ª–Ω—Ü–∞', fact: '–°–∞—Ç—É—Ä–Ω –∑–Ω–∞–º–µ–Ω–∏—Ç —Å–≤–æ–∏–º–∏ –≤–µ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –∫–æ–ª—å—Ü–∞–º–∏ –∏–∑ –º–∏–ª–ª–∏–∞—Ä–¥–æ–≤ —á–∞—Å—Ç–∏—Ü –ª—å–¥–∞ –∏ –∫–∞–º–Ω—è. –ï–≥–æ —Å—Ä–µ–¥–Ω—è—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å –º–µ–Ω—å—à–µ –≤–æ–¥—ã ‚Äî —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –æ–Ω –º–æ–≥ –±—ã –ø–ª–∞–≤–∞—Ç—å! –£ –Ω–µ–≥–æ 146 –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–ø—É—Ç–Ω–∏–∫–æ–≤, –≤–∫–ª—é—á–∞—è –¢–∏—Ç–∞–Ω —Å –ø–ª–æ—Ç–Ω–æ–π –∞—Ç–º–æ—Å—Ñ–µ—Ä–æ–π.' } },
      –£—Ä–∞–Ω: { order: 7, radius: 25362, tex: 'textures/uranus.jpg', glow: 0x4499cc, type: '–õ–µ–¥—è–Ω–æ–π –≥–∏–≥–∞–Ω—Ç', info: { mass: '8.68 √ó 10¬≤‚Åµ –∫–≥', temp: '-197¬∞C (–≤ –æ–±–ª–∞–∫–∞—Ö)', day: '17.2 —á–∞—Å–∞', distance: '2.87 –º–ª—Ä–¥ –∫–º –æ—Ç –°–æ–ª–Ω—Ü–∞', fact: '–£—Ä–∞–Ω ‚Äî "–ª–µ–∂–∞—á–∞—è –ø–ª–∞–Ω–µ—Ç–∞", –Ω–∞–∫–ª–æ–Ω—ë–Ω–Ω–∞—è –Ω–∞ 98¬∞ –∫ –ø–ª–æ—Å–∫–æ—Å—Ç–∏ –æ—Ä–±–∏—Ç—ã, —Å–ª–æ–≤–Ω–æ –∫–∞—Ç—è—â–∞—è—Å—è –ø–æ –Ω–µ–π –±–æ—á–∫–æ–º. –û–Ω –∏–º–µ–µ—Ç —Å–ª–∞–±—ã–µ –∫–æ–ª—å—Ü–∞ –∏ 27 –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–ø—É—Ç–Ω–∏–∫–æ–≤. –ê—Ç–º–æ—Å—Ñ–µ—Ä–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –º–µ—Ç–∞–Ω, –ø—Ä–∏–¥–∞—é—â–∏–π –ø–ª–∞–Ω–µ—Ç–µ —Å–∏–Ω–µ-–∑–µ–ª—ë–Ω—ã–π —Ü–≤–µ—Ç.' } },
      –ù–µ–ø—Ç—É–Ω: { order: 8, radius: 24622, tex: 'textures/neptune.jpg', glow: 0x4466ee, type: '–õ–µ–¥—è–Ω–æ–π –≥–∏–≥–∞–Ω—Ç', info: { mass: '1.02 √ó 10¬≤‚Å∂ –∫–≥', temp: '-201¬∞C (–≤ –æ–±–ª–∞–∫–∞—Ö)', day: '16.1 —á–∞—Å–∞', distance: '4.5 –º–ª—Ä–¥ –∫–º –æ—Ç –°–æ–ª–Ω—Ü–∞', fact: '–ù–µ–ø—Ç—É–Ω ‚Äî —Å–∞–º–∞—è –¥–∞–ª—å–Ω—è—è –ø–ª–∞–Ω–µ—Ç–∞ –°–æ–ª–Ω–µ—á–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —Å —Å–∞–º—ã–º–∏ –±—ã—Å—Ç—Ä—ã–º–∏ –≤–µ—Ç—Ä–∞–º–∏ (–¥–æ 2100 –∫–º/—á)! –ï–≥–æ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–π —Å–∏–Ω–∏–π —Ü–≤–µ—Ç –æ–±—É—Å–ª–æ–≤–ª–µ–Ω –º–µ—Ç–∞–Ω–æ–º –≤ –∞—Ç–º–æ—Å—Ñ–µ—Ä–µ. –û–¥–∏–Ω –≥–æ–¥ –Ω–∞ –ù–µ–ø—Ç—É–Ω–µ —Ä–∞–≤–µ–Ω 165 –∑–µ–º–Ω—ã–º –≥–æ–¥–∞–º.' } },
      –ü–ª—É—Ç–æ–Ω: { order: 9, radius: 1188, tex: 'textures/pluto.jpg', bump: 'textures/pluto.jpg', type: '–ö–∞—Ä–ª–∏–∫–æ–≤–∞—è –ø–ª–∞–Ω–µ—Ç–∞', info: { mass: '1.3 √ó 10¬≤¬≤ –∫–≥', temp: '-223¬∞C (—Å—Ä–µ–¥–Ω—è—è)', day: '6.4 –∑–µ–º–Ω—ã—Ö —Å—É—Ç–æ–∫', distance: '5.9 –º–ª—Ä–¥ –∫–º –æ—Ç –°–æ–ª–Ω—Ü–∞', fact: '–ü–ª—É—Ç–æ–Ω ‚Äî –∫–∞—Ä–ª–∏–∫–æ–≤–∞—è –ø–ª–∞–Ω–µ—Ç–∞ –≤ –ø–æ—è—Å–µ –ö–æ–π–ø–µ—Ä–∞. –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –º–∞–ª—ã–µ —Ä–∞–∑–º–µ—Ä—ã, —É –Ω–µ–≥–æ 5 —Å–ø—É—Ç–Ω–∏–∫–æ–≤ –∏ —Å–µ—Ä–¥—Ü–µ–≤–∏–¥–Ω–∞—è —Ä–∞–≤–Ω–∏–Ω–∞ –∏–∑ –∞–∑–æ—Ç–Ω–æ–≥–æ –ª—å–¥–∞ (–†–∞–≤–Ω–∏–Ω–∞ –°–ø—É—Ç–Ω–∏–∫–∞). –ú–∏—Å—Å–∏—è New Horizons –ø–æ–∫–∞–∑–∞–ª–∞ —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ –∞–∫—Ç–∏–≤–Ω—ã–π –≥–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–∏—Ä!' } }
    };

    const BASE_SCALE = 1 / 5000;
    const scene = new THREE.Scene();
    scene.background = new THREE.Color(0x000306);
    const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 50000);
    const renderer = new THREE.WebGLRenderer({ antialias: true, powerPreference: "high-performance" });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    renderer.toneMapping = THREE.ACESFilmicToneMapping;
    renderer.toneMappingExposure = 1.1;
    document.body.appendChild(renderer.domElement);

    const composer = new EffectComposer(renderer);
    composer.addPass(new RenderPass(scene, camera));
    const bloomPass = new UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 0.5, 0.4, 0.85);
    composer.addPass(bloomPass);

    const controls = new OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.dampingFactor = 0.05;
    controls.minDistance = 10;
    controls.maxDistance = 800;
    controls.maxPolarAngle = Math.PI * 0.85;
    controls.enableZoom = false;

    scene.add(new THREE.AmbientLight(0xffffff, 0.5));
    const mainLight = new THREE.DirectionalLight(0xffffff, 1.2);
    mainLight.position.set(100, 50, 100);
    scene.add(mainLight);

    function createStars() {
      const geo = new THREE.BufferGeometry(); const count = 6000; const pos = new Float32Array(count * 3);
      for (let i = 0; i < count; i++) {
        const r = 800 + Math.random() * 1500; const theta = Math.random() * Math.PI * 2; const phi = Math.acos(2 * Math.random() - 1);
        pos[i * 3] = r * Math.sin(phi) * Math.cos(theta); pos[i * 3 + 1] = r * Math.cos(phi); pos[i * 3 + 2] = r * Math.sin(phi) * Math.sin(theta);
      }
      geo.setAttribute("position", new THREE.BufferAttribute(pos, 3));
      return new THREE.Points(geo, new THREE.PointsMaterial({ color: 0xaaaaaa, size: 1.5 }));
    }
    scene.add(createStars());

    let activePlanets = [];
    const addedPlanetKeys = new Set();
    const planetsGroup = new THREE.Group();
    scene.add(planetsGroup);

    let cameraTarget = { position: new THREE.Vector3(0, 30, 80), target: new THREE.Vector3(0, 0, 0) };
    let userHasInteracted = false;

    controls.addEventListener('start', () => { userHasInteracted = true; });
    renderer.domElement.addEventListener('wheel', (e) => {
        e.preventDefault();
        userHasInteracted = true;
        const currentDistance = controls.target.distanceTo(camera.position);
        const zoomScale = e.deltaY > 0 ? 1.05 : 0.95;
        let newDistance = currentDistance * zoomScale;
        newDistance = Math.max(controls.minDistance, Math.min(controls.maxDistance, newDistance));
        const direction = new THREE.Vector3();
        direction.subVectors(camera.position, controls.target).normalize();
        camera.position.copy(controls.target).add(direction.multiplyScalar(newDistance));
    }, { passive: false });

    function createPlanet(key) {
      const data = PLANETS[key]; const radius = data.radius * BASE_SCALE; const geometry = new THREE.SphereGeometry(radius, 64, 64);
      const materialProps = { map: textureLoader.load(data.tex), shininess: 5, emissive: data.glow ? new THREE.Color(data.glow) : new THREE.Color(0x000000), emissiveIntensity: data.glow ? 0.1 : 0 };
      if (data.bump) { materialProps.bumpMap = textureLoader.load(data.bump); materialProps.bumpScale = 0.02; }
      if (data.spec) { materialProps.specularMap = textureLoader.load(data.spec); materialProps.specular = new THREE.Color('grey'); }
      const material = new THREE.MeshPhongMaterial(materialProps); const mesh = new THREE.Mesh(geometry, material); const container = new THREE.Group(); container.add(mesh);
      if (data.glow) {
        const glowGeo = new THREE.SphereGeometry(radius * 1.12, 32, 32);
        const glowMat = new THREE.ShaderMaterial({ uniforms: { glowColor: { value: new THREE.Color(data.glow) } }, vertexShader: `varying float intensity; void main() { vec3 vNormal = normalize( normalMatrix * normal ); vec3 vNormel = normalize( normalMatrix * cameraPosition ); intensity = pow( 0.65 - dot( vNormal, vNormel ), 2.5 ); gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 ); }`, fragmentShader: `uniform vec3 glowColor; varying float intensity; void main() { gl_FragColor = vec4( glowColor * intensity, intensity * 0.4 ); }`, side: THREE.BackSide, blending: THREE.AdditiveBlending, transparent: true });
        container.add(new THREE.Mesh(glowGeo, glowMat));
      }
      if (data.ring) {
        const innerR = data.ring.inner * BASE_SCALE; const outerR = data.ring.outer * BASE_SCALE; const ringGeo = new THREE.RingGeometry(innerR, outerR, 128);
        const ringMat = new THREE.MeshBasicMaterial({ map: textureLoader.load(data.ring.tex), side: THREE.DoubleSide, transparent: true, opacity: 0.9 });
        const ringMesh = new THREE.Mesh(ringGeo, ringMat); ringMesh.rotation.x = -Math.PI / 2; container.add(ringMesh);
      }
      container.userData = { name: key, radius: radius, realRadius: data.radius, type: data.type, info: data.info, rotationSpeed: 0.001 + Math.random() * 0.001 };
      return container;
    }

    function recalculatePositions() {
      if (activePlanets.length === 0) { fitCamera(); return; };
      activePlanets.sort((a, b) => PLANETS[a.userData.name].order - PLANETS[b].userData.name].order);
      let currentX = 0; const padding = 2;
      activePlanets.forEach((obj, i) => {
        const r = obj.userData.radius; const hasRings = !!PLANETS[obj.userData.name].ring; const effectiveR = hasRings ? r * 2.5 : r;
        if (i === 0) { currentX = 0; } else {
          const prevObj = activePlanets[i-1]; const prevHasRings = !!PLANETS[prevObj.userData.name].ring; const prevR = prevObj.userData.radius; const prevEffectiveR = prevHasRings ? prevR * 2.5 : prevR;
          currentX += prevEffectiveR + effectiveR + padding;
        }
        obj.userData.targetX = currentX;
      });
      const lastPlanet = activePlanets[activePlanets.length-1]; const lastPlanetHasRings = !!PLANETS[lastPlanet.userData.name].ring; const lastRadius = lastPlanet.userData.radius * (lastPlanetHasRings ? 2.5 : 1);
      const totalWidth = currentX + lastRadius; const offset = totalWidth / 2 - lastRadius / 2;
      activePlanets.forEach(obj => { obj.userData.targetX -= offset; });
      fitCamera();
    }

    function fitCamera() {
        const box = new THREE.Box3();
        if (activePlanets.length > 0) { planetsGroup.children.forEach(obj => { if (activePlanets.includes(obj)) box.expandByObject(obj); }); }
        else { box.set(new THREE.Vector3(-10, -10, -10), new THREE.Vector3(10, 10, 10)); }
        const size = new THREE.Vector3(); box.getSize(size); const center = new THREE.Vector3(); box.getCenter(center);
        const maxDim = Math.max(size.x, size.y, size.z); const fov = camera.fov * (Math.PI / 180);
        let cameraZ = Math.abs(maxDim / Math.tan(fov / 2)) * 0.9;
        cameraZ = Math.max(cameraZ, 30);
        cameraTarget.position.set(center.x, center.y + maxDim * 0.2, cameraZ);
        cameraTarget.target.copy(center);
        userHasInteracted = false;
    }

    window.addPlanet = (key) => {
      if (addedPlanetKeys.has(key)) return; const planet = createPlanet(key);
      planet.scale.set(0.01, 0.01, 0.01); planet.position.y = 10;
      planetsGroup.add(planet); activePlanets.push(planet); addedPlanetKeys.add(key);
      recalculatePositions(); updateUI();
      const startTime = performance.now(); const duration = 800;
      function animateIn() {
        const progress = Math.min((performance.now() - startTime) / duration, 1);
        const eased = 1 - Math.pow(1 - progress, 3);
        planet.scale.setScalar(eased); planet.position.y = 10 * (1 - eased);
        if (progress < 1) requestAnimationFrame(animateIn);
      }
      animateIn();
    };

    // --- –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø ---
    window.removePlanet = (key) => {
      const planet = activePlanets.find(p => p.userData.name === key);
      if (!planet) return;

      const startTime = performance.now();
      const duration = 400;

      function animateOut() {
        const progress = Math.min((performance.now() - startTime) / duration, 1);
        planet.scale.setScalar(1 - progress);
        planet.position.y = 10 * progress;
        
        if (progress < 1) {
          requestAnimationFrame(animateOut);
        } else {
          // –ù–∞—Ö–æ–¥–∏–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –ü–ï–†–ï–î —É–¥–∞–ª–µ–Ω–∏–µ–º
          const currentIndex = activePlanets.findIndex(p => p.userData.name === key);
          if (currentIndex > -1) {
            activePlanets.splice(currentIndex, 1);
          }
          
          planetsGroup.remove(planet);
          addedPlanetKeys.delete(key);
          
          recalculatePositions();
          updateUI();
        }
      }
      animateOut();
    };

    window.clearAll = () => {
      [...activePlanets].forEach((p, i) => {
        setTimeout(() => window.removePlanet(p.userData.name), i * 50);
      });
    };

    function updateUI() {
      document.getElementById('planetCount').textContent = activePlanets.length;
      document.querySelectorAll('.planet-btn').forEach(btn => {
        btn.classList.toggle('added', addedPlanetKeys.has(btn.dataset.planet));
      });
    }

    const btnContainer = document.getElementById("planetButtons");
    Object.keys(PLANETS).sort((a,b) => PLANETS[a].order - PLANETS[b].order).forEach(key => {
      const btn = document.createElement("button"); btn.className = "planet-btn"; btn.textContent = key; btn.dataset.planet = key;
      btn.onclick = () => { if (addedPlanetKeys.has(key)) window.removePlanet(key); else window.addPlanet(key); };
      btnContainer.appendChild(btn);
    });

    function showModal(planetObj) {
      const { name, type, realRadius, info } = planetObj.userData;
      document.getElementById('modalTitle').textContent = name; document.getElementById('modalSubtitle').textContent = type;
      document.getElementById('statsGrid').innerHTML = `
        <div class="stat-card"><div class="stat-icon">üìè</div><div class="stat-label">–†–∞–¥–∏—É—Å</div><div class="stat-value">${realRadius.toLocaleString()} –∫–º</div></div>
        <div class="stat-card"><div class="stat-icon">‚öñÔ∏è</div><div class="stat-label">–ú–∞—Å—Å–∞</div><div class="stat-value">${info.mass}</div></div>
        <div class="stat-card"><div class="stat-icon">üå°Ô∏è</div><div class="stat-label">–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞</div><div class="stat-value">${info.temp}</div></div>
        <div class="stat-card"><div class="stat-icon">üïê</div><div class="stat-label">–°—É—Ç–∫–∏</div><div class="stat-value">${info.day}</div></div>
        <div class="stat-card"><div class="stat-icon">üöÄ</div><div class="stat-label">–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ</div><div class="stat-value">${info.distance}</div></div>
        <div class="stat-card"><div class="stat-icon">‚¨áÔ∏è</div><div class="stat-label">–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è</div><div class="stat-value">${info.gravity || 'N/A'}</div></div>
      `;
      document.getElementById('factText').textContent = info.fact; document.getElementById('modal').classList.add('visible');
    }
    window.closeModal = () => document.getElementById('modal').classList.remove('visible');
    document.getElementById('modal').addEventListener('click', (e) => { if (e.target === e.currentTarget) closeModal(); });

    const raycaster = new THREE.Raycaster(); const mouse = new THREE.Vector2();
    renderer.domElement.addEventListener('dblclick', (event) => {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1; mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
      raycaster.setFromCamera(mouse, camera);
      const intersects = raycaster.intersectObjects(planetsGroup.children, true);
      if (intersects.length > 0) {
        let target = intersects[0].object;
        while (target.parent && target.parent !== planetsGroup) target = target.parent;
        if (activePlanets.includes(target)) showModal(target);
      }
    });
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeModal(); });

    setTimeout(() => { ['–ó–µ–º–ª—è', '–õ—É–Ω–∞', '–ú–∞—Ä—Å'].forEach((p, i) => { setTimeout(() => window.addPlanet(p), i * 150); }); }, 100);

    function animate() {
      requestAnimationFrame(animate);
      if (!userHasInteracted) {
          camera.position.lerp(cameraTarget.position, 0.05);
          controls.target.lerp(cameraTarget.target, 0.05);
      }
      activePlanets.forEach(obj => {
        if (obj.userData.targetX !== undefined) obj.position.x += (obj.userData.targetX - obj.position.x) * 0.08;
        if (obj.children[0]) obj.children[0].rotation.y += obj.userData.rotationSpeed;
      });
      controls.update();
      composer.render();
    }

    window.addEventListener("resize", () => {
      camera.aspect = window.innerWidth / window.innerHeight; camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight); composer.setSize(window.innerWidth, window.innerHeight);
      fitCamera();
    });

    animate();
  </script>
</body>
</html>