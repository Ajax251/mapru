<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <title>–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ü–ª–∞–Ω–µ—Ç –°–æ–ª–Ω–µ—á–Ω–æ–π –°–∏—Å—Ç–µ–º—ã</title>
  <style>
    :root {
      --panel-bg: rgba(8, 12, 21, 0.95);
      --panel-border: rgba(255, 255, 255, 0.1);
      --cyan: #00d4ff;
      --cyan-dark: #0099cc;
      --gold: #ffc107;
      --danger: #ff4757;
      --success: #2ed573;
      --glass: rgba(255, 255, 255, 0.03);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: #000;
      font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    }

    canvas { display: block; }

    /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */
    #header {
      position: absolute;
      top: 30px;
      left: 50%;
      transform: translateX(-50%);
      color: white;
      text-align: center;
      z-index: 10;
      pointer-events: none;
    }

    #header h1 {
      font-size: 32px;
      font-weight: 200;
      letter-spacing: 8px;
      background: linear-gradient(135deg, #fff 0%, var(--cyan) 50%, #fff 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 8px;
    }

    #header p {
      font-size: 12px;
      color: rgba(255, 255, 255, 0.4);
      letter-spacing: 3px;
      text-transform: uppercase;
    }

    /* –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
    #ui {
      position: absolute;
      top: 30px;
      right: 30px;
      background: var(--panel-bg);
      padding: 24px;
      border-radius: 20px;
      border: 1px solid var(--panel-border);
      color: white;
      width: 300px;
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(20px);
      z-index: 10;
    }

    .ui-title {
      font-size: 11px;
      color: var(--cyan);
      margin-bottom: 18px;
      text-transform: uppercase;
      letter-spacing: 3px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .ui-title::before {
      content: '';
      width: 20px;
      height: 1px;
      background: linear-gradient(90deg, var(--cyan), transparent);
    }

    .planet-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-bottom: 20px;
    }

    .planet-btn {
      background: var(--glass);
      border: 1px solid rgba(255, 255, 255, 0.08);
      color: rgba(255, 255, 255, 0.8);
      padding: 14px 10px;
      border-radius: 12px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 500;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    .planet-btn::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, var(--cyan), transparent);
      opacity: 0;
      transition: opacity 0.4s;
    }

    .planet-btn:hover {
      border-color: var(--cyan);
      color: white;
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(0, 212, 255, 0.2);
    }

    .planet-btn:hover::after {
      opacity: 0.1;
    }

    .planet-btn.added {
      background: rgba(46, 213, 115, 0.15);
      border-color: var(--success);
      color: var(--success);
    }

    .planet-btn.added::before {
      content: '‚úì';
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 12px;
    }

    .control-btn {
      width: 100%;
      background: transparent;
      border: 1px solid rgba(255, 71, 87, 0.4);
      color: var(--danger);
      padding: 14px;
      border-radius: 12px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 500;
      transition: all 0.3s;
      margin-top: 5px;
    }

    .control-btn:hover {
      background: var(--danger);
      color: white;
      border-color: var(--danger);
      box-shadow: 0 10px 30px rgba(255, 71, 87, 0.3);
    }

    /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
      z-index: 100;
      opacity: 0;
      visibility: hidden;
      transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-overlay.visible {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background: linear-gradient(180deg, rgba(15, 25, 40, 0.98) 0%, rgba(8, 12, 21, 0.98) 100%);
      border-radius: 28px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      max-width: 700px;
      width: 90%;
      max-height: 85vh;
      overflow: hidden;
      transform: scale(0.9) translateY(30px);
      transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 50px 100px rgba(0, 0, 0, 0.6), 0 0 100px rgba(0, 212, 255, 0.1);
    }

    .modal-overlay.visible .modal-content {
      transform: scale(1) translateY(0);
    }

    .modal-header {
      padding: 40px 40px 30px;
      position: relative;
      background: linear-gradient(180deg, rgba(0, 212, 255, 0.08) 0%, transparent 100%);
    }

    .modal-header::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 40px;
      right: 40px;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
    }

    .planet-title {
      font-size: 42px;
      font-weight: 200;
      letter-spacing: 4px;
      color: white;
      margin-bottom: 8px;
    }

    .planet-subtitle {
      font-size: 13px;
      color: var(--cyan);
      letter-spacing: 3px;
      text-transform: uppercase;
      font-weight: 500;
    }

    .close-modal {
      position: absolute;
      top: 25px;
      right: 25px;
      width: 44px;
      height: 44px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      color: rgba(255, 255, 255, 0.6);
      font-size: 24px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
    }

    .close-modal:hover {
      background: rgba(255, 71, 87, 0.2);
      border-color: var(--danger);
      color: var(--danger);
      transform: rotate(90deg);
    }

    .modal-body {
      padding: 30px 40px 40px;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid rgba(255, 255, 255, 0.06);
      border-radius: 16px;
      padding: 20px;
      transition: all 0.3s;
    }

    .stat-card:hover {
      background: rgba(0, 212, 255, 0.05);
      border-color: rgba(0, 212, 255, 0.2);
      transform: translateY(-3px);
    }

    .stat-icon {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      background: linear-gradient(135deg, var(--cyan), var(--cyan-dark));
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 12px;
      font-size: 16px;
    }

    .stat-label {
      font-size: 10px;
      color: rgba(255, 255, 255, 0.4);
      text-transform: uppercase;
      letter-spacing: 1.5px;
      margin-bottom: 6px;
    }

    .stat-value {
      font-size: 15px;
      color: white;
      font-weight: 500;
      line-height: 1.4;
    }

    .fact-card {
      background: linear-gradient(135deg, rgba(0, 212, 255, 0.1) 0%, rgba(0, 212, 255, 0.02) 100%);
      border: 1px solid rgba(0, 212, 255, 0.2);
      border-radius: 16px;
      padding: 25px;
      position: relative;
      overflow: hidden;
    }

    .fact-card::before {
      content: '"';
      position: absolute;
      top: -10px;
      left: 15px;
      font-size: 80px;
      color: rgba(0, 212, 255, 0.15);
      font-family: Georgia, serif;
      line-height: 1;
    }

    .fact-title {
      font-size: 11px;
      color: var(--cyan);
      text-transform: uppercase;
      letter-spacing: 2px;
      margin-bottom: 12px;
      font-weight: 600;
    }

    .fact-text {
      font-size: 14px;
      color: rgba(255, 255, 255, 0.8);
      line-height: 1.8;
      position: relative;
      z-index: 1;
    }

    /* –ü–æ–¥—Å–∫–∞–∑–∫–∏ */
    #hints {
      position: absolute;
      bottom: 30px;
      left: 30px;
      color: rgba(255, 255, 255, 0.3);
      font-size: 11px;
      z-index: 5;
      line-height: 2;
    }

    .hint-item {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .hint-key {
      background: rgba(255, 255, 255, 0.08);
      padding: 4px 10px;
      border-radius: 6px;
      font-family: 'SF Mono', monospace;
      font-size: 10px;
      color: rgba(255, 255, 255, 0.5);
    }

    /* –°—á—ë—Ç—á–∏–∫ –ø–ª–∞–Ω–µ—Ç */
    .planet-counter {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 12px;
      background: rgba(0, 212, 255, 0.08);
      border-radius: 12px;
      margin-bottom: 15px;
      border: 1px solid rgba(0, 212, 255, 0.15);
    }

    .counter-value {
      font-size: 24px;
      font-weight: 300;
      color: var(--cyan);
    }

    .counter-label {
      font-size: 11px;
      color: rgba(255, 255, 255, 0.5);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    /* –ê–¥–∞–ø—Ç–∏–≤ */
    @media (max-width: 768px) {
      #ui {
        top: auto;
        bottom: 20px;
        right: 10px;
        left: 10px;
        width: auto;
        padding: 20px;
      }

      .planet-grid {
        grid-template-columns: repeat(4, 1fr);
        gap: 8px;
      }

      .planet-btn {
        padding: 10px 6px;
        font-size: 11px;
      }

      #header h1 {
        font-size: 22px;
        letter-spacing: 4px;
      }

      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }

      .modal-header {
        padding: 30px 25px 20px;
      }

      .modal-body {
        padding: 20px 25px 30px;
      }

      .planet-title {
        font-size: 28px;
      }

      #hints {
        display: none;
      }
    }
  </style>
</head>
<body>

  <div id="header">
    <h1>–°–û–õ–ù–ï–ß–ù–ê–Ø –°–ò–°–¢–ï–ú–ê</h1>
    <p>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–æ–≤ –ø–ª–∞–Ω–µ—Ç</p>
  </div>

  <div id="hints">
    <div class="hint-item"><span class="hint-key">–õ–ö–ú + –¥–≤–∏–∂–µ–Ω–∏–µ</span> –í—Ä–∞—â–µ–Ω–∏–µ</div>
    <div class="hint-item"><span class="hint-key">–ö–æ–ª–µ—Å–æ</span> –ú–∞—Å—à—Ç–∞–±</div>
    <div class="hint-item"><span class="hint-key">–î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫</span> –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>
  </div>

  <div id="ui">
    <div class="ui-title">–í—ã–±–µ—Ä–∏—Ç–µ –ø–ª–∞–Ω–µ—Ç—ã</div>
    <div class="planet-counter">
      <span class="counter-value" id="planetCount">0</span>
      <span class="counter-label">–≤—ã–±—Ä–∞–Ω–æ</span>
    </div>
    <div class="planet-grid" id="planetButtons"></div>
    <button class="control-btn" onclick="clearAll()">‚ü≤ –°–±—Ä–æ—Å–∏—Ç—å –≤—ã–±–æ—Ä</button>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
  <div class="modal-overlay" id="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="planet-title" id="modalTitle">–ó–µ–º–ª—è</h2>
        <p class="planet-subtitle" id="modalSubtitle">–ü–ª–∞–Ω–µ—Ç–∞ –∑–µ–º–Ω–æ–π –≥—Ä—É–ø–ø—ã</p>
        <button class="close-modal" onclick="closeModal()">√ó</button>
      </div>
      <div class="modal-body">
        <div class="stats-grid" id="statsGrid"></div>
        <div class="fact-card">
          <div class="fact-title">–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç</div>
          <p class="fact-text" id="factText"></p>
        </div>
      </div>
    </div>
  </div>

  <script type="importmap">
    {
      "imports": {
        "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
        "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
      }
    }
  </script>

  <script type="module">
    import * as THREE from "three";
    import { OrbitControls } from "three/addons/controls/OrbitControls.js";
    import { UnrealBloomPass } from "three/addons/postprocessing/UnrealBloomPass.js";
    import { EffectComposer } from "three/addons/postprocessing/EffectComposer.js";
    import { RenderPass } from "three/addons/postprocessing/RenderPass.js";

    // --- –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ü–õ–ê–ù–ï–¢ ---
    const PLANETS = {
      –ú–µ—Ä–∫—É—Ä–∏–π: {
        order: 1,
        radius: 2439,
        type: '–ü–ª–∞–Ω–µ—Ç–∞ –∑–µ–º–Ω–æ–π –≥—Ä—É–ø–ø—ã',
        color: '#8c7853',
        info: {
          mass: '3.3 √ó 10¬≤¬≥ –∫–≥',
          temp: '-173¬∞C / +427¬∞C',
          day: '58.6 —Å—É—Ç–æ–∫',
          distance: '57.9 –º–ª–Ω –∫–º',
          gravity: '3.7 –º/—Å¬≤',
          fact: '–ú–µ—Ä–∫—É—Ä–∏–π ‚Äî —Å–∞–º–∞—è –±—ã—Å—Ç—Ä–∞—è –ø–ª–∞–Ω–µ—Ç–∞, —Å–æ–≤–µ—Ä—à–∞—é—â–∞—è –æ–±–æ—Ä–æ—Ç –≤–æ–∫—Ä—É–≥ –°–æ–ª–Ω—Ü–∞ –∑–∞ 88 –∑–µ–º–Ω—ã—Ö –¥–Ω–µ–π. –£ –Ω–µ—ë –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ—Ç –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã, –ø–æ—ç—Ç–æ–º—É —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∫–æ–ª–µ–±–ª–µ—Ç—Å—è –æ—Ç —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ —Ö–æ–ª–æ–¥–Ω–æ–π –¥–æ –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ –∂–∞—Ä–∫–æ–π.'
        }
      },
      –í–µ–Ω–µ—Ä–∞: {
        order: 2,
        radius: 6051,
        type: '–ü–ª–∞–Ω–µ—Ç–∞ –∑–µ–º–Ω–æ–π –≥—Ä—É–ø–ø—ã',
        color: '#ffa500',
        glow: 0xffaa55,
        info: {
          mass: '4.87 √ó 10¬≤‚Å¥ –∫–≥',
          temp: '+462¬∞C',
          day: '243 —Å—É—Ç–æ–∫',
          distance: '108.2 –º–ª–Ω –∫–º',
          gravity: '8.87 –º/—Å¬≤',
          fact: '–í–µ–Ω–µ—Ä–∞ ‚Äî —Å–∞–º–∞—è –≥–æ—Ä—è—á–∞—è –ø–ª–∞–Ω–µ—Ç–∞ –°–æ–ª–Ω–µ—á–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –±–ª–∞–≥–æ–¥–∞—Ä—è –ø–ª–æ—Ç–Ω–æ–π –∞—Ç–º–æ—Å—Ñ–µ—Ä–µ –∏–∑ —É–≥–ª–µ–∫–∏—Å–ª–æ–≥–æ –≥–∞–∑–∞. –û–Ω–∞ –≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –∏ –æ–¥–∏–Ω –¥–µ–Ω—å —Ç–∞–º –¥–ª–∏–Ω–Ω–µ–µ –≥–æ–¥–∞!'
        }
      },
      –ó–µ–º–ª—è: {
        order: 3,
        radius: 6371,
        type: '–ü–ª–∞–Ω–µ—Ç–∞ –∑–µ–º–Ω–æ–π –≥—Ä—É–ø–ø—ã',
        color: '#4a90d9',
        glow: 0x4488ff,
        info: {
          mass: '5.97 √ó 10¬≤‚Å¥ –∫–≥',
          temp: '-89¬∞C / +58¬∞C',
          day: '24 —á–∞—Å–∞',
          distance: '149.6 –º–ª–Ω –∫–º',
          gravity: '9.81 –º/—Å¬≤',
          fact: '–ó–µ–º–ª—è ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –∏–∑–≤–µ—Å—Ç–Ω–∞—è –ø–ª–∞–Ω–µ—Ç–∞ —Å –∂–∏–¥–∫–æ–π –≤–æ–¥–æ–π –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –∏ –∂–∏–∑–Ω—å—é. –û–∫–æ–ª–æ 71% –µ—ë –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –ø–æ–∫—Ä—ã—Ç–æ –æ–∫–µ–∞–Ω–∞–º–∏, –∞ –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –∫–æ—Å–º–∏—á–µ—Å–∫–æ–π —Ä–∞–¥–∏–∞—Ü–∏–∏.'
        }
      },
      –õ—É–Ω–∞: {
        order: 3.5,
        radius: 1737,
        type: '–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø—É—Ç–Ω–∏–∫ –ó–µ–º–ª–∏',
        color: '#888888',
        info: {
          mass: '7.35 √ó 10¬≤¬≤ –∫–≥',
          temp: '-173¬∞C / +127¬∞C',
          day: '27.3 —Å—É—Ç–æ–∫',
          distance: '384 400 –∫–º',
          gravity: '1.62 –º/—Å¬≤',
          fact: '–õ—É–Ω–∞ ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø—É—Ç–Ω–∏–∫ –ó–µ–º–ª–∏. –û–Ω–∞ –≤—Å–µ–≥–¥–∞ –ø–æ–≤—ë—Ä–Ω—É—Ç–∞ –∫ –Ω–∞–º –æ–¥–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω–æ–π –∏–∑-–∑–∞ –ø—Ä–∏–ª–∏–≤–Ω–æ–≥–æ –∑–∞—Ö–≤–∞—Ç–∞. –õ—É–Ω–Ω—ã–µ –º–æ—Ä—è ‚Äî —ç—Ç–æ –∑–∞—Å—Ç—ã–≤—à–∞—è –ª–∞–≤–∞ –¥—Ä–µ–≤–Ω–∏—Ö –∏–∑–≤–µ—Ä–∂–µ–Ω–∏–π.'
        }
      },
      –ú–∞—Ä—Å: {
        order: 4,
        radius: 3389,
        type: '–ü–ª–∞–Ω–µ—Ç–∞ –∑–µ–º–Ω–æ–π –≥—Ä—É–ø–ø—ã',
        color: '#cd5c5c',
        glow: 0xff6644,
        info: {
          mass: '6.42 √ó 10¬≤¬≥ –∫–≥',
          temp: '-87¬∞C / -5¬∞C',
          day: '24.6 —á–∞—Å–∞',
          distance: '227.9 –º–ª–Ω –∫–º',
          gravity: '3.71 –º/—Å¬≤',
          fact: '–ú–∞—Ä—Å –∏–∑–≤–µ—Å—Ç–µ–Ω –∫–∞–∫ "–ö—Ä–∞—Å–Ω–∞—è –ø–ª–∞–Ω–µ—Ç–∞" –∏–∑-–∑–∞ –æ–∫—Å–∏–¥–∞ –∂–µ–ª–µ–∑–∞ –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏. –ù–∞ –Ω—ë–º –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Å–∞–º–∞—è –≤—ã—Å–æ–∫–∞—è –≥–æ—Ä–∞ –≤ –°–æ–ª–Ω–µ—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ ‚Äî –û–ª–∏–º–ø –≤—ã—Å–æ—Ç–æ–π 21 –∫–º.'
        }
      },
      –Æ–ø–∏—Ç–µ—Ä: {
        order: 5,
        radius: 69911,
        type: '–ì–∞–∑–æ–≤—ã–π –≥–∏–≥–∞–Ω—Ç',
        color: '#d4a574',
        glow: 0xffcc88,
        info: {
          mass: '1.9 √ó 10¬≤‚Å∑ –∫–≥',
          temp: '-108¬∞C',
          day: '9.9 —á–∞—Å–∞',
          distance: '778.5 –º–ª–Ω –∫–º',
          gravity: '24.79 –º/—Å¬≤',
          fact: '–Æ–ø–∏—Ç–µ—Ä ‚Äî –∫—Ä—É–ø–Ω–µ–π—à–∞—è –ø–ª–∞–Ω–µ—Ç–∞ —Å –º–∞—Å—Å–æ–π –≤ 2.5 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–ª–∞–Ω–µ—Ç –≤–º–µ—Å—Ç–µ. –ë–æ–ª—å—à–æ–µ –ö—Ä–∞—Å–Ω–æ–µ –ü—è—Ç–Ω–æ ‚Äî —É—Ä–∞–≥–∞–Ω —Ä–∞–∑–º–µ—Ä–æ–º –±–æ–ª—å—à–µ –ó–µ–º–ª–∏, –±—É—à—É—é—â–∏–π —É–∂–µ –±–æ–ª–µ–µ 350 –ª–µ—Ç!'
        }
      },
      –°–∞—Ç—É—Ä–Ω: {
        order: 6,
        radius: 58232,
        type: '–ì–∞–∑–æ–≤—ã–π –≥–∏–≥–∞–Ω—Ç',
        color: '#f4d03f',
        glow: 0xffdd99,
        hasRings: true,
        info: {
          mass: '5.68 √ó 10¬≤‚Å∂ –∫–≥',
          temp: '-139¬∞C',
          day: '10.7 —á–∞—Å–∞',
          distance: '1.43 –º–ª—Ä–¥ –∫–º',
          gravity: '10.44 –º/—Å¬≤',
          fact: '–°–∞—Ç—É—Ä–Ω –∑–Ω–∞–º–µ–Ω–∏—Ç —Å–≤–æ–∏–º–∏ –∫–æ–ª—å—Ü–∞–º–∏ –∏–∑ –º–∏–ª–ª–∏–∞—Ä–¥–æ–≤ —á–∞—Å—Ç–∏—Ü –ª—å–¥–∞ –∏ –∫–∞–º–Ω—è. –ï–≥–æ –ø–ª–æ—Ç–Ω–æ—Å—Ç—å –º–µ–Ω—å—à–µ –≤–æ–¥—ã ‚Äî —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –æ–Ω –º–æ–≥ –±—ã –ø–ª–∞–≤–∞—Ç—å! –£ –Ω–µ–≥–æ 146 –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–ø—É—Ç–Ω–∏–∫–æ–≤.'
        }
      },
      –£—Ä–∞–Ω: {
        order: 7,
        radius: 25362,
        type: '–õ–µ–¥—è–Ω–æ–π –≥–∏–≥–∞–Ω—Ç',
        color: '#5dade2',
        glow: 0x4499cc,
        info: {
          mass: '8.68 √ó 10¬≤‚Åµ –∫–≥',
          temp: '-197¬∞C',
          day: '17.2 —á–∞—Å–∞',
          distance: '2.87 –º–ª—Ä–¥ –∫–º',
          gravity: '8.69 –º/—Å¬≤',
          fact: '–£—Ä–∞–Ω ‚Äî "–ª–µ–∂–∞—á–∞—è –ø–ª–∞–Ω–µ—Ç–∞", –Ω–∞–∫–ª–æ–Ω—ë–Ω–Ω–∞—è –Ω–∞ 98¬∞ –∫ –ø–ª–æ—Å–∫–æ—Å—Ç–∏ –æ—Ä–±–∏—Ç—ã. –ê—Ç–º–æ—Å—Ñ–µ—Ä–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –º–µ—Ç–∞–Ω, –ø—Ä–∏–¥–∞—é—â–∏–π –ø–ª–∞–Ω–µ—Ç–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–π —Å–∏–Ω–µ-–∑–µ–ª—ë–Ω—ã–π —Ü–≤–µ—Ç.'
        }
      },
      –ù–µ–ø—Ç—É–Ω: {
        order: 8,
        radius: 24622,
        type: '–õ–µ–¥—è–Ω–æ–π –≥–∏–≥–∞–Ω—Ç',
        color: '#3498db',
        glow: 0x4466ee,
        info: {
          mass: '1.02 √ó 10¬≤‚Å∂ –∫–≥',
          temp: '-201¬∞C',
          day: '16.1 —á–∞—Å–∞',
          distance: '4.5 –º–ª—Ä–¥ –∫–º',
          gravity: '11.15 –º/—Å¬≤',
          fact: '–ù–µ–ø—Ç—É–Ω ‚Äî —Å–∞–º–∞—è –¥–∞–ª—å–Ω—è—è –ø–ª–∞–Ω–µ—Ç–∞ —Å —Å–∞–º—ã–º–∏ –±—ã—Å—Ç—Ä—ã–º–∏ –≤–µ—Ç—Ä–∞–º–∏ –¥–æ 2100 –∫–º/—á! –ï–≥–æ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–π —Å–∏–Ω–∏–π —Ü–≤–µ—Ç –æ–±—É—Å–ª–æ–≤–ª–µ–Ω –º–µ—Ç–∞–Ω–æ–º. –û–¥–∏–Ω –≥–æ–¥ —Ä–∞–≤–µ–Ω 165 –∑–µ–º–Ω—ã–º –≥–æ–¥–∞–º.'
        }
      },
      –ü–ª—É—Ç–æ–Ω: {
        order: 9,
        radius: 1188,
        type: '–ö–∞—Ä–ª–∏–∫–æ–≤–∞—è –ø–ª–∞–Ω–µ—Ç–∞',
        color: '#c9a86c',
        info: {
          mass: '1.3 √ó 10¬≤¬≤ –∫–≥',
          temp: '-223¬∞C',
          day: '6.4 —Å—É—Ç–æ–∫',
          distance: '5.9 –º–ª—Ä–¥ –∫–º',
          gravity: '0.62 –º/—Å¬≤',
          fact: '–ü–ª—É—Ç–æ–Ω ‚Äî –∫–∞—Ä–ª–∏–∫–æ–≤–∞—è –ø–ª–∞–Ω–µ—Ç–∞ –≤ –ø–æ—è—Å–µ –ö–æ–π–ø–µ—Ä–∞. –£ –Ω–µ–≥–æ 5 —Å–ø—É—Ç–Ω–∏–∫–æ–≤ –∏ —Å–µ—Ä–¥—Ü–µ–≤–∏–¥–Ω–∞—è —Ä–∞–≤–Ω–∏–Ω–∞ –∏–∑ –∞–∑–æ—Ç–Ω–æ–≥–æ –ª—å–¥–∞. –ú–∏—Å—Å–∏—è New Horizons –æ—Ç–∫—Ä—ã–ª–∞ —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ –∞–∫—Ç–∏–≤–Ω—ã–π –≥–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–∏—Ä!'
        }
      }
    };

    // –ì–ª–æ–±–∞–ª—å–Ω—ã–π –º–∞—Å—à—Ç–∞–± –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Å–µ—Ö –ø–ª–∞–Ω–µ—Ç
    const BASE_SCALE = 1 / 5000;

    // –°—Ü–µ–Ω–∞
    const scene = new THREE.Scene();
    scene.background = new THREE.Color(0x000306);

    const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 50000);
    camera.position.set(0, 30, 80);

    const renderer = new THREE.WebGLRenderer({ 
      antialias: true, 
      powerPreference: "high-performance"
    });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    renderer.toneMapping = THREE.ACESFilmicToneMapping;
    renderer.toneMappingExposure = 1.1;
    document.body.appendChild(renderer.domElement);

    // Post-processing
    const composer = new EffectComposer(renderer);
    composer.addPass(new RenderPass(scene, camera));

    const bloomPass = new UnrealBloomPass(
      new THREE.Vector2(window.innerWidth, window.innerHeight),
      0.5, 0.4, 0.85
    );
    composer.addPass(bloomPass);

    const controls = new OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.dampingFactor = 0.05;
    controls.minDistance = 10;
    controls.maxDistance = 500;
    controls.maxPolarAngle = Math.PI * 0.85;

    // –û—Å–≤–µ—â–µ–Ω–∏–µ
    scene.add(new THREE.AmbientLight(0xffffff, 0.5));

    const mainLight = new THREE.DirectionalLight(0xffffff, 1.2);
    mainLight.position.set(100, 50, 100);
    scene.add(mainLight);

    const fillLight = new THREE.DirectionalLight(0x8899ff, 0.25);
    fillLight.position.set(-50, 0, -50);
    scene.add(fillLight);

    // –ó–≤—ë–∑–¥—ã
    function createStars() {
      const geo = new THREE.BufferGeometry();
      const count = 6000;
      const pos = new Float32Array(count * 3);
      const colors = new Float32Array(count * 3);
      
      for (let i = 0; i < count; i++) {
        const r = 800 + Math.random() * 1500;
        const theta = Math.random() * Math.PI * 2;
        const phi = Math.acos(2 * Math.random() - 1);
        
        pos[i * 3] = r * Math.sin(phi) * Math.cos(theta);
        pos[i * 3 + 1] = r * Math.cos(phi);
        pos[i * 3 + 2] = r * Math.sin(phi) * Math.sin(theta);
        
        const brightness = 0.5 + Math.random() * 0.5;
        const temp = Math.random();
        if (temp > 0.85) {
          colors[i * 3] = 0.6 * brightness;
          colors[i * 3 + 1] = 0.8 * brightness;
          colors[i * 3 + 2] = brightness;
        } else if (temp > 0.6) {
          colors[i * 3] = brightness;
          colors[i * 3 + 1] = 0.9 * brightness;
          colors[i * 3 + 2] = 0.7 * brightness;
        } else {
          colors[i * 3] = brightness;
          colors[i * 3 + 1] = brightness;
          colors[i * 3 + 2] = brightness;
        }
      }
      
      geo.setAttribute("position", new THREE.BufferAttribute(pos, 3));
      geo.setAttribute("color", new THREE.BufferAttribute(colors, 3));
      
      return new THREE.Points(geo, new THREE.PointsMaterial({ 
        size: 1.5, 
        sizeAttenuation: true,
        vertexColors: true,
        transparent: true,
        opacity: 0.9
      }));
    }
    scene.add(createStars());

    // –•—Ä–∞–Ω–∏–ª–∏—â–µ
    let activePlanets = [];
    const addedPlanetKeys = new Set();
    const planetsGroup = new THREE.Group();
    scene.add(planetsGroup);

    // –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞–Ω–µ—Ç—ã (–ø—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–µ —Ç–µ–∫—Å—Ç—É—Ä—ã)
    function createPlanet(key) {
      const data = PLANETS[key];
      const radius = data.radius * BASE_SCALE;

      // –°–æ–∑–¥–∞—ë–º –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω—É—é —Ç–µ–∫—Å—Ç—É—Ä—É
      const canvas = document.createElement('canvas');
      canvas.width = 512;
      canvas.height = 256;
      const ctx = canvas.getContext('2d');
      
      // –ë–∞–∑–æ–≤—ã–π —Ü–≤–µ—Ç
      const baseColor = new THREE.Color(data.color);
      ctx.fillStyle = data.color;
      ctx.fillRect(0, 0, 512, 256);
      
      // –î–æ–±–∞–≤–ª—è–µ–º –≤–∞—Ä–∏–∞—Ü–∏–∏
      for (let i = 0; i < 2000; i++) {
        const x = Math.random() * 512;
        const y = Math.random() * 256;
        const size = Math.random() * 8 + 1;
        const alpha = Math.random() * 0.3;
        
        ctx.fillStyle = Math.random() > 0.5 
          ? `rgba(255, 255, 255, ${alpha})` 
          : `rgba(0, 0, 0, ${alpha})`;
        ctx.beginPath();
        ctx.arc(x, y, size, 0, Math.PI * 2);
        ctx.fill();
      }
      
      // –ü–æ–ª–æ—Å—ã –¥–ª—è –≥–∞–∑–æ–≤—ã—Ö –≥–∏–≥–∞–Ω—Ç–æ–≤
      if (data.type.includes('–≥–∏–≥–∞–Ω—Ç')) {
        for (let i = 0; i < 15; i++) {
          const y = (i / 15) * 256;
          const alpha = Math.random() * 0.15;
          ctx.fillStyle = Math.random() > 0.5 
            ? `rgba(255, 255, 255, ${alpha})` 
            : `rgba(0, 0, 0, ${alpha})`;
          ctx.fillRect(0, y, 512, 10 + Math.random() * 20);
        }
      }

      const texture = new THREE.CanvasTexture(canvas);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.ClampToEdgeWrapping;

      const geometry = new THREE.SphereGeometry(radius, 64, 64);
      const material = new THREE.MeshPhongMaterial({
        map: texture,
        shininess: 10,
        emissive: data.glow ? new THREE.Color(data.glow) : new THREE.Color(0x000000),
        emissiveIntensity: data.glow ? 0.1 : 0
      });

      const mesh = new THREE.Mesh(geometry, material);
      const container = new THREE.Group();
      container.add(mesh);

      // –ê—Ç–º–æ—Å—Ñ–µ—Ä–∞ –¥–ª—è –ø–ª–∞–Ω–µ—Ç —Å glow
      if (data.glow) {
        const glowGeo = new THREE.SphereGeometry(radius * 1.12, 32, 32);
        const glowMat = new THREE.ShaderMaterial({
          uniforms: {
            glowColor: { value: new THREE.Color(data.glow) },
            viewVector: { value: camera.position }
          },
          vertexShader: `
            uniform vec3 viewVector;
            varying float intensity;
            void main() {
              vec3 vNormal = normalize(normalMatrix * normal);
              vec3 vNormel = normalize(normalMatrix * viewVector);
              intensity = pow(0.65 - dot(vNormal, vNormel), 2.5);
              gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
            }
          `,
          fragmentShader: `
            uniform vec3 glowColor;
            varying float intensity;
            void main() {
              gl_FragColor = vec4(glowColor * intensity, intensity * 0.4);
            }
          `,
          side: THREE.BackSide,
          blending: THREE.AdditiveBlending,
          transparent: true
        });
        container.add(new THREE.Mesh(glowGeo, glowMat));
      }

      // –ö–æ–ª—å—Ü–∞ –°–∞—Ç—É—Ä–Ω–∞
      if (data.hasRings) {
        const innerR = radius * 1.3;
        const outerR = radius * 2.4;
        
        const ringCanvas = document.createElement('canvas');
        ringCanvas.width = 512;
        ringCanvas.height = 64;
        const ringCtx = ringCanvas.getContext('2d');
        
        const gradient = ringCtx.createLinearGradient(0, 0, 512, 0);
        gradient.addColorStop(0, 'rgba(200, 180, 140, 0)');
        gradient.addColorStop(0.1, 'rgba(200, 180, 140, 0.6)');
        gradient.addColorStop(0.3, 'rgba(180, 160, 120, 0.8)');
        gradient.addColorStop(0.5, 'rgba(160, 140, 100, 0.3)');
        gradient.addColorStop(0.6, 'rgba(180, 160, 120, 0.7)');
        gradient.addColorStop(0.8, 'rgba(200, 180, 140, 0.5)');
        gradient.addColorStop(1, 'rgba(200, 180, 140, 0)');
        
        ringCtx.fillStyle = gradient;
        ringCtx.fillRect(0, 0, 512, 64);
        
        const ringGeo = new THREE.RingGeometry(innerR, outerR, 128);
        const ringUV = ringGeo.attributes.uv;
        const ringPos = ringGeo.attributes.position;
        
        for (let i = 0; i < ringUV.count; i++) {
          const x = ringPos.getX(i);
          const y = ringPos.getY(i);
          const len = Math.sqrt(x * x + y * y);
          ringUV.setXY(i, (len - innerR) / (outerR - innerR), 0.5);
        }
        
        const ringMat = new THREE.MeshBasicMaterial({
          map: new THREE.CanvasTexture(ringCanvas),
          side: THREE.DoubleSide,
          transparent: true,
          opacity: 0.85
        });
        
        const ringMesh = new THREE.Mesh(ringGeo, ringMat);
        ringMesh.rotation.x = -Math.PI / 2;
        container.add(ringMesh);
      }

      container.userData = {
        name: key,
        radius: radius,
        realRadius: data.radius,
        type: data.type,
        info: data.info,
        rotationSpeed: 0.002 + Math.random() * 0.003
      };

      return container;
    }

    // –†–∞—Å—á—ë—Ç –ø–æ–∑–∏—Ü–∏–π
    function recalculatePositions() {
      if (activePlanets.length === 0) return;

      activePlanets.sort((a, b) => PLANETS[a.userData.name].order - PLANETS[b.userData.name].order);

      let currentX = 0;
      const padding = 2;

      activePlanets.forEach((obj, i) => {
        const r = obj.userData.radius;
        const hasRings = PLANETS[obj.userData.name].hasRings;
        const effectiveR = hasRings ? r * 2.5 : r;
        
        if (i === 0) {
          currentX = effectiveR;
        } else {
          const prevData = PLANETS[activePlanets[i-1].userData.name];
          const prevR = activePlanets[i-1].userData.radius;
          const prevEffectiveR = prevData.hasRings ? prevR * 2.5 : prevR;
          currentX += prevEffectiveR + effectiveR + padding;
        }
        
        obj.userData.targetX = currentX;
      });

      // –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º
      const totalWidth = currentX + (activePlanets[activePlanets.length-1]?.userData.radius || 0);
      const offset = totalWidth / 2;
      activePlanets.forEach(obj => {
        obj.userData.targetX -= offset;
      });

      fitCamera();
    }

    function fitCamera() {
      if (activePlanets.length === 0) return;

      const box = new THREE.Box3();
      activePlanets.forEach(obj => {
        const r = obj.userData.radius;
        const hasRings = PLANETS[obj.userData.name].hasRings;
        const effectiveR = hasRings ? r * 2.5 : r;
        box.expandByPoint(new THREE.Vector3(obj.userData.targetX - effectiveR, -effectiveR, -effectiveR));
        box.expandByPoint(new THREE.Vector3(obj.userData.targetX + effectiveR, effectiveR, effectiveR));
      });

      const size = new THREE.Vector3();
      box.getSize(size);
      const center = new THREE.Vector3();
      box.getCenter(center);

      const maxDim = Math.max(size.x, size.y, size.z);
      const fov = camera.fov * (Math.PI / 180);
      let cameraZ = Math.abs(maxDim / Math.tan(fov / 2)) * 0.9;
      cameraZ = Math.max(cameraZ, 30);

      targetCamera.z = cameraZ;
      targetCamera.x = center.x;
      targetCamera.y = center.y + maxDim * 0.2;
      
      controls.target.copy(center);
    }

    const targetCamera = { x: 0, y: 30, z: 80 };

    // UI —Ñ—É–Ω–∫—Ü–∏–∏
    window.addPlanet = (key) => {
      if (addedPlanetKeys.has(key)) return;

      const planet = createPlanet(key);
      planet.scale.set(0.01, 0.01, 0.01);
      planet.position.y = 10;
      planetsGroup.add(planet);
      activePlanets.push(planet);
      addedPlanetKeys.add(key);

      recalculatePositions();
      updateUI();
      
      // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
      animateIn(planet);
    };

    function animateIn(obj) {
      const startTime = performance.now();
      const duration = 800;
      
      function update() {
        const progress = Math.min((performance.now() - startTime) / duration, 1);
        const eased = 1 - Math.pow(1 - progress, 3);
        
        obj.scale.setScalar(eased);
        obj.position.y = 10 * (1 - eased);
        
        if (progress < 1) requestAnimationFrame(update);
      }
      update();
    }

    window.removePlanet = (key) => {
      const index = activePlanets.findIndex(p => p.userData.name === key);
      if (index === -1) return;
      
      const planet = activePlanets[index];
      
      // –ê–Ω–∏–º–∞—Ü–∏—è –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è
      const startTime = performance.now();
      const duration = 400;
      
      function animateOut() {
        const progress = Math.min((performance.now() - startTime) / duration, 1);
        const scale = 1 - progress;
        planet.scale.setScalar(scale);
        planet.position.y = 10 * progress;
        
        if (progress < 1) {
          requestAnimationFrame(animateOut);
        } else {
          planetsGroup.remove(planet);
          activePlanets.splice(index, 1);
          addedPlanetKeys.delete(key);
          recalculatePositions();
          updateUI();
        }
      }
      animateOut();
    };

    window.clearAll = () => {
      const planets = [...activePlanets];
      planets.forEach((p, i) => {
        setTimeout(() => window.removePlanet(p.userData.name), i * 50);
      });
    };

    function updateUI() {
      document.getElementById('planetCount').textContent = activePlanets.length;
      document.querySelectorAll('.planet-btn').forEach(btn => {
        btn.classList.toggle('added', addedPlanetKeys.has(btn.dataset.planet));
      });
    }

    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫
    const btnContainer = document.getElementById("planetButtons");
    Object.keys(PLANETS).forEach(key => {
      const btn = document.createElement("button");
      btn.className = "planet-btn";
      btn.textContent = key;
      btn.dataset.planet = key;
      btn.onclick = () => {
        if (addedPlanetKeys.has(key)) {
          window.removePlanet(key);
        } else {
          window.addPlanet(key);
        }
      };
      btnContainer.appendChild(btn);
    });

    // –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
    function showModal(planetObj) {
      const data = planetObj.userData;
      const info = data.info;

      document.getElementById('modalTitle').textContent = data.name;
      document.getElementById('modalSubtitle').textContent = data.type;

      document.getElementById('statsGrid').innerHTML = `
        <div class="stat-card">
          <div class="stat-icon">üìè</div>
          <div class="stat-label">–†–∞–¥–∏—É—Å</div>
          <div class="stat-value">${data.realRadius.toLocaleString()} –∫–º</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">‚öñÔ∏è</div>
          <div class="stat-label">–ú–∞—Å—Å–∞</div>
          <div class="stat-value">${info.mass}</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">üå°Ô∏è</div>
          <div class="stat-label">–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞</div>
          <div class="stat-value">${info.temp}</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">üïê</div>
          <div class="stat-label">–°—É—Ç–∫–∏</div>
          <div class="stat-value">${info.day}</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">üöÄ</div>
          <div class="stat-label">–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ</div>
          <div class="stat-value">${info.distance}</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">‚¨áÔ∏è</div>
          <div class="stat-label">–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è</div>
          <div class="stat-value">${info.gravity}</div>
        </div>
      `;

      document.getElementById('factText').textContent = info.fact;
      document.getElementById('modal').classList.add('visible');
    }

    window.closeModal = () => {
      document.getElementById('modal').classList.remove('visible');
    };

    // –ö–ª–∏–∫ –≤–Ω–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –µ–≥–æ
    document.getElementById('modal').addEventListener('click', (e) => {
      if (e.target === document.getElementById('modal')) {
        closeModal();
      }
    });

    // Raycaster
    const raycaster = new THREE.Raycaster();
    const mouse = new THREE.Vector2();

    renderer.domElement.addEventListener('dblclick', (event) => {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

      raycaster.setFromCamera(mouse, camera);
      const intersects = raycaster.intersectObjects(planetsGroup.children, true);

      if (intersects.length > 0) {
        let target = intersects[0].object;
        while (target.parent && target.parent !== planetsGroup) {
          target = target.parent;
        }
        if (activePlanets.includes(target)) {
          showModal(target);
        }
      }
    });

    // ESC –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª–∫—É
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closeModal();
    });

    // –ù–∞—á–∞–ª—å–Ω—ã–µ –ø–ª–∞–Ω–µ—Ç—ã
    setTimeout(() => {
      ['–ú–µ—Ä–∫—É—Ä–∏–π', '–í–µ–Ω–µ—Ä–∞', '–ó–µ–º–ª—è', '–ú–∞—Ä—Å'].forEach((p, i) => {
        setTimeout(() => window.addPlanet(p), i * 150);
      });
    }, 100);

    // –ê–Ω–∏–º–∞—Ü–∏—è
    function animate() {
      requestAnimationFrame(animate);

      // –ü–ª–∞–≤–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã
      camera.position.x += (targetCamera.x - camera.position.x) * 0.03;
      camera.position.y += (targetCamera.y - camera.position.y) * 0.03;
      camera.position.z += (targetCamera.z - camera.position.z) * 0.03;

      // –ü–ª–∞–≤–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –∏ –≤—Ä–∞—â–µ–Ω–∏–µ –ø–ª–∞–Ω–µ—Ç
      activePlanets.forEach(obj => {
        if (obj.userData.targetX !== undefined) {
          obj.position.x += (obj.userData.targetX - obj.position.x) * 0.08;
        }
        if (obj.children[0]) {
          obj.children[0].rotation.y += obj.userData.rotationSpeed;
        }
      });

      controls.update();
      composer.render();
    }

    window.addEventListener("resize", () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
      composer.setSize(window.innerWidth, window.innerHeight);
      fitCamera();
    });

    animate();
  </script>
</body>
</html>