<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>ORBITAL COMMAND CENTER</title>
    
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –∫–∞—Ä—Ç—É (Leaflet) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <!-- –ö—Ä–∞—Å–∏–≤—ã–π —à—Ä–∏—Ñ—Ç -->
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">

    <style>
        /* --- –û–°–ù–û–í–ù–û–ô –°–¢–ò–õ–¨ --- */
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden; /* –£–±–∏—Ä–∞–µ–º —Å–∫—Ä–æ–ª–ª —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
            font-family: 'Rajdhani', sans-serif;
            color: white;
            background: #000;
        }

        /* --- –ü–û–õ–ù–û–≠–ö–†–ê–ù–ù–û–ï –í–ò–î–ï–û --- */
        .video-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none; /* –ß—Ç–æ–±—ã –∫–ª–∏–∫–∏ –ø—Ä–æ—Ö–æ–¥–∏–ª–∏ —Å–∫–≤–æ–∑—å –≤–∏–¥–µ–æ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ) */
        }
        
        .video-background iframe {
            width: 100vw;
            height: 100vh;
            border: none;
            /* –ù–µ–±–æ–ª—å—à–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–∞, —á—Ç–æ–±—ã —Å–∫—Ä—ã—Ç—å —á–µ—Ä–Ω—ã–µ –ø–æ–ª–æ—Å—ã YouTube */
            transform: scale(1.05); 
        }

        /* --- –ò–ù–¢–ï–†–§–ï–ô–° (–ü–û–í–ï–†–• –í–ò–î–ï–û) --- */
        .ui-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
            pointer-events: none; /* –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤–∏–¥–µ—Ç—å –≤–∏–¥–µ–æ, –Ω–æ —ç–ª–µ–º–µ–Ω—Ç—ã –≤–Ω—É—Ç—Ä–∏ –±—É–¥—É—Ç –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        /* --- –í–ï–†–•–ù–Ø–Ø –ü–ê–ù–ï–õ–¨ (–°–¢–ï–ö–õ–û) --- */
        .top-bar {
            pointer-events: auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 40px;
            
            /* Glassmorphism —ç—Ñ—Ñ–µ–∫—Ç */
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .brand {
            font-size: 24px;
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: #00d2ff;
            text-shadow: 0 0 10px rgba(0, 210, 255, 0.5);
        }

        /* –ö–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∫–∞–º–µ—Ä */
        .controls {
            display: flex;
            gap: 15px;
        }

        .btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-family: 'Rajdhani', sans-serif;
            font-weight: 700;
            text-transform: uppercase;
            transition: all 0.3s ease;
            letter-spacing: 1px;
        }

        .btn:hover, .btn.active {
            background: rgba(0, 210, 255, 0.3);
            border-color: #00d2ff;
            box-shadow: 0 0 15px rgba(0, 210, 255, 0.4);
        }

        /* --- –ù–ò–ñ–ù–Ø–Ø –ö–ù–û–ü–ö–ê –ö–ê–†–¢–´ --- */
        .bottom-controls {
            pointer-events: auto;
            text-align: center;
            padding-bottom: 20px;
        }

        .map-toggle-btn {
            background: rgba(255, 165, 0, 0.2);
            border: 1px solid orange;
        }
        .map-toggle-btn:hover {
            background: rgba(255, 165, 0, 0.5);
            box-shadow: 0 0 15px rgba(255, 165, 0, 0.6);
        }

        /* --- –í–´–ï–ó–ñ–ê–Æ–©–ê–Ø –ö–ê–†–¢–ê (–°–¢–ï–ö–õ–û) --- */
        .map-panel {
            position: absolute;
            bottom: 0;
            left: 5%; /* –û—Ç—Å—Ç—É–ø—ã –ø–æ –±–æ–∫–∞–º */
            width: 90%;
            height: 35%; /* –í—ã—Å–æ—Ç–∞ 35% –æ—Ç —ç–∫—Ä–∞–Ω–∞ */
            z-index: 20;
            
            /* Glassmorphism */
            background: rgba(15, 23, 42, 0.85); /* –ß—É—Ç—å —Ç–µ–º–Ω–µ–µ —Ñ–æ–Ω –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –∫–∞—Ä—Ç—ã */
            backdrop-filter: blur(15px);
            border-top: 2px solid rgba(0, 210, 255, 0.3);
            border-radius: 20px 20px 0 0;
            box-shadow: 0 -10px 30px rgba(0,0,0,0.5);

            /* –ê–Ω–∏–º–∞—Ü–∏—è –≤—ã–µ–∑–¥–∞ */
            transform: translateY(110%); /* –°–∫—Ä—ã—Ç–∞ –≤–Ω–∏–∑—É */
            transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            
            display: flex;
            flex-direction: column;
            pointer-events: auto;
        }

        .map-panel.visible {
            transform: translateY(0); /* –ü–æ–∫–∞–∑–∞—Ç—å */
        }

        .map-header {
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .map-stats {
            font-size: 14px;
            color: #ccc;
        }
        
        .stat-val { color: #00d2ff; font-weight: bold; margin-right: 15px; }

        .close-map {
            background: none;
            border: none;
            color: #aaa;
            cursor: pointer;
            font-size: 20px;
        }
        .close-map:hover { color: white; }

        /* –°–∞–º–∞ –∫–∞—Ä—Ç–∞ */
        #issMap {
            width: 100%;
            height: 100%;
            border-radius: 0 0 0 0; /* –°–∫—Ä—É–≥–ª–µ–Ω–∏—è –Ω–µ –Ω—É–∂–Ω—ã –≤–Ω–∏–∑—É */
            opacity: 0.9;
        }

        /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
        @media (max-width: 600px) {
            .top-bar { flex-direction: column; gap: 10px; }
            .map-panel { width: 100%; left: 0; height: 50%; }
        }
    </style>
</head>
<body>

    <!-- –§–û–ù–û–í–û–ï –í–ò–î–ï–û -->
    <div class="video-background">
        <iframe 
            id="mainVideo"
            src="" 
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
            allowfullscreen>
        </iframe>
    </div>

    <!-- –°–õ–û–ô –ò–ù–¢–ï–†–§–ï–ô–°–ê -->
    <div class="ui-layer">
        
        <!-- –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å -->
        <div class="top-bar">
            <div class="brand">üöÄ ISS COMMAND</div>
            <div class="controls" id="cameraButtons">
                <!-- –ö–Ω–æ–ø–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–∞—Ä—Ç—ã –≤–Ω–∏–∑—É -->
        <div class="bottom-controls">
            <button class="btn map-toggle-btn" onclick="toggleMap()">üìç –¢–†–ï–ö–ï–† & –ö–ê–†–¢–ê</button>
        </div>

    </div>

    <!-- –í–´–ï–ó–ñ–ê–Æ–©–ê–Ø –ü–ê–ù–ï–õ–¨ –° –ö–ê–†–¢–û–ô -->
    <div class="map-panel" id="mapPanel">
        <div class="map-header">
            <div class="map-stats">
                –°–ö–û–†–û–°–¢–¨: <span id="speed" class="stat-val">0</span> –∫–º/—á
                –í–´–°–û–¢–ê: <span id="altitude" class="stat-val">0</span> –∫–º
            </div>
            <button class="close-map" onclick="toggleMap()">‚úï</button>
        </div>
        <div id="issMap"></div>
    </div>

    <!-- –°–ö–†–ò–ü–¢–´ -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        // --- 1. –ù–ê–°–¢–†–û–ô–ö–ê –í–ò–î–ï–û (–¢–í–û–ô –ú–ê–°–°–ò–í –°–°–´–õ–û–ö) ---
        const videoSources = [
            { id: 'gvpXSDt5MbI', name: '–ö–∞–º–µ—Ä–∞ 1 (NASA Live)' },  // –¢–≤–æ—è —Å—Å—ã–ª–∫–∞ 1
            { id: 'fO9e9jnhYK8', name: '–ö–∞–º–µ—Ä–∞ 2 (Earth View)' }, // –¢–≤–æ—è —Å—Å—ã–ª–∫–∞ 2
            // –°—é–¥–∞ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ:
            // { id: 'VIDEO_ID', name: '–ù–∞–∑–≤–∞–Ω–∏–µ' },
        ];

        let currentVideoIndex = 0;
        const iframe = document.getElementById('mainVideo');
        const buttonContainer = document.getElementById('cameraButtons');

        // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ
        function loadVideo(index) {
            currentVideoIndex = index;
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ (–ø–æ–¥—Å–≤–µ—Ç–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–π)
            document.querySelectorAll('.cam-btn').forEach((btn, idx) => {
                if(idx === index) btn.classList.add('active');
                else btn.classList.remove('active');
            });

            // –§–æ—Ä–º–∏—Ä—É–µ–º —Å—Å—ã–ª–∫—É YouTube
            // autoplay=1 - –∞–≤—Ç–æ—Å—Ç–∞—Ä—Ç
            // mute=1 - –±–µ–∑ –∑–≤—É–∫–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∞–≤—Ç–æ—Å—Ç–∞—Ä—Ç–∞ –≤ Chrome)
            // controls=0 - —Å–∫—Ä—ã—Ç—å –ø–ª–µ–µ—Ä
            // loop=1 - –∑–∞—Ü–∏–∫–ª–∏—Ç—å
            const videoId = videoSources[index].id;
            iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1&controls=0&loop=1&playlist=${videoId}&showinfo=0`;
        }

        // –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
        videoSources.forEach((video, index) => {
            const btn = document.createElement('button');
            btn.className = 'btn cam-btn';
            btn.innerText = video.name;
            btn.onclick = () => loadVideo(index);
            buttonContainer.appendChild(btn);
        });

        // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–≤–æ–µ –≤–∏–¥–µ–æ
        loadVideo(0);


        // --- 2. –ù–ê–°–¢–†–û–ô–ö–ê –ö–ê–†–¢–´ ---
        let map;
        let marker;
        const mapPanel = document.getElementById('mapPanel');

        function initMap() {
            if (map) return; // –ï—Å–ª–∏ —É–∂–µ —Å–æ–∑–¥–∞–Ω–∞, –Ω–µ —Å–æ–∑–¥–∞–µ–º —Å–Ω–æ–≤–∞

            map = L.map('issMap').setView([0, 0], 3);

            // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–≤–µ—Ç–ª—É—é –∫–∞—Ä—Ç—É, –∫–∞–∫ —Ç—ã –ø—Ä–æ—Å–∏–ª
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; OpenStreetMap',
                maxZoom: 18
            }).addTo(map);

            const issIcon = L.icon({
                iconUrl: 'https://upload.wikimedia.org/wikipedia/commons/d/d0/International_Space_Station.svg',
                iconSize: [50, 32],
                iconAnchor: [25, 16]
            });

            marker = L.marker([0, 0], {icon: issIcon}).addTo(map);
            
            // –ù–∞—á–∏–Ω–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–∞—Ä—Ç—ã
            getISSData();
            setInterval(getISSData, 3000); 
        }

        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è/–∑–∞–∫—Ä—ã—Ç–∏—è –∫–∞—Ä—Ç—ã
        function toggleMap() {
            mapPanel.classList.toggle('visible');
            
            // –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ–º –∫–∞—Ä—Ç—É –≤–ø–µ—Ä–≤—ã–µ - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –µ—ë
            if (mapPanel.classList.contains('visible')) {
                initMap();
                // –ù–µ–±–æ–ª—å—à–æ–π —Ö–∞–∫: Leaflet –Ω—É–∂–Ω–æ –ø–Ω—É—Ç—å, —á—Ç–æ–±—ã –æ–Ω –ø–æ–Ω—è–ª –Ω–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞
                setTimeout(() => { map.invalidateSize(); }, 500);
            }
        }

        // --- 3. –ü–û–õ–£–ß–ï–ù–ò–ï –î–ê–ù–ù–´–• –ú–ö–° ---
        async function getISSData() {
            // –ï—Å–ª–∏ –∫–∞—Ä—Ç–∞ –∑–∞–∫—Ä—ã—Ç–∞, –Ω–µ —Ç—Ä–∞—Ç–∏–º —Ä–µ—Å—É—Ä—Å—ã –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã
            if (!mapPanel.classList.contains('visible')) return;

            try {
                const response = await fetch('https://api.wheretheiss.at/v1/satellites/25544');
                const data = await response.json();
                
                const lat = data.latitude;
                const lon = data.longitude;
                
                marker.setLatLng([lat, lon]);
                map.panTo([lat, lon]);

                document.getElementById('speed').innerText = Math.round(data.velocity);
                document.getElementById('altitude').innerText = Math.round(data.altitude);

            } catch (error) {
                console.log('–û—à–∏–±–∫–∞ API:', error);
            }
        }

    </script>
</body>
</html>