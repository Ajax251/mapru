{
  "sections": [
    {
      "id": "powershell",
      "title": "PowerShell",
      "icon": "terminal",
      "cards": [
        {
          "title": "Установка и обновление",
          "commands": [
            {"name": "Проверить версию", "cmd": "$PSVersionTable", "admin": false, "desc": "Показывает текущую версию PowerShell"},
            {"name": "Установить стабильную (winget)", "cmd": "winget install --id Microsoft.PowerShell --source winget", "admin": true, "desc": "Установка последней стабильной версии через winget"},
            {"name": "Установить preview (winget)", "cmd": "winget install --id Microsoft.PowerShell.Preview --source winget", "admin": true, "desc": "Установка предварительной версии для тестирования новых функций"},
            {
              "name": "Автоустановка PS7 с GitHub",
              "cmd": "[Net.ServicePointManager]::SecurityProtocol=[Net.SecurityProtocolType]::Tls12\n$ProgressPreference='SilentlyContinue'\ntry{\n  $a=(Invoke-RestMethod 'https://api.github.com/repos/PowerShell/PowerShell/releases/latest').assets|Where-Object{$_.name-like'PowerShell-*-win-x64.msi'}|Select-Object -First 1\n  $m=Join-Path $env:TEMP $a.name\n  Write-Host \"Скачиваю $($a.name)...\" -ForegroundColor Yellow\n  Invoke-WebRequest $a.browser_download_url -OutFile $m\n  Write-Host 'Установка...' -ForegroundColor Yellow\n  Start-Process msiexec.exe -ArgumentList \"/i `\"$m`\" /quiet\" -Wait\n  Remove-Item $m -ErrorAction SilentlyContinue\n  Write-Host 'Готово! Проверьте: pwsh --version' -ForegroundColor Green\n}catch{\n  Write-Host \"Ошибка: $($_.Exception.Message)\" -ForegroundColor Red\n}",
              "admin": true,
              "desc": "Скачивает и устанавливает последний PowerShell 7 с GitHub. Требует PS 5.1+"
            }
          ]
        },
        {
          "title": "Профиль и модули",
          "commands": [
            {"name": "Путь к профилю", "cmd": "$PROFILE", "admin": false, "desc": "Показывает путь к файлу профиля PowerShell"},
            {"name": "Создать профиль", "cmd": "if(!(Test-Path $PROFILE)){New-Item -Path $PROFILE -ItemType File -Force}", "admin": false, "desc": "Создает файл профиля, если его нет"},
            {"name": "Список установленных модулей", "cmd": "Get-Module -ListAvailable | Select-Object Name, Version, ModuleBase", "admin": false, "desc": "Все доступные модули PowerShell"},
            {"name": "Установить модуль PSReadLine", "cmd": "Install-Module -Name PSReadLine -Force -SkipPublisherCheck", "admin": true, "desc": "Улучшенная строка ввода для PowerShell"},
            {"name": "Обновить все модули", "cmd": "Get-InstalledModule | Update-Module", "admin": true, "desc": "Обновляет все установленные через PowerShellGet модули"}
          ]
        }
      ]
    },
    {
      "id": "dns",
      "title": "DNS",
      "icon": "globe",
      "cards": [
        {
          "title": "Управление DNS",
          "commands": [
            {"name": "Текущие DNS-серверы", "cmd": "Get-DnsClientServerAddress | Select-Object InterfaceAlias, ServerAddresses", "admin": false, "desc": "Показывает DNS для каждого сетевого подключения"},
            {"name": "Сброс кэша DNS", "cmd": "Clear-DnsClientCache", "admin": true, "desc": "Очищает локальный кэш DNS-записей"},
            {
              "name": "Сброс DNS на автоматические",
              "cmd": "Set-DnsClientServerAddress -InterfaceAlias \"Ethernet\" -ResetServerAddresses",
              "admin": true,
              "desc": "Возвращает DNS на получение по DHCP",
              "vars": [
                {"id": "adapter", "label": "Имя сетевого адаптера", "hint": "Узнайте через: Get-NetAdapter", "default": "Ethernet", "normalize": "adapter"}
              ],
              "template": "Set-DnsClientServerAddress -InterfaceAlias \"{adapter}\" -ResetServerAddresses"
            }
          ]
        },
        {
          "title": "Xbox DNS",
          "description": "DNS для работы ИИ-моделей",
          "commands": [
            {
              "name": "Установить Xbox DNS",
              "cmd": "Set-DnsClientServerAddress -InterfaceAlias \"Ethernet\" -ServerAddresses (\"176.99.11.77\",\"80.78.247.254\")",
              "admin": true,
              "desc": "Устанавливает Xbox DNS серверы",
              "vars": [
                {"id": "adapter", "label": "Имя сетевого адаптера", "hint": "Узнайте через: Get-NetAdapter", "default": "Ethernet", "normalize": "adapter"}
              ],
              "template": "Set-DnsClientServerAddress -InterfaceAlias \"{adapter}\" -ServerAddresses (\"176.99.11.77\",\"80.78.247.254\")"
            }
          ],
          "badges": [{"value": "176.99.11.77", "color": "blue"}, {"value": "80.78.247.254", "color": "blue"}]
        },
        {
          "title": "Google DNS",
          "commands": [
            {
              "name": "Установить Google DNS",
              "cmd": "Set-DnsClientServerAddress -InterfaceAlias \"Ethernet\" -ServerAddresses (\"8.8.8.8\",\"8.8.4.4\")",
              "admin": true,
              "desc": "Быстрые и надежные DNS от Google",
              "vars": [
                {"id": "adapter", "label": "Имя сетевого адаптера", "hint": "Узнайте через: Get-NetAdapter", "default": "Ethernet", "normalize": "adapter"}
              ],
              "template": "Set-DnsClientServerAddress -InterfaceAlias \"{adapter}\" -ServerAddresses (\"8.8.8.8\",\"8.8.4.4\")"
            }
          ],
          "badges": [{"value": "8.8.8.8", "color": "green"}, {"value": "8.8.4.4", "color": "green"}]
        },
        {
          "title": "Yandex DNS",
          "commands": [
            {
              "name": "Установить Yandex DNS",
              "cmd": "Set-DnsClientServerAddress -InterfaceAlias \"Ethernet\" -ServerAddresses (\"77.88.8.1\",\"77.88.8.8\")",
              "admin": true,
              "desc": "DNS от Яндекса, хорошая скорость в России",
              "vars": [
                {"id": "adapter", "label": "Имя сетевого адаптера", "hint": "Узнайте через: Get-NetAdapter", "default": "Ethernet", "normalize": "adapter"}
              ],
              "template": "Set-DnsClientServerAddress -InterfaceAlias \"{adapter}\" -ServerAddresses (\"77.88.8.1\",\"77.88.8.8\")"
            }
          ],
          "badges": [{"value": "77.88.8.1", "color": "green"}, {"value": "77.88.8.8", "color": "green"}]
        },
        {
          "title": "Cloudflare DNS",
          "commands": [
            {
              "name": "Установить Cloudflare DNS",
              "cmd": "Set-DnsClientServerAddress -InterfaceAlias \"Ethernet\" -ServerAddresses (\"1.1.1.1\",\"1.0.0.1\")",
              "admin": true,
              "desc": "Самые быстрые публичные DNS от Cloudflare",
              "vars": [
                {"id": "adapter", "label": "Имя сетевого адаптера", "hint": "Узнайте через: Get-NetAdapter", "default": "Ethernet", "normalize": "adapter"}
              ],
              "template": "Set-DnsClientServerAddress -InterfaceAlias \"{adapter}\" -ServerAddresses (\"1.1.1.1\",\"1.0.0.1\")"
            }
          ],
          "badges": [{"value": "1.1.1.1", "color": "purple"}, {"value": "1.0.0.1", "color": "purple"}]
        },
        {
          "title": "Безопасный DNS (DoH) для браузера",
          "description": "Шифрует DNS-запросы. Вставьте адрес в настройках безопасного DNS вашего браузера.",
          "commands": [],
          "badges": [
            {"value": "https://xbox-dns.ru/dns-query", "color": "orange"},
            {"value": "https://dns.google/dns-query", "color": "green"},
            {"value": "https://cloudflare-dns.com/dns-query", "color": "purple"}
          ]
        }
      ]
    },
    {
      "id": "network",
      "title": "Сеть",
      "icon": "wifi",
      "cards": [
        {
          "title": "Сетевые команды",
          "commands": [
            {"name": "Включить общий доступ к файлам", "cmd": "netsh advfirewall firewall set rule group=\"Общий доступ к файлам и принтерам\" new enable=Yes", "admin": true, "desc": "Разрешает общий доступ к файлам и принтерам в локальной сети"},
            {"name": "Сброс Winsock", "cmd": "netsh winsock reset", "admin": true, "desc": "Полный сброс сетевого стека Windows"},
            {"name": "Сброс TCP/IP", "cmd": "netsh int ip reset", "admin": true, "desc": "Сбрасывает настройки TCP/IP протокола"},
            {"name": "Освободить IP-адрес", "cmd": "ipconfig /release", "admin": true, "desc": "Освобождает текущий IP-адрес от DHCP"},
            {"name": "Обновить IP-адрес", "cmd": "ipconfig /renew", "admin": true, "desc": "Запрашивает новый IP у DHCP-сервера"},
            {"name": "Сетевые адаптеры", "cmd": "Get-NetAdapter", "admin": false, "desc": "Список всех сетевых подключений и их статус"},
            {
              "name": "Тест подключения",
              "cmd": "Test-NetConnection google.com -Port 80",
              "admin": false,
              "desc": "Проверяет соединение с сервером на указанном порту",
              "vars": [
                {"id": "host", "label": "Адрес сервера (IP или домен)", "default": "google.com"},
                {"id": "port", "label": "Номер порта", "default": "80", "type": "number"}
              ],
              "template": "Test-NetConnection {host} -Port {port}"
            },
            {"name": "Таблица маршрутизации", "cmd": "route print", "admin": false, "desc": "Отображает таблицу маршрутов сети"},
            {"name": "Внешний IP-адрес", "cmd": "(Invoke-RestMethod 'https://api.ipify.org?format=json').ip", "admin": false, "desc": "Показывает ваш публичный IP-адрес"},
            {"name": "ARP-таблица", "cmd": "Get-NetNeighbor | Where-Object State -ne 'Unreachable' | Format-Table -AutoSize", "admin": false, "desc": "Таблица соответствия IP и MAC-адресов в сети"},
            {"name": "Открытые порты", "cmd": "Get-NetTCPConnection -State Listen | Select-Object LocalPort, OwningProcess, @{N='Process';E={(Get-Process -Id $_.OwningProcess).ProcessName}} | Sort-Object LocalPort | Format-Table", "admin": false, "desc": "Список всех прослушиваемых портов и процессов"},
            {"name": "Скорость адаптера", "cmd": "Get-NetAdapter | Where-Object Status -eq 'Up' | Select-Object Name, LinkSpeed, MediaType", "admin": false, "desc": "Скорость подключения активных сетевых адаптеров"}
          ]
        }
      ]
    },
    {
      "id": "system",
      "title": "Система",
      "icon": "settings",
      "cards": [
        {
          "title": "Обслуживание системы",
          "commands": [
            {"name": "Очистка временных файлов", "cmd": "Get-ChildItem -Path $env:TEMP -Recurse | Remove-Item -Force -Recurse -ErrorAction SilentlyContinue", "admin": false, "desc": "Удаляет временные файлы текущего пользователя"},
            {"name": "Проверка системных файлов (SFC)", "cmd": "sfc /scannow", "admin": true, "desc": "Сканирует и восстанавливает поврежденные системные файлы"},
            {
              "name": "Проверка диска",
              "cmd": "chkdsk C: /f",
              "admin": true,
              "desc": "Проверяет диск на ошибки и исправляет их",
              "vars": [
                {"id": "drive", "label": "Буква диска для проверки", "default": "C", "normalize": "drive"}
              ],
              "template": "chkdsk {drive}: /f"
            },
            {
              "name": "Дефрагментация диска",
              "cmd": "Optimize-Volume -DriveLetter C -Defrag",
              "admin": true,
              "desc": "Оптимизирует размещение файлов на диске",
              "vars": [
                {"id": "drive", "label": "Буква диска", "default": "C", "normalize": "drive"}
              ],
              "template": "Optimize-Volume -DriveLetter {drive} -Defrag"
            },
            {"name": "Очистка корзины", "cmd": "Clear-RecycleBin -Force", "admin": false, "desc": "Полностью очищает корзину для всех дисков"},
            {"name": "Информация о дисках", "cmd": "Get-Disk", "admin": true, "desc": "Показывает информацию о всех физических дисках"},
            {
              "name": "Перезагрузка (с задержкой)",
              "cmd": "shutdown /r /t 60",
              "admin": true,
              "desc": "Перезагружает компьютер через указанное количество секунд",
              "vars": [
                {"id": "sec", "label": "Задержка в секундах", "default": "60", "type": "number"}
              ],
              "template": "shutdown /r /t {sec}"
            },
            {"name": "Синхронизация системного времени", "cmd": "Set-Service -Name W32Time -StartupType Automatic; Start-Service -Name W32Time -ErrorAction SilentlyContinue; w32tm /config /manualpeerlist:'pool.ntp.org,0x8' /syncfromflags:manual /update; Start-Sleep -Seconds 5; w32tm /resync /force; w32tm /query /status; Get-Date", "admin": true, "desc": "Полный сброс службы времени и принудительная синхронизация"}
          ]
        },
        {
          "title": "Установленное ПО",
          "commands": [
            {"name": "Все программы (winget)", "cmd": "winget list", "admin": false, "desc": "Список всех установленных программ через winget"},
            {"name": "Обновить всё (winget)", "cmd": "winget upgrade --all", "admin": true, "desc": "Обновляет все программы, для которых есть обновления"},
            {"name": "Программы из реестра", "cmd": "Get-ItemProperty HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select-Object DisplayName, DisplayVersion, Publisher | Sort-Object DisplayName | Format-Table -AutoSize", "admin": false, "desc": "Полный список программ из реестра Windows"},
            {"name": "Пакеты из Microsoft Store", "cmd": "Get-AppxPackage | Select-Object Name, Version | Sort-Object Name", "admin": false, "desc": "Все приложения, установленные из Microsoft Store"}
          ]
        },
        {
          "title": "Питание и загрузка",
          "commands": [
            {"name": "Отчет по батарее", "cmd": "powercfg /batteryreport /output \"$env:USERPROFILE\\Desktop\\battery.html\"; Invoke-Item \"$env:USERPROFILE\\Desktop\\battery.html\"", "admin": true, "desc": "Создает подробный HTML-отчет о состоянии батареи"},
            {"name": "Текущая схема питания", "cmd": "powercfg /getactivescheme", "admin": false, "desc": "Показывает активную схему электропитания"},
            {"name": "Программы в автозагрузке", "cmd": "Get-CimInstance Win32_StartupCommand | Select-Object Name, Command, Location | Format-Table -AutoSize", "admin": false, "desc": "Список программ, запускающихся вместе с Windows"},
            {"name": "Время последней загрузки", "cmd": "(Get-CimInstance Win32_OperatingSystem).LastBootUpTime", "admin": false, "desc": "Когда компьютер был загружен в последний раз"}
          ]
        }
      ]
    },
    {
      "id": "services",
      "title": "Службы",
      "icon": "layers",
      "cards": [
        {
          "title": "Управление службами",
          "commands": [
            {
              "name": "Перезапуск службы",
              "cmd": "Restart-Service -Name wuauserv",
              "admin": true,
              "desc": "Перезапускает указанную службу",
              "vars": [
                {"id": "svc", "label": "Имя службы (ServiceName)", "hint": "Примеры: wuauserv, Spooler, AudioSrv, Dhcp", "default": "wuauserv"}
              ],
              "template": "Restart-Service -Name {svc}"
            },
            {
              "name": "Остановить службу",
              "cmd": "Stop-Service -Name wuauserv",
              "admin": true,
              "desc": "Останавливает указанную службу",
              "vars": [
                {"id": "svc", "label": "Имя службы (ServiceName)", "hint": "Примеры: wuauserv, Spooler, AudioSrv", "default": "wuauserv"}
              ],
              "template": "Stop-Service -Name {svc}"
            },
            {
              "name": "Запустить службу",
              "cmd": "Start-Service -Name wuauserv",
              "admin": true,
              "desc": "Запускает указанную службу",
              "vars": [
                {"id": "svc", "label": "Имя службы (ServiceName)", "hint": "Примеры: wuauserv, Spooler, AudioSrv", "default": "wuauserv"}
              ],
              "template": "Start-Service -Name {svc}"
            },
            {"name": "Все службы (сортировка)", "cmd": "Get-Service | Sort-Object Status, Name", "admin": false, "desc": "Показывает все службы и их статус"},
            {"name": "Службы в автозапуске", "cmd": "Get-Service | Where-Object {$_.StartType -eq 'Automatic'}", "admin": false, "desc": "Службы с автоматическим запуском"},
            {"name": "Остановленные службы", "cmd": "Get-Service | Where-Object Status -eq 'Stopped' | Select-Object Name, DisplayName | Sort-Object DisplayName", "admin": false, "desc": "Все службы, которые сейчас остановлены"},
            {
              "name": "Зависимости службы",
              "cmd": "Get-Service wuauserv | Select-Object -ExpandProperty DependentServices",
              "admin": false,
              "desc": "Показывает, какие службы зависят от указанной",
              "vars": [
                {"id": "svc", "label": "Имя службы", "default": "wuauserv"}
              ],
              "template": "Get-Service {svc} | Select-Object -ExpandProperty DependentServices"
            }
          ]
        }
      ]
    },
    {
      "id": "registry",
      "title": "Реестр",
      "icon": "file-text",
      "cards": [
        {
          "title": "Настройки реестра и системы",
          "warning": "Создайте точку восстановления перед изменением реестра!",
          "commands": [
            {"name": "Создать точку восстановления", "cmd": "Checkpoint-Computer -Description \"Manual Restore Point\"", "admin": true, "desc": "Создает точку восстановления системы"},
            {"name": "Отключить телеметрию", "cmd": "Set-ItemProperty -Path \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection\" -Name \"AllowTelemetry\" -Value 0", "admin": true, "desc": "Минимизирует сбор данных Windows"},
            {"name": "Показать скрытые файлы", "cmd": "Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\" -Name \"Hidden\" -Value 1", "admin": false, "desc": "Включает отображение скрытых файлов в проводнике"},
            {"name": "Показать расширения файлов", "cmd": "Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\" -Name \"HideFileExt\" -Value 0", "admin": false, "desc": "Отображает расширения для всех типов файлов"},
            {"name": "Программы в автозапуске", "cmd": "Get-CimInstance -ClassName Win32_StartupCommand | Select-Object Name, Command, Location", "admin": false, "desc": "Показывает программы в автозапуске"},
            {"name": "Открыть редактор реестра", "cmd": "regedit", "admin": true, "desc": "Запускает regedit для ручного редактирования"},
            {"name": "Отключить уведомления", "cmd": "Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\PushNotifications\" -Name \"ToastEnabled\" -Value 0", "admin": false, "desc": "Отключает всплывающие уведомления Windows"},
            {"name": "Ускорить меню Пуск", "cmd": "Set-ItemProperty -Path \"HKCU:\\Control Panel\\Desktop\" -Name \"MenuShowDelay\" -Value 0", "admin": false, "desc": "Убирает задержку при открытии меню Пуск"},
            {"name": "Отключить Cortana", "cmd": "Set-ItemProperty -Path \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search\" -Name \"AllowCortana\" -Value 0", "admin": true, "desc": "Полностью отключает голосовой помощник Cortana"},
            {"name": "Классическое контекстное меню (Win11)", "cmd": "reg add \"HKCU\\Software\\Classes\\CLSID\\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\\InprocServer32\" /f /ve", "admin": false, "desc": "Возвращает полное контекстное меню правой кнопки мыши", "note": "Перезапустите Explorer"}
          ]
        }
      ]
    },
    {
      "id": "diagnostics",
      "title": "Диагностика",
      "icon": "activity",
      "cards": [
        {
          "title": "Информация о системе",
          "commands": [
            {"name": "Информация о процессоре", "cmd": "Get-CimInstance -ClassName Win32_Processor | Select-Object Name, NumberOfCores, MaxClockSpeed", "admin": false, "desc": "Подробная информация о CPU"},
            {"name": "Информация о памяти (RAM)", "cmd": "Get-CimInstance -ClassName Win32_OperatingSystem | Select-Object @{Name=\"Total RAM (GB)\";Expression={[math]::Round($_.TotalVisibleMemorySize/1MB,2)}}, @{Name=\"Free RAM (GB)\";Expression={[math]::Round($_.FreePhysicalMemory/1MB,2)}}", "admin": false, "desc": "Показывает общий объем и свободную оперативную память"},
            {"name": "Использование дисков", "cmd": "Get-Volume | Where-Object {$_.DriveType -eq \"Fixed\"} | Select-Object DriveLetter, @{Name=\"Size(GB)\";Expression={[math]::Round($_.Size/1GB,2)}}, @{Name=\"Free(GB)\";Expression={[math]::Round($_.SizeRemaining/1GB,2)}}", "admin": false, "desc": "Показывает свободное место на всех дисках"},
            {"name": "Топ-10 процессов по CPU", "cmd": "Get-Process | Sort-Object CPU -Descending | Select-Object -First 10 ProcessName, CPU, WorkingSet", "admin": false, "desc": "Процессы, больше всего загружающие процессор"},
            {"name": "Топ-10 процессов по RAM", "cmd": "Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10 ProcessName, @{Name='RAM(MB)';Expression={[math]::Round($_.WorkingSet/1MB,2)}}", "admin": false, "desc": "Процессы, потребляющие больше всего памяти"},
            {"name": "Время работы системы (Uptime)", "cmd": "Get-CimInstance -ClassName Win32_OperatingSystem | Select-Object @{Name=\"Uptime\";Expression={(Get-Date) - $_.LastBootUpTime}}", "admin": false, "desc": "Как долго работает компьютер без перезагрузки"},
            {"name": "Полная информация о ПК", "cmd": "Get-ComputerInfo", "admin": false, "desc": "Собирает всю основную информацию о системе"},
            {"name": "Диагностика RAM", "cmd": "mdsched", "admin": true, "desc": "Планирует проверку оперативной памяти при перезагрузке"},
            {"name": "Видеокарта (GPU)", "cmd": "Get-CimInstance -ClassName Win32_VideoController | Select-Object Name, DriverVersion, @{Name='VRAM(GB)';Expression={[math]::Round($_.AdapterRAM/1GB,2)}}", "admin": false, "desc": "Модель, версия драйвера и объем видеопамяти"},
            {"name": "Информация о BIOS", "cmd": "Get-CimInstance -ClassName Win32_BIOS | Select-Object Manufacturer, SMBIOSBIOSVersion, ReleaseDate", "admin": false, "desc": "Производитель и версия BIOS"},
            {"name": "Температура (если поддерживается)", "cmd": "Get-CimInstance MSAcpi_ThermalZoneTemperature -Namespace root/wmi -ErrorAction SilentlyContinue | Select-Object @{N='Zone';E={$_.InstanceName}}, @{N='Temp(C)';E={($_.CurrentTemperature-2732)/10}}", "admin": true, "desc": "Температура через WMI, работает не на всех системах"},
            {
              "name": "Последние ошибки в журнале",
              "cmd": "Get-WinEvent -LogName System -MaxEvents 20 | Where-Object Level -le 2 | Select-Object TimeCreated, LevelDisplayName, Message | Format-Table -Wrap",
              "admin": true,
              "desc": "События с уровнем ошибки или критической ошибки",
              "vars": [
                {"id": "count", "label": "Количество последних событий", "default": "20", "type": "number"}
              ],
              "template": "Get-WinEvent -LogName System -MaxEvents {count} | Where-Object Level -le 2 | Select-Object TimeCreated, LevelDisplayName, Message | Format-Table -Wrap"
            }
          ]
        }
      ]
    },
    {
      "id": "security",
      "title": "Безопасность",
      "icon": "shield",
      "cards": [
        {
          "title": "Антивирус и защита",
          "commands": [
            {"name": "Быстрое сканирование Defender", "cmd": "Start-MpScan -ScanType QuickScan", "admin": true, "desc": "Запускает быстрое сканирование Windows Defender"},
            {"name": "Полное сканирование Defender", "cmd": "Start-MpScan -ScanType FullScan", "admin": true, "desc": "Запускает полное сканирование всей системы"},
            {"name": "Обновить базы вирусов", "cmd": "Update-MpSignature", "admin": true, "desc": "Обновляет антивирусные определения Windows Defender"},
            {"name": "Статус Windows Defender", "cmd": "Get-MpPreference | Select-Object RealTimeProtectionEnabled, DisableBehaviorMonitoring, DisableIOAVProtection", "admin": false, "desc": "Показывает состояние защиты системы"},
            {"name": "DISM: проверка целостности", "cmd": "DISM /Online /Cleanup-Image /CheckHealth", "admin": true, "desc": "Проверяет целостность образа Windows"},
            {"name": "DISM: восстановление", "cmd": "DISM /Online /Cleanup-Image /RestoreHealth", "admin": true, "desc": "Восстанавливает поврежденные компоненты Windows"},
            {"name": "Статус брандмауэра", "cmd": "Get-NetFirewallProfile | Select-Object Name, Enabled", "admin": false, "desc": "Показывает включен ли Windows Firewall"},
            {"name": "Включить брандмауэр", "cmd": "Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True", "admin": true, "desc": "Включает брандмауэр для всех профилей сети"}
          ]
        },
        {
          "title": "Снятие блокировки скачанных файлов (Zone.Identifier)",
          "description": "Windows помечает файлы из интернета как потенциально опасные.",
          "commands": [
            {
              "name": "Разблокировать файлы в папке",
              "cmd": "Get-ChildItem -Path \"C:\\Users\\User\\Downloads\" -Recurse -File | Unblock-File\nWrite-Host 'Блокировка снята!' -ForegroundColor Green",
              "admin": false,
              "desc": "Снимает блокировку со всех файлов в указанной папке и подпапках",
              "vars": [
                {"id": "path", "label": "Путь к папке с заблокированными файлами", "default": "C:\\Users\\User\\Downloads", "normalize": "path"}
              ],
              "template": "Get-ChildItem -Path \"{path}\" -Recurse -File | Unblock-File\nWrite-Host 'Блокировка снята!' -ForegroundColor Green"
            },
            {"name": "Отключить блокировку навсегда", "cmd": "New-Item -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Attachments\" -Force\nSet-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Attachments\" -Name \"SaveZoneInformation\" -Value 1 -Type DWord", "admin": false, "desc": "Windows больше не будет помечать скачанные файлы как заблокированные", "note": "Требуется перезагрузка"},
            {"name": "Вернуть блокировку скачанных файлов", "cmd": "Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Attachments\" -Name \"SaveZoneInformation\" -Value 2 -Type DWord", "admin": false, "desc": "Возвращает стандартное поведение Windows по блокировке файлов"}
          ]
        },
        {
          "title": "Аудит безопасности",
          "commands": [
            {
              "name": "Аудит входов в систему",
              "cmd": "Get-WinEvent -LogName Security -FilterXPath \"*[System[EventID=4624]]\" -MaxEvents 20 | Select-Object TimeCreated, @{N='User';E={$_.Properties[5].Value}} | Format-Table",
              "admin": true,
              "desc": "Последние события входа в систему",
              "vars": [
                {"id": "count", "label": "Количество событий", "default": "20", "type": "number"}
              ],
              "template": "Get-WinEvent -LogName Security -FilterXPath \"*[System[EventID=4624]]\" -MaxEvents {count} | Select-Object TimeCreated, @{N='User';E={$_.Properties[5].Value}} | Format-Table"
            },
            {
              "name": "Заблокированные подключения",
              "cmd": "Get-WinEvent -LogName Security -FilterXPath \"*[System[EventID=5157]]\" -MaxEvents 20 -ErrorAction SilentlyContinue | Select-Object TimeCreated, Message | Format-Table -Wrap",
              "admin": true,
              "desc": "Подключения, заблокированные Windows Firewall",
              "vars": [
                {"id": "count", "label": "Количество событий", "default": "20", "type": "number"}
              ],
              "template": "Get-WinEvent -LogName Security -FilterXPath \"*[System[EventID=5157]]\" -MaxEvents {count} -ErrorAction SilentlyContinue | Select-Object TimeCreated, Message | Format-Table -Wrap"
            }
          ]
        }
      ]
    },
    {
      "id": "users",
      "title": "Пользователи",
      "icon": "users",
      "cards": [
        {
          "title": "Управление пользователями",
          "commands": [
            {"name": "Текущий пользователь", "cmd": "whoami", "admin": false, "desc": "Показывает имя текущего пользователя"},
            {"name": "Все локальные пользователи", "cmd": "Get-LocalUser | Select-Object Name, Enabled, LastLogon | Format-Table", "admin": false, "desc": "Список всех учетных записей на компьютере"},
            {"name": "Группы и их члены", "cmd": "Get-LocalGroup | ForEach-Object { $g=$_.Name; Get-LocalGroupMember $g -ErrorAction SilentlyContinue | Select-Object @{N='Group';E={$g}}, Name } | Format-Table", "admin": true, "desc": "Все группы и кто в них входит"},
            {
              "name": "Создать пользователя",
              "cmd": "$pw = Read-Host 'Пароль' -AsSecureString; New-LocalUser -Name 'NewUser' -Password $pw -FullName 'Новый Пользователь'",
              "admin": true,
              "desc": "Создает нового локального пользователя",
              "vars": [
                {"id": "user", "label": "Имя пользователя (логин)", "default": "NewUser"},
                {"id": "fullname", "label": "Полное имя пользователя", "default": "Новый Пользователь"}
              ],
              "template": "$pw = Read-Host 'Пароль' -AsSecureString; New-LocalUser -Name '{user}' -Password $pw -FullName '{fullname}'"
            },
            {
              "name": "Добавить в Администраторы",
              "cmd": "Add-LocalGroupMember -Group 'Administrators' -Member 'NewUser'",
              "admin": true,
              "desc": "Дает пользователю права администратора",
              "vars": [
                {"id": "user", "label": "Имя пользователя", "default": "NewUser"}
              ],
              "template": "Add-LocalGroupMember -Group 'Administrators' -Member '{user}'"
            },
            {
              "name": "Отключить пользователя",
              "cmd": "Disable-LocalUser -Name 'NewUser'",
              "admin": true,
              "desc": "Деактивирует учетную запись без удаления",
              "vars": [
                {"id": "user", "label": "Имя пользователя", "default": "NewUser"}
              ],
              "template": "Disable-LocalUser -Name '{user}'"
            },
            {
              "name": "Сменить пароль",
              "cmd": "$pw = Read-Host 'Новый пароль' -AsSecureString; Set-LocalUser -Name 'UserName' -Password $pw",
              "admin": true,
              "desc": "Меняет пароль для указанного пользователя",
              "vars": [
                {"id": "user", "label": "Имя пользователя", "default": "UserName"}
              ],
              "template": "$pw = Read-Host 'Новый пароль' -AsSecureString; Set-LocalUser -Name '{user}' -Password $pw"
            }
          ]
        }
      ]
    },
    {
      "id": "cleanup",
      "title": "Очистка",
      "icon": "trash",
      "cards": [
        {
          "title": "Очистка системы",
          "commands": [
            {"name": "Очистка temp (пользователь)", "cmd": "Remove-Item \"$env:TEMP\\*\" -Recurse -Force -ErrorAction SilentlyContinue", "admin": false, "desc": "Удаляет временные файлы текущего пользователя"},
            {"name": "Очистка temp (система)", "cmd": "Remove-Item \"$env:windir\\Temp\\*\" -Recurse -Force -ErrorAction SilentlyContinue", "admin": true, "desc": "Удаляет системные временные файлы"},
            {"name": "Очистка кэша обновлений", "cmd": "Stop-Service wuauserv -Force; Remove-Item \"$env:windir\\SoftwareDistribution\\Download\\*\" -Recurse -Force -ErrorAction SilentlyContinue; Start-Service wuauserv", "admin": true, "desc": "Очищает скачанные файлы обновлений Windows"},
            {"name": "Очистка Prefetch", "cmd": "Remove-Item \"$env:windir\\Prefetch\\*\" -Force -ErrorAction SilentlyContinue", "admin": true, "desc": "Удаляет файлы предзагрузки программ"},
            {"name": "Размер папки temp", "cmd": "'{0:N2} MB' -f ((Get-ChildItem $env:TEMP -Recurse -ErrorAction SilentlyContinue | Measure-Object Length -Sum).Sum/1MB)", "admin": false, "desc": "Показывает сколько места занимают временные файлы"},
            {"name": "Очистка всех логов событий", "cmd": "wevtutil el | ForEach-Object { wevtutil cl $_ 2>$null }", "admin": true, "desc": "Очищает все журналы событий Windows"},
            {
              "name": "Очистка диска (GUI)",
              "cmd": "cleanmgr /d C",
              "admin": true,
              "desc": "Запускает встроенную утилиту очистки диска",
              "vars": [
                {"id": "drive", "label": "Буква диска", "default": "C", "normalize": "drive"}
              ],
              "template": "cleanmgr /d {drive}"
            },
            {"name": "Удалить старые точки восстановления", "cmd": "vssadmin delete shadows /for=C: /oldest", "admin": true, "desc": "Удаляет самую старую теневую копию для освобождения места"}
          ]
        }
      ]
    },
    {
      "id": "apps",
      "title": "Приложения",
      "icon": "monitor",
      "cards": [
        {
          "title": "Управление приложениями (winget)",
          "commands": [
            {"name": "Список установленных", "cmd": "winget list", "admin": false, "desc": "Показывает все установленные программы"},
            {
              "name": "Поиск пакета",
              "cmd": "winget search \"название\"",
              "admin": false,
              "desc": "Ищет приложение в репозитории winget",
              "vars": [
                {"id": "name", "label": "Название приложения для поиска", "default": "название"}
              ],
              "template": "winget search \"{name}\""
            },
            {
              "name": "Установить приложение",
              "cmd": "winget install --id \"App.Id\" --source winget",
              "admin": false,
              "desc": "Устанавливает приложение по его идентификатору",
              "vars": [
                {"id": "appid", "label": "ID приложения (например: Google.Chrome)", "hint": "Найдите ID через: winget search \"название\"", "default": "App.Id"}
              ],
              "template": "winget install --id \"{appid}\" --source winget"
            },
            {
              "name": "Удалить приложение",
              "cmd": "winget uninstall --id \"App.Id\"",
              "admin": false,
              "desc": "Удаляет установленное приложение",
              "vars": [
                {"id": "appid", "label": "ID приложения", "hint": "Найдите ID через: winget list", "default": "App.Id"}
              ],
              "template": "winget uninstall --id \"{appid}\""
            },
            {"name": "Обновить все приложения", "cmd": "winget upgrade --all --include-unknown", "admin": true, "desc": "Обновляет все программы, для которых есть обновления"},
            {"name": "Экспорт списка ПО на рабочий стол", "cmd": "winget list | Out-File \"$env:USERPROFILE\\Desktop\\apps.txt\"; Write-Host 'Сохранено на рабочий стол' -ForegroundColor Green", "admin": false, "desc": "Сохраняет список всех программ в текстовый файл"}
          ]
        },
        {
          "title": "Встроенные приложения Windows",
          "commands": [
                     {"name": "Список всех встроенных приложений", "cmd": "Get-AppxPackage | Select-Object Name | Sort-Object Name", "admin": false, "desc": "Все приложения из Microsoft Store и встроенные"},
            {"name": "Удалить Xbox приложения", "cmd": "Get-AppxPackage *xbox* | Remove-AppxPackage", "admin": false, "desc": "Удаляет все приложения Xbox"},
            {"name": "Удалить Cortana", "cmd": "Get-AppxPackage *cortana* | Remove-AppxPackage", "admin": false, "desc": "Удаляет голосовой помощник Cortana"}
          ]
        }
      ]
    },
    {
      "id": "automation",
      "title": "Автоматизация",
      "icon": "zap",
      "cards": [
        {
          "title": "Архивирование и резервное копирование",
          "commands": [
            {
              "name": "Заархивировать папку с датой",
              "cmd": "$src = \"C:\\Users\\Admin\\Documents\"; $dst = \"$env:USERPROFILE\\Desktop\\Backup_$(Get-Date -Format 'yyyyMMdd').zip\"; Compress-Archive -Path $src -DestinationPath $dst -Force; Write-Host \"Сохранено: $dst\" -ForegroundColor Green",
              "admin": false,
              "desc": "Создаёт ZIP-архив указанной папки с текущей датой в имени файла",
              "vars": [
                {"id": "src", "label": "Папка для архивации", "default": "C:\\Users\\Admin\\Documents", "normalize": "path"}
              ],
              "template": "$src = \"{src}\"; $dst = \"$env:USERPROFILE\\Desktop\\Backup_$(Get-Date -Format 'yyyyMMdd').zip\"; Compress-Archive -Path $src -DestinationPath $dst -Force; Write-Host \"Сохранено: $dst\" -ForegroundColor Green"
            },
            {
              "name": "Заархивировать несколько папок",
              "cmd": "$folders = @(\"$env:USERPROFILE\\Documents\", \"$env:USERPROFILE\\Desktop\"); $dst = \"$env:USERPROFILE\\Desktop\\Backup_$(Get-Date -Format 'yyyyMMdd').zip\"; Compress-Archive -Path $folders -DestinationPath $dst -Force; Write-Host \"Готово: $dst\" -ForegroundColor Green",
              "admin": false,
              "desc": "Архивирует сразу несколько папок в один архив"
            },
            {
              "name": "Распаковать архив",
              "cmd": "$zip = \"C:\\Backup\\archive.zip\"; $dest = \"C:\\Backup\\Extracted\"; Expand-Archive -Path $zip -DestinationPath $dest -Force; Write-Host \"Распаковано в: $dest\" -ForegroundColor Green",
              "admin": false,
              "desc": "Распаковывает ZIP-архив в указанную папку",
              "vars": [
                {"id": "zip", "label": "Путь к ZIP-архиву", "default": "C:\\Backup\\archive.zip", "normalize": "path"},
                {"id": "dest", "label": "Папка для распаковки", "default": "C:\\Backup\\Extracted", "normalize": "path"}
              ],
              "template": "$zip = \"{zip}\"; $dest = \"{dest}\"; Expand-Archive -Path $zip -DestinationPath $dest -Force; Write-Host \"Распаковано в: $dest\" -ForegroundColor Green"
            }
          ]
        },
        {
          "title": "Очистка файлов",
          "commands": [
            {
              "name": "Удалить файлы старше N дней",
              "cmd": "$path = \"C:\\Logs\"; $days = 30; Get-ChildItem -Path $path -Recurse -File | Where-Object { $_.LastWriteTime -lt (Get-Date).AddDays(-$days) } | Remove-Item -Force -ErrorAction SilentlyContinue; Write-Host \"Удалены файлы старше $days дней\" -ForegroundColor Green",
              "admin": false,
              "desc": "Удаляет все файлы в папке, которые не изменялись более указанного количества дней",
              "vars": [
                {"id": "path", "label": "Папка для очистки", "default": "C:\\Logs", "normalize": "path"},
                {"id": "days", "label": "Удалить файлы старше (дней)", "default": "30", "type": "number"}
              ],
              "template": "$path = \"{path}\"; $days = {days}; Get-ChildItem -Path $path -Recurse -File | Where-Object { $_.LastWriteTime -lt (Get-Date).AddDays(-$days) } | Remove-Item -Force -ErrorAction SilentlyContinue; Write-Host \"Удалены файлы старше $days дней\" -ForegroundColor Green"
            },
            {
              "name": "Удалить пустые папки",
              "cmd": "$path = \"C:\\Temp\"; Get-ChildItem -Path $path -Directory -Recurse | Where-Object { (Get-ChildItem $_.FullName -Recurse -File).Count -eq 0 } | Remove-Item -Recurse -Force; Write-Host \"Пустые папки удалены\" -ForegroundColor Green",
              "admin": false,
              "desc": "Рекурсивно удаляет все пустые папки в указанном расположении",
              "vars": [
                {"id": "path", "label": "Папка для поиска пустых подпапок", "default": "C:\\Temp", "normalize": "path"}
              ],
              "template": "$path = \"{path}\"; Get-ChildItem -Path $path -Directory -Recurse | Where-Object { (Get-ChildItem $_.FullName -Recurse -File).Count -eq 0 } | Remove-Item -Recurse -Force; Write-Host \"Пустые папки удалены\" -ForegroundColor Green"
            },
            {
              "name": "Удалить файлы по маске",
              "cmd": "$path = \"C:\\Downloads\"; Get-ChildItem -Path $path -Filter \"*.tmp\" | Remove-Item -Force; Write-Host \"Временные файлы удалены\" -ForegroundColor Green",
              "admin": false,
              "desc": "Удаляет все файлы по указанной маске (например, *.tmp, *.log)",
              "vars": [
                {"id": "path", "label": "Папка для очистки", "default": "C:\\Downloads", "normalize": "path"},
                {"id": "mask", "label": "Маска файлов (например *.tmp, *.log)", "default": "*.tmp"}
              ],
              "template": "$path = \"{path}\"; Get-ChildItem -Path $path -Filter \"{mask}\" | Remove-Item -Force; Write-Host \"Файлы по маске {mask} удалены\" -ForegroundColor Green"
            }
          ]
        },
        {
          "title": "Массовое переименование",
          "commands": [
            {
              "name": "Добавить префикс к файлам",
              "cmd": "$path = \"C:\\Photos\"; $prefix = \"vacation_\"; Get-ChildItem -Path $path -File | ForEach-Object { Rename-Item $_.FullName -NewName \"$prefix$($_.Name)\" }; Write-Host \"Готово\" -ForegroundColor Green",
              "admin": false,
              "desc": "Добавляет указанный префикс ко всем файлам в папке",
              "vars": [
                {"id": "path", "label": "Папка с файлами", "default": "C:\\Photos", "normalize": "path"},
                {"id": "prefix", "label": "Префикс для добавления", "default": "vacation_"}
              ],
              "template": "$path = \"{path}\"; $prefix = \"{prefix}\"; Get-ChildItem -Path $path -File | ForEach-Object { Rename-Item $_.FullName -NewName \"$prefix$($_.Name)\" }; Write-Host \"Готово\" -ForegroundColor Green"
            },
            {
              "name": "Заменить пробелы в именах",
              "cmd": "$path = \"C:\\Files\"; Get-ChildItem -Path $path -File | ForEach-Object { $new = $_.Name -replace ' ', '_'; Rename-Item $_.FullName -NewName $new }; Write-Host \"Пробелы заменены на _\" -ForegroundColor Green",
              "admin": false,
              "desc": "Заменяет все пробелы в именах файлов на нижнее подчёркивание",
              "vars": [
                {"id": "path", "label": "Папка с файлами", "default": "C:\\Files", "normalize": "path"}
              ],
              "template": "$path = \"{path}\"; Get-ChildItem -Path $path -File | ForEach-Object { $new = $_.Name -replace ' ', '_'; Rename-Item $_.FullName -NewName $new }; Write-Host \"Пробелы заменены на _\" -ForegroundColor Green"
            },
            {
              "name": "Переименовать по дате",
              "cmd": "$path = \"C:\\Downloads\"; Get-ChildItem -Path $path -File | ForEach-Object { $ext = $_.Extension; $date = $_.LastWriteTime.ToString('yyyyMMdd'); Rename-Item $_.FullName -NewName \"${date}_$($_.BaseName)$ext\" }; Write-Host \"Готово\" -ForegroundColor Green",
              "admin": false,
              "desc": "Переименовывает файлы, добавляя дату изменения в начало имени",
              "vars": [
                {"id": "path", "label": "Папка с файлами", "default": "C:\\Downloads", "normalize": "path"}
              ],
              "template": "$path = \"{path}\"; Get-ChildItem -Path $path -File | ForEach-Object { $ext = $_.Extension; $date = $_.LastWriteTime.ToString('yyyyMMdd'); Rename-Item $_.FullName -NewName \"${date}_$($_.BaseName)$ext\" }; Write-Host \"Готово\" -ForegroundColor Green"
            }
          ]
        },
        {
          "title": "Копирование и перемещение",
          "commands": [
            {
              "name": "Копировать только JPG/PNG",
              "cmd": "$src = \"C:\\Photos\"; $dst = \"C:\\Backup\\Images\"; Get-ChildItem -Path $src -Include *.jpg,*.jpeg,*.png -Recurse | Copy-Item -Destination $dst -Force; Write-Host \"Изображения скопированы\" -ForegroundColor Green",
              "admin": false,
              "desc": "Копирует только изображения указанных форматов",
              "vars": [
                {"id": "src", "label": "Папка-источник с изображениями", "default": "C:\\Photos", "normalize": "path"},
                {"id": "dst", "label": "Папка назначения", "default": "C:\\Backup\\Images", "normalize": "path"}
              ],
              "template": "$src = \"{src}\"; $dst = \"{dst}\"; New-Item -ItemType Directory -Path $dst -Force | Out-Null; Get-ChildItem -Path $src -Include *.jpg,*.jpeg,*.png -Recurse | Copy-Item -Destination $dst -Force; Write-Host \"Изображения скопированы\" -ForegroundColor Green"
            },
            {
              "name": "Синхронизировать папки",
              "cmd": "$src = \"C:\\Source\"; $dst = \"C:\\Backup\"; Get-ChildItem -Path $src -Recurse | Where-Object { -not (Test-Path \"$dst\\$($_.FullName.Substring($src.Length+1))\") } | Copy-Item -Destination { Join-Path $dst $_.FullName.Substring($src.Length+1) } -Force; Write-Host \"Синхронизация завершена\" -ForegroundColor Green",
              "admin": false,
              "desc": "Копирует только новые файлы, которых нет в папке назначения",
              "vars": [
                {"id": "src", "label": "Папка-источник", "default": "C:\\Source", "normalize": "path"},
                {"id": "dst", "label": "Папка назначения (бэкап)", "default": "C:\\Backup", "normalize": "path"}
              ],
              "template": "$src = \"{src}\"; $dst = \"{dst}\"; Get-ChildItem -Path $src -Recurse | Where-Object { -not (Test-Path \"$dst\\$($_.FullName.Substring($src.Length+1))\") } | Copy-Item -Destination { Join-Path $dst $_.FullName.Substring($src.Length+1) } -Force; Write-Host \"Синхронизация завершена\" -ForegroundColor Green"
            }
          ]
        }
      ]
    },
    {
      "id": "monitoring",
      "title": "Мониторинг",
      "icon": "radar",
      "cards": [
        {
          "title": "Процессы и ресурсы",
          "commands": [
            {"name": "Топ процессов по CPU", "cmd": "Get-Process | Sort-Object CPU -Descending | Select-Object -First 10 Name, @{N='CPU(s)';E={[math]::Round($_.CPU,2)}}, WorkingSet64 | Format-Table -AutoSize", "admin": false, "desc": "Показывает 10 процессов, больше всего нагружающих процессор"},
            {"name": "Топ процессов по памяти", "cmd": "Get-Process | Sort-Object WorkingSet64 -Descending | Select-Object -First 10 Name, @{N='RAM(MB)';E={[math]::Round($_.WorkingSet64/1MB,2)}} | Format-Table -AutoSize", "admin": false, "desc": "Показывает 10 процессов, потребляющих больше всего оперативной памяти"},
            {"name": "Мониторинг CPU (10 секунд)", "cmd": "1..10 | ForEach-Object { Write-Host \"CPU: $((Get-Counter '\\Processor(_Total)\\% Processor Time').CounterSamples.CookedValue.ToString('F1'))%\" -ForegroundColor $(if((Get-Counter '\\Processor(_Total)\\% Processor Time').CounterSamples.CookedValue -gt 80){'Red'}else{'Green'}); Start-Sleep 1 }", "admin": false, "desc": "Обновляет показатель CPU каждую секунду в течение 10 секунд"},
            {"name": "Мониторинг RAM (10 секунд)", "cmd": "$ram = (Get-CimInstance Win32_OperatingSystem); 1..10 | ForEach-Object { $used = [math]::Round(($ram.TotalVisibleMemorySize - $ram.FreePhysicalMemory)/1MB,1); $total = [math]::Round($ram.TotalVisibleMemorySize/1MB,1); Write-Host \"RAM: $used / $total GB ($([math]::Round($used/$total*100,1))%)\" -ForegroundColor $(if($used/$total -gt 0.9){'Red'}else{'Green'}); Start-Sleep 1; $ram = Get-CimInstance Win32_OperatingSystem }", "admin": false, "desc": "Обновляет показатель использования памяти каждую секунду"},
            {"name": "Закрыть зависший процесс", "cmd": "Get-Process | Where-Object {$_.Responding -eq $false} | Select-Object Name, Id | Format-Table", "admin": false, "desc": "Показывает список неотвечающих процессов"}
          ]
        },
        {
          "title": "Сеть",
          "commands": [
            {"name": "Текущие подключения TCP", "cmd": "Get-NetTCPConnection -State Established | Select-Object LocalAddress, LocalPort, RemoteAddress, RemotePort, @{N='Process';E={(Get-Process -Id $_.OwningProcess -ErrorAction SilentlyContinue).ProcessName}} | Sort-Object RemoteAddress | Format-Table -AutoSize", "admin": false, "desc": "Показывает все активные TCP-подключения с именами процессов"},
            {
              "name": "Непрерывный ping",
              "cmd": "1..30 | ForEach-Object { $r = Test-Connection -ComputerName 8.8.8.8 -Count 1 -ErrorAction SilentlyContinue; if($r){Write-Host \"OK: $($r.Latency)ms\" -ForegroundColor Green}else{Write-Host \"FAIL\" -ForegroundColor Red}; Start-Sleep 2 }",
              "admin": false,
              "desc": "Пингует указанный адрес каждые 2 секунды",
              "vars": [
                {"id": "host", "label": "IP-адрес или домен для пинга", "default": "8.8.8.8"},
                {"id": "count", "label": "Количество попыток", "default": "30", "type": "number"},
                {"id": "interval", "label": "Интервал (секунд)", "default": "2", "type": "number"}
              ],
              "template": "1..{count} | ForEach-Object { $r = Test-Connection -ComputerName {host} -Count 1 -ErrorAction SilentlyContinue; if($r){Write-Host \"OK: $($r.Latency)ms\" -ForegroundColor Green}else{Write-Host \"FAIL\" -ForegroundColor Red}; Start-Sleep {interval} }"
            },
            {"name": "Трафик по интерфейсам", "cmd": "Get-NetAdapterStatistics | Select-Object Name, ReceivedBytes, SentBytes | ForEach-Object { $_.ReceivedBytes = [math]::Round($_.ReceivedBytes/1MB,2); $_.SentBytes = [math]::Round($_.SentBytes/1MB,2); $_ } | Format-Table -AutoSize", "admin": false, "desc": "Показывает объём принятых и отправленных данных по каждому адаптеру"}
          ]
        },
        {
          "title": "Диски",
          "commands": [
            {"name": "Использование дисков", "cmd": "Get-Volume | Where-Object {$_.DriveLetter -ne $null} | Select-Object DriveLetter, @{N='Used(GB)';E={[math]::Round(($_.Size - $_.SizeRemaining)/1GB,2)}}, @{N='Free(GB)';E={[math]::Round($_.SizeRemaining/1GB,2)}}, @{N='%';E={[math]::Round(($_.SizeRemaining/$_.Size)*100,1)}} | Format-Table -AutoSize", "admin": false, "desc": "Показывает занятое и свободное место на всех дисках"},
            {
              "name": "Самые большие файлы в папке",
              "cmd": "$path = \"C:\\\"; Get-ChildItem -Path $path -File -Recurse -ErrorAction SilentlyContinue | Sort-Object Length -Descending | Select-Object -First 10 FullName, @{N='Size(MB)';E={[math]::Round($_.Length/1MB,2)}} | Format-Table -AutoSize",
              "admin": false,
              "desc": "Находит 10 самых больших файлов в указанной папке",
              "vars": [
                {"id": "path", "label": "Папка для анализа", "default": "C:\\", "normalize": "path"},
                {"id": "count", "label": "Количество файлов", "default": "10", "type": "number"}
              ],
              "template": "$path = \"{path}\"; Get-ChildItem -Path $path -File -Recurse -ErrorAction SilentlyContinue | Sort-Object Length -Descending | Select-Object -First {count} FullName, @{N='Size(MB)';E={[math]::Round($_.Length/1MB,2)}} | Format-Table -AutoSize"
            }
          ]
        }
      ]
    },
    {
      "id": "scheduler",
      "title": "Планировщик",
      "icon": "clipboard",
      "cards": [
        {
          "title": "Просмотр задач",
          "commands": [
            {"name": "Все задачи планировщика", "cmd": "Get-ScheduledTask | Select-Object TaskName, State, TaskPath | Format-Table -AutoSize", "admin": false, "desc": "Показывает все запланированные задачи и их состояние"},
            {"name": "Задачи в статусе Ready", "cmd": "Get-ScheduledTask | Where-Object {$_.State -eq 'Ready'} | Select-Object TaskName, TaskPath | Format-Table -AutoSize", "admin": false, "desc": "Показывает готовые к запуску задачи"},
            {"name": "Задачи текущего пользователя", "cmd": "Get-ScheduledTask | Where-Object {$_.Principal.UserId -eq $env:USERNAME} | Select-Object TaskName, State | Format-Table -AutoSize", "admin": false, "desc": "Показывает задачи, принадлежащие текущему пользователю"},
            {
              "name": "Информация о задаче",
              "cmd": "Get-ScheduledTaskInfo -TaskName \"ИмяЗадачи\" | Format-List",
              "admin": false,
              "desc": "Показывает подробную информацию о конкретной задаче",
              "vars": [
                {"id": "task", "label": "Имя задачи в планировщике", "hint": "Узнайте через: Get-ScheduledTask", "default": "ИмяЗадачи"}
              ],
              "template": "Get-ScheduledTaskInfo -TaskName \"{task}\" | Format-List"
            }
          ]
        },
        {
          "title": "Управление задачами",
          "commands": [
            {
              "name": "Запустить задачу вручную",
              "cmd": "Start-ScheduledTask -TaskName \"ИмяЗадачи\"",
              "admin": true,
              "desc": "Принудительно запускает указанную задачу",
              "vars": [
                {"id": "task", "label": "Имя задачи", "default": "ИмяЗадачи"}
              ],
              "template": "Start-ScheduledTask -TaskName \"{task}\""
            },
            {
              "name": "Остановить задачу",
              "cmd": "Stop-ScheduledTask -TaskName \"ИмяЗадачи\"",
              "admin": true,
              "desc": "Останавливает выполняющуюся задачу",
              "vars": [
                {"id": "task", "label": "Имя задачи", "default": "ИмяЗадачи"}
              ],
              "template": "Stop-ScheduledTask -TaskName \"{task}\""
            },
            {
              "name": "Включить задачу",
              "cmd": "Enable-ScheduledTask -TaskName \"ИмяЗадачи\"",
              "admin": true,
              "desc": "Включает отключённую задачу",
              "vars": [
                {"id": "task", "label": "Имя задачи", "default": "ИмяЗадачи"}
              ],
              "template": "Enable-ScheduledTask -TaskName \"{task}\""
            },
            {
              "name": "Отключить задачу",
              "cmd": "Disable-ScheduledTask -TaskName \"ИмяЗадачи\"",
              "admin": true,
              "desc": "Отключает задачу (не удаляя её)",
              "vars": [
                {"id": "task", "label": "Имя задачи", "default": "ИмяЗадачи"}
              ],
              "template": "Disable-ScheduledTask -TaskName \"{task}\""
            },
            {
              "name": "Удалить задачу",
              "cmd": "Unregister-ScheduledTask -TaskName \"ИмяЗадачи\" -Confirm:$false",
              "admin": true,
              "desc": "Удаляет задачу из планировщика",
              "vars": [
                {"id": "task", "label": "Имя задачи для удаления", "default": "ИмяЗадачи"}
              ],
              "template": "Unregister-ScheduledTask -TaskName \"{task}\" -Confirm:$false"
            }
          ]
        },
        {
          "title": "Создание задач",
          "commands": [
            {
              "name": "Создать задачу: ежедневно",
              "cmd": "$action = New-ScheduledTaskAction -Execute \"notepad.exe\"; $trigger = New-ScheduledTaskTrigger -Daily -At \"09:00\"; Register-ScheduledTask -TaskName \"MyDailyTask\" -Action $action -Trigger $trigger -Description \"Ежедневная задача\"",
              "admin": true,
              "desc": "Создаёт задачу с ежедневным запуском в указанное время",
              "vars": [
                {"id": "exe", "label": "Путь к программе или команда", "hint": "Например: notepad.exe или C:\\Scripts\\script.ps1", "default": "notepad.exe"},
                {"id": "time", "label": "Время запуска (ЧЧ:ММ)", "default": "09:00"},
                {"id": "name", "label": "Название задачи", "default": "MyDailyTask"},
                {"id": "descr", "label": "Описание задачи", "default": "Ежедневная задача"}
              ],
              "template": "$action = New-ScheduledTaskAction -Execute \"{exe}\"; $trigger = New-ScheduledTaskTrigger -Daily -At \"{time}\"; Register-ScheduledTask -TaskName \"{name}\" -Action $action -Trigger $trigger -Description \"{descr}\""
            },
            {
              "name": "Создать задачу: при входе",
              "cmd": "$action = New-ScheduledTaskAction -Execute \"C:\\Scripts\\myscript.ps1\"; $trigger = New-ScheduledTaskTrigger -AtLogOn; Register-ScheduledTask -TaskName \"MyLogonTask\" -Action $action -Trigger $trigger -Description \"Запуск при входе\"",
              "admin": true,
              "desc": "Создаёт задачу, которая выполняется при каждом входе пользователя",
              "vars": [
                {"id": "exe", "label": "Путь к программе или скрипту", "default": "C:\\Scripts\\myscript.ps1"},
                {"id": "name", "label": "Название задачи", "default": "MyLogonTask"}
              ],
              "template": "$action = New-ScheduledTaskAction -Execute \"{exe}\"; $trigger = New-ScheduledTaskTrigger -AtLogOn; Register-ScheduledTask -TaskName \"{name}\" -Action $action -Trigger $trigger -Description \"Запуск при входе\""
            },
            {
              "name": "Создать задачу: при загрузке ПК",
              "cmd": "$action = New-ScheduledTaskAction -Execute \"C:\\Scripts\\startup.ps1\"; $trigger = New-ScheduledTaskTrigger -AtStartup; Register-ScheduledTask -TaskName \"MyStartupTask\" -Action $action -Trigger $trigger -RunLevel Highest -Description \"Запуск при загрузке\"",
              "admin": true,
              "desc": "Создаёт задачу, которая выполняется при загрузке системы (до входа пользователя)",
              "vars": [
                {"id": "exe", "label": "Путь к программе или скрипту", "default": "C:\\Scripts\\startup.ps1"},
                {"id": "name", "label": "Название задачи", "default": "MyStartupTask"}
              ],
              "template": "$action = New-ScheduledTaskAction -Execute \"{exe}\"; $trigger = New-ScheduledTaskTrigger -AtStartup; Register-ScheduledTask -TaskName \"{name}\" -Action $action -Trigger $trigger -RunLevel Highest -Description \"Запуск при загрузке\""
            }
          ]
        }
      ]
    },
    {
      "id": "filesystem",
      "title": "Файловая система",
      "icon": "file-text",
      "cards": [
        {
          "title": "Ссылки и атрибуты",
          "commands": [
            {
              "name": "Создать символическую ссылку (папка)",
              "cmd": "New-Item -ItemType SymbolicLink -Path \"C:\\LinkFolder\" -Target \"C:\\RealFolder\"",
              "admin": true,
              "desc": "Создаёт символическую ссылку на папку",
              "vars": [
                {"id": "link", "label": "Путь к ссылке (будет создана)", "default": "C:\\LinkFolder", "normalize": "path"},
                {"id": "target", "label": "Целевая папка (существующая)", "default": "C:\\RealFolder", "normalize": "path"}
              ],
              "template": "New-Item -ItemType SymbolicLink -Path \"{link}\" -Target \"{target}\""
            },
            {
              "name": "Создать жёсткую ссылку (файл)",
              "cmd": "New-Item -ItemType HardLink -Path \"C:\\HardLink.txt\" -Target \"C:\\Original.txt\"",
              "admin": true,
              "desc": "Создаёт жёсткую ссылку для файла",
              "vars": [
                {"id": "link", "label": "Путь к жёсткой ссылке", "default": "C:\\HardLink.txt"},
                {"id": "target", "label": "Целевой файл", "default": "C:\\Original.txt"}
              ],
              "template": "New-Item -ItemType HardLink -Path \"{link}\" -Target \"{target}\""
            },
            {
              "name": "Создать ярлык",
              "cmd": "$ws = New-Object -ComObject WScript.Shell; $shortcut = $ws.CreateShortcut(\"$env:USERPROFILE\\Desktop\\Notepad.lnk\"); $shortcut.TargetPath = \"notepad.exe\"; $shortcut.Save()",
              "admin": false,
              "desc": "Создаёт ярлык на рабочем столе для указанной программы",
              "vars": [
                {"id": "name", "label": "Имя ярлыка (без .lnk)", "default": "Notepad"},
                {"id": "target", "label": "Путь к программе", "default": "notepad.exe"}
              ],
              "template": "$ws = New-Object -ComObject WScript.Shell; $shortcut = $ws.CreateShortcut(\"$env:USERPROFILE\\Desktop\\{name}.lnk\"); $shortcut.TargetPath = \"{target}\"; $shortcut.Save()"
            },
            {
              "name": "Показать атрибуты файла",
              "cmd": "Get-Item \"C:\\file.txt\" | Select-Object Attributes, CreationTime, LastWriteTime, Length | Format-List",
              "admin": false,
              "desc": "Показывает все атрибуты файла",
              "vars": [
                {"id": "file", "label": "Путь к файлу", "default": "C:\\file.txt"}
              ],
              "template": "Get-Item \"{file}\" | Select-Object Attributes, CreationTime, LastWriteTime, Length | Format-List"
            },
            {
              "name": "Сделать файл скрытым",
              "cmd": "Set-ItemProperty -Path \"C:\\file.txt\" -Name Attributes -Value ([System.IO.FileAttributes]::Hidden)",
              "admin": false,
              "desc": "Делает файл скрытым",
              "vars": [
                {"id": "file", "label": "Путь к файлу", "default": "C:\\file.txt"}
              ],
              "template": "Set-ItemProperty -Path \"{file}\" -Name Attributes -Value ([System.IO.FileAttributes]::Hidden)"
            },
            {
              "name": "Размер папки",
              "cmd": "$path = \"C:\\MyFolder\"; $size = (Get-ChildItem -Path $path -Recurse -File -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum; $result = switch($size){ {$_ -gt 1GB}{'{0:N2} GB' -f ($size/1GB)} {$_ -gt 1MB}{'{0:N2} MB' -f ($size/1MB)} {$_ -gt 1KB}{'{0:N2} KB' -f ($size/1KB)} default{\"$size bytes\"} }; Write-Host \"Размер '$path': $result\" -ForegroundColor Green",
              "admin": false,
              "desc": "Автоматически выбирает единицы измерения (GB/MB/KB/bytes)",
              "vars": [
                {"id": "path", "label": "Путь к папке для измерения размера", "default": "C:\\MyFolder", "normalize": "path"}
              ],
              "template": "$path = \"{path}\"; $size = (Get-ChildItem -Path $path -Recurse -File -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum; $result = switch($size){ {$_ -gt 1GB}{'{0:N2} GB' -f ($size/1GB)} {$_ -gt 1MB}{'{0:N2} MB' -f ($size/1MB)} {$_ -gt 1KB}{'{0:N2} KB' -f ($size/1KB)} default{\"$size bytes\"} }; Write-Host \"Размер '$path': $result\" -ForegroundColor Green"
            }
          ]
        },
        {
          "title": "Права доступа (NTFS)",
          "commands": [
            {
              "name": "Показать права на файл",
              "cmd": "Get-Acl \"C:\\file.txt\" | Format-List",
              "admin": false,
              "desc": "Показывает список прав доступа для файла или папки",
              "vars": [
                {"id": "path", "label": "Путь к файлу или папке", "default": "C:\\file.txt"}
              ],
              "template": "Get-Acl \"{path}\" | Format-List"
            },
            {
              "name": "Добавить право на чтение",
              "cmd": "$acl = Get-Acl \"C:\\Folder\"; $rule = New-Object System.Security.AccessControl.FileSystemAccessRule(\"UserName\",\"Read\",\"ContainerInherit,ObjectInherit\",\"None\",\"Allow\"); $acl.SetAccessRule($rule); Set-Acl \"C:\\Folder\" $acl",
              "admin": true,
              "desc": "Предоставляет пользователю право на чтение папки",
              "vars": [
                {"id": "path", "label": "Путь к папке", "default": "C:\\Folder", "normalize": "path"},
                {"id": "user", "label": "Имя пользователя", "default": "UserName"}
              ],
              "template": "$acl = Get-Acl \"{path}\"; $rule = New-Object System.Security.AccessControl.FileSystemAccessRule(\"{user}\",\"Read\",\"ContainerInherit,ObjectInherit\",\"None\",\"Allow\"); $acl.SetAccessRule($rule); Set-Acl \"{path}\" $acl"
            },
            {
              "name": "Удалить все права (кроме SYSTEM)",
              "cmd": "$acl = Get-Acl \"C:\\Folder\"; $acl.Access | Where-Object {$_.IdentityReference -notlike \"*SYSTEM*\"} | ForEach-Object {$acl.RemoveAccessRule($_)}; Set-Acl \"C:\\Folder\" $acl",
              "admin": true,
              "desc": "Удаляет все права доступа, кроме SYSTEM",
              "vars": [
                {"id": "path", "label": "Путь к папке", "default": "C:\\Folder", "normalize": "path"}
              ],
              "template": "$acl = Get-Acl \"{path}\"; $acl.Access | Where-Object {$_.IdentityReference -notlike \"*SYSTEM*\"} | ForEach-Object {$acl.RemoveAccessRule($_)}; Set-Acl \"{path}\" $acl"
            },
            {
              "name": "Взять владение",
              "cmd": "takeown /F \"C:\\Folder\" /R /D Y",
              "admin": true,
              "desc": "Стать владельцем папки/файла (если нет доступа)",
              "vars": [
                {"id": "path", "label": "Путь к папке или файлу", "default": "C:\\Folder", "normalize": "path"}
              ],
              "template": "takeown /F \"{path}\" /R /D Y"
            }
          ]
        },
        {
          "title": "Альтернативные потоки",
          "commands": [
            {
              "name": "Показать все потоки файла",
              "cmd": "Get-Item \"C:\\file.txt\" -Stream * | Select-Object Stream, Length",
              "admin": false,
              "desc": "Показывает все альтернативные потоки файла",
              "vars": [
                {"id": "file", "label": "Путь к файлу", "default": "C:\\file.txt"}
              ],
              "template": "Get-Item \"{file}\" -Stream * | Select-Object Stream, Length"
            },
            {
              "name": "Удалить Zone.Identifier",
              "cmd": "Unblock-File -Path \"C:\\file.txt\"",
              "admin": false,
              "desc": "Разблокирует скачанный файл",
              "vars": [
                {"id": "file", "label": "Путь к файлу", "default": "C:\\file.txt"}
              ],
              "template": "Unblock-File -Path \"{file}\""
            },
            {
              "name": "Скрыть данные в потоке",
              "cmd": "Set-Content -Path \"C:\\file.txt:secret\" -Value \"Мои секретные данные\"",
              "admin": false,
              "desc": "Создаёт скрытый поток с данными (не виден в проводнике)",
              "vars": [
                {"id": "file", "label": "Путь к файлу", "default": "C:\\file.txt"},
                {"id": "stream", "label": "Имя потока", "default": "secret"},
                {"id": "data", "label": "Данные для сохранения", "default": "Мои секретные данные"}
              ],
              "template": "Set-Content -Path \"{file}:{stream}\" -Value \"{data}\""
            }
          ]
        },
        {
          "title": "Сжатие и диски",
          "commands": [
            {
              "name": "Включить NTFS-сжатие для папки",
              "cmd": "compact /c /s:\"C:\\MyFolder\"",
              "admin": false,
              "desc": "Сжимает все файлы в папке средствами NTFS",
              "vars": [
                {"id": "path", "label": "Путь к папке", "default": "C:\\MyFolder", "normalize": "path"}
              ],
              "template": "compact /c /s:\"{path}\""
            },
            {
              "name": "Выключить сжатие",
              "cmd": "compact /u /s:\"C:\\MyFolder\"",
              "admin": false,
              "desc": "Отключает сжатие для всех файлов в папке",
              "vars": [
                {"id": "path", "label": "Путь к папке", "default": "C:\\MyFolder", "normalize": "path"}
              ],
              "template": "compact /u /s:\"{path}\""
            },
            {"name": "Проверить метку тома", "cmd": "Get-Volume | Select-Object DriveLetter, FileSystemLabel, FileSystem, DriveType | Format-Table -AutoSize", "admin": false, "desc": "Показывает метки томов и типы файловых систем"}
          ]
        }
      ]
    },
    {
      "id": "printers",
      "title": "Принтеры",
      "icon": "monitor",
      "cards": [
        {
          "title": "Управление принтерами",
          "commands": [
            {"name": "Список всех принтеров", "cmd": "Get-Printer | Select-Object Name, Type, DriverName, PortName | Format-Table -AutoSize", "admin": false, "desc": "Показывает все установленные принтеры и их драйверы"},
            {
              "name": "Установить принтер по умолчанию",
              "cmd": "Set-Printer -Name \"ИмяПринтера\" -Default",
              "admin": true,
              "desc": "Устанавливает указанный принтер как принтер по умолчанию",
              "vars": [
                {"id": "printer", "label": "Имя принтера", "hint": "Узнайте через: Get-Printer", "default": "ИмяПринтера"}
              ],
              "template": "Set-Printer -Name \"{printer}\" -Default"
            },
            {
              "name": "Удалить принтер",
              "cmd": "Remove-Printer -Name \"ИмяПринтера\"",
              "admin": true,
              "desc": "Удаляет принтер из системы",
              "vars": [
                {"id": "printer", "label": "Имя принтера", "default": "ИмяПринтера"}
              ],
              "template": "Remove-Printer -Name \"{printer}\""
            },
            {
              "name": "Очистить очередь печати",
              "cmd": "Get-PrintJob -PrinterName \"ИмяПринтера\" | Remove-PrintJob",
              "admin": true,
              "desc": "Удаляет все задания из очереди печати",
              "vars": [
                {"id": "printer", "label": "Имя принтера", "default": "ИмяПринтера"}
              ],
              "template": "Get-PrintJob -PrinterName \"{printer}\" | Remove-PrintJob"
            },
            {
              "name": "Скрыть принтер в сети",
              "cmd": "Set-Printer -Name \"ИмяПринтера\" -Published $false",
              "admin": true,
              "desc": "Скрывает принтер от других пользователей сети",
              "vars": [
                {"id": "printer", "label": "Имя принтера", "default": "ИмяПринтера"}
              ],
              "template": "Set-Printer -Name \"{printer}\" -Published $false"
            }
          ]
        },
        {
          "title": "Очередь печати",
          "commands": [
            {
              "name": "Показать очередь",
              "cmd": "Get-PrintJob -PrinterName \"ИмяПринтера\" | Select-Object JobId, DocumentName, Owner, SubmittedTime, Pages | Format-Table -AutoSize",
              "admin": false,
              "desc": "Показывает все задания в очереди печати",
              "vars": [
                {"id": "printer", "label": "Имя принтера", "default": "ИмяПринтера"}
              ],
              "template": "Get-PrintJob -PrinterName \"{printer}\" | Select-Object JobId, DocumentName, Owner, SubmittedTime, Pages | Format-Table -AutoSize"
            },
            {
              "name": "Удалить конкретное задание",
              "cmd": "Remove-PrintJob -PrinterName \"ИмяПринтера\" -JobId 123",
              "admin": true,
              "desc": "Удаляет задание по его ID",
              "vars": [
                {"id": "printer", "label": "Имя принтера", "default": "ИмяПринтера"},
                {"id": "jobid", "label": "ID задания", "default": "123", "type": "number"}
              ],
              "template": "Remove-PrintJob -PrinterName \"{printer}\" -JobId {jobid}"
            },
            {"name": "Перезапустить диспетчер печати", "cmd": "Restart-Service -Name Spooler -Force", "admin": true, "desc": "Перезапускает службу печати (часто помогает при зависании)"},
            {"name": "Остановить диспетчер печати", "cmd": "Stop-Service -Name Spooler", "admin": true, "desc": "Останавливает службу печати"},
            {"name": "Запустить диспетчер печати", "cmd": "Start-Service -Name Spooler", "admin": true, "desc": "Запускает службу печати"}
          ]
        },
        {
          "title": "Сетевые принтеры",
          "commands": [
            {
              "name": "Добавить сетевой принтер",
              "cmd": "Add-Printer -ConnectionName \"\\\\PrintServer\\PrinterName\"",
              "admin": true,
              "desc": "Подключает сетевой принтер по UNC-пути",
              "vars": [
                {"id": "server", "label": "Имя сервера печати", "default": "PrintServer"},
                {"id": "printer", "label": "Имя общего принтера", "default": "PrinterName"}
              ],
              "template": "Add-Printer -ConnectionName \"\\\\{server}\\{printer}\""
            },
            {"name": "Список сетевых принтеров", "cmd": "Get-Printer | Where-Object {$_.Type -eq 'Connection'} | Select-Object Name, ComputerName | Format-Table -AutoSize", "admin": false, "desc": "Показывает все подключённые сетевые принтеры"}
          ]
        }
      ]
    },
    {
      "id": "backup",
      "title": "Резервное копирование",
      "icon": "clipboard",
      "cards": [
        {
          "title": "Архивация",
          "commands": [
            {
              "name": "Заархивировать папку",
              "cmd": "Compress-Archive -Path \"C:\\MyFolder\" -DestinationPath \"$env:USERPROFILE\\Desktop\\Backup.zip\" -Force",
              "admin": false,
              "desc": "Создаёт ZIP-архив указанной папки на рабочем столе",
              "vars": [
                {"id": "path", "label": "Папка для архивации", "default": "C:\\MyFolder", "normalize": "path"}
              ],
              "template": "Compress-Archive -Path \"{path}\" -DestinationPath \"$env:USERPROFILE\\Desktop\\Backup.zip\" -Force"
            },
            {
              "name": "Распаковать архив",
              "cmd": "Expand-Archive -Path \"$env:USERPROFILE\\Desktop\\Backup.zip\" -DestinationPath \"C:\\Extracted\" -Force",
              "admin": false,
              "desc": "Распаковывает архив в указанную папку",
              "vars": [
                {"id": "zip", "label": "Путь к ZIP-архиву", "default": "$env:USERPROFILE\\Desktop\\Backup.zip"},
                {"id": "dest", "label": "Папка для распаковки", "default": "C:\\Extracted", "normalize": "path"}
              ],
              "template": "Expand-Archive -Path \"{zip}\" -DestinationPath \"{dest}\" -Force"
            }
          ]
        },
        {
          "title": "Экспорт настроек",
          "commands": [
            {"name": "Экспорт Wi-Fi профилей", "cmd": "$folder = \"$env:USERPROFILE\\Desktop\\WiFi_Backup\"; New-Item -ItemType Directory -Path $folder -Force | Out-Null; netsh wlan export profile folder=$folder; Write-Host \"Сохранено в: $folder\" -ForegroundColor Green", "admin": false, "desc": "Экспортирует все сохранённые Wi-Fi сети в XML-файлы"},
            {
              "name": "Экспорт реестра (ветка)",
              "cmd": "reg export \"HKCU\\Software\\Microsoft\\Windows\" \"$env:USERPROFILE\\Desktop\\windows_settings.reg\" /y",
              "admin": false,
              "desc": "Экспортирует указанную ветку реестра в файл",
              "vars": [
                {"id": "key", "label": "Ветка реестра", "hint": "Например: HKCU\\Software\\Microsoft\\Windows", "default": "HKCU\\Software\\Microsoft\\Windows"},
                {"id": "file", "label": "Имя файла (без пути)", "default": "windows_settings.reg"}
              ],
              "template": "reg export \"{key}\" \"$env:USERPROFILE\\Desktop\\{file}\" /y"
            },
            {"name": "Экспорт списка программ", "cmd": "winget list | Out-File \"$env:USERPROFILE\\Desktop\\installed_apps.txt\"; Write-Host \"Сохранено\" -ForegroundColor Green", "admin": false, "desc": "Сохраняет список установленных программ в текстовый файл"},
            {"name": "Экспорт списка служб", "cmd": "Get-Service | Select-Object Name, DisplayName, Status, StartType | Export-Csv \"$env:USERPROFILE\\Desktop\\services.csv\" -NoTypeInformation; Write-Host \"Сохранено\" -ForegroundColor Green", "admin": false, "desc": "Сохраняет список всех служб в CSV-файл"}
          ]
        },
        {
          "title": "Импорт настроек",
          "commands": [
            {
              "name": "Импорт реестра",
              "cmd": "reg import \"$env:USERPROFILE\\Desktop\\windows_settings.reg\"",
              "admin": true,
              "desc": "Импортирует настройки из REG-файла",
              "vars": [
                {"id": "file", "label": "Путь к REG-файлу", "default": "$env:USERPROFILE\\Desktop\\windows_settings.reg"}
              ],
              "template": "reg import \"{file}\""
            },
            {
              "name": "Импорт Wi-Fi профиля",
              "cmd": "netsh wlan add profile filename=\"C:\\WiFi\\my_network.xml\" user=current",
              "admin": false,
              "desc": "Добавляет Wi-Fi профиль из XML-файла",
              "vars": [
                {"id": "file", "label": "Путь к XML-файлу Wi-Fi профиля", "default": "C:\\WiFi\\my_network.xml"}
              ],
              "template": "netsh wlan add profile filename=\"{file}\" user=current"
            }
          ]
        },
        {
          "title": "Теневые копии (VSS)",
          "commands": [
            {
              "name": "Список теневых копий",
              "cmd": "vssadmin list shadows /for=C:",
              "admin": true,
              "desc": "Показывает все теневые копии для диска",
              "vars": [
                {"id": "drive", "label": "Буква диска", "default": "C", "normalize": "drive"}
              ],
              "template": "vssadmin list shadows /for={drive}:"
            },
            {
              "name": "Удалить старые тени",
              "cmd": "vssadmin delete shadows /for=C: /oldest /quiet",
              "admin": true,
              "desc": "Удаляет самую старую теневую копию",
              "vars": [
                {"id": "drive", "label": "Буква диска", "default": "C", "normalize": "drive"}
              ],
              "template": "vssadmin delete shadows /for={drive}: /oldest /quiet"
            },
            {
              "name": "Создать теневую копию",
              "cmd": "vssadmin create shadow /for=C:",
              "admin": true,
              "desc": "Создаёт новую теневую копию для диска",
              "vars": [
                {"id": "drive", "label": "Буква диска", "default": "C", "normalize": "drive"}
              ],
              "template": "vssadmin create shadow /for={drive}:"
            }
          ]
        }
      ]
    }
  ],
  "utilities": [
    {
      "id": "folder-access",
      "title": "Восстановление доступа к папке",
      "icon": "lock",
      "description": "Если после переустановки Windows нет доступа к файлам (\"Отказано в доступе\")",
      "fields": [
        {"id": "path", "label": "Путь к папке", "placeholder": "D:\\Мои документы", "type": "text"}
      ],
      "actions": [
        {"label": "Основной скрипт", "template": "Write-Host '1. Смена владельца на группу Администраторы...' -ForegroundColor Yellow\ntakeown /F \"{path}\" /R /A\nWrite-Host '2. Предоставление полного доступа всем пользователям...' -ForegroundColor Yellow\nicacls \"{path}\" /grant *S-1-5-32-545:F /T /Q\nWrite-Host 'Готово! Права для папки успешно применены.' -ForegroundColor Green"},
        {"label": "Снять 'Только чтение'", "template": "attrib -r \"{path}\" /S /D"},
        {"label": "Полный сброс прав", "template": "Write-Host '1. Принудительная смена владельца...' -ForegroundColor Yellow\ntakeown /F \"{path}\" /R /A\nWrite-Host '2. Полный сброс прав доступа и включение наследования...' -ForegroundColor Yellow\nicacls \"{path}\" /reset /T /C /Q\nWrite-Host 'Готово! Права полностью сброшены.' -ForegroundColor Green"}
      ]
    },
    {
      "id": "firewall-rule",
      "title": "Правило для Брандмауэра",
      "icon": "shield-plus",
      "description": "Создание разрешающего правила для открытия порта в брандмауэре Windows",
      "fields": [
        {"id": "ruleName", "label": "Название правила", "placeholder": "MyGameServer", "type": "text"},
        {"id": "port", "label": "Номер порта", "placeholder": "25565", "type": "number"},
        {"id": "protocol", "label": "Протокол", "type": "radio", "options": ["TCP", "UDP"], "default": "TCP"},
        {"id": "direction", "label": "Направление", "type": "radio", "options": ["Inbound", "Outbound", "Both"], "default": "Inbound"}
      ],
      "actions": [
        {"label": "Создать правило", "handler": "firewall"},
        {"label": "Проверить порт", "handler": "portcheck"}
      ]
    },
    {
      "id": "folder-size",
      "title": "Анализ размера папок",
      "icon": "pie-chart",
      "description": "Показывает размеры всех подпапок, сортируя от самой большой к самой маленькой",
      "fields": [
        {"id": "path", "label": "Путь к папке для анализа", "placeholder": "C:\\Program Files", "type": "text"}
      ],
      "actions": [
        {"label": "Сформировать команду", "template": "$targetPath = \"{path}\"\nWrite-Host \"Анализирую папку: $targetPath ...\" -ForegroundColor Yellow\nGet-ChildItem -Path $targetPath -Directory -ErrorAction SilentlyContinue |\n  Select-Object Name, @{Name='SizeBytes'; Expression={\n    (Get-ChildItem -Path $_.FullName -Recurse -File -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum -ErrorAction SilentlyContinue).Sum\n  }} |\n  Sort-Object -Property SizeBytes -Descending |\n  Select-Object Name, @{Name='Размер (ГБ)'; Expression={'{0:N2}' -f ($_.SizeBytes / 1GB)}}, @{Name='Размер (МБ)'; Expression={'{0:N2}' -f ($_.SizeBytes / 1MB)}} |\n  Format-Table -AutoSize"}
      ]
    },
    {
      "id": "file-search",
      "title": "Поиск файлов и текста",
      "icon": "search",
      "description": "Поиск файлов по имени, расширению или тексту внутри них",
      "fields": [
        {"id": "path", "label": "Папка для поиска", "placeholder": "C:\\Users\\Admin\\Documents", "type": "text"},
        {"id": "pattern", "label": "Маска имени файла (* = любой символ)", "placeholder": "*.txt или report_*.docx", "type": "text"},
        {"id": "text", "label": "Текст внутри файлов (необязательно)", "placeholder": "critical error", "type": "text"},
        {"id": "recursive", "label": "Искать в подпапках", "type": "checkbox", "default": true}
      ],
      "actions": [
        {"label": "Сформировать команду", "handler": "filesearch"}
      ]
    },
    {
      "id": "lan-scanner",
      "title": "Сканер ЛВС с отчетом",
      "icon": "radar",
      "description": "Сканирует сеть и создает интерактивный HTML-отчет. Требуется PowerShell 7.2+",
      "fields": [
        {"id": "baseIP", "label": "Базовый IP-адрес (с точкой в конце)", "placeholder": "192.168.1.", "type": "text"},
        {"id": "start", "label": "Начало диапазона", "placeholder": "1", "type": "number"},
        {"id": "end", "label": "Конец диапазона", "placeholder": "254", "type": "number"}
      ],
      "actions": [
        {"label": "Сформировать команду", "handler": "lanscan"}
      ]
    },
    {
      "id": "pagefile-optimize",
      "title": "Оптимизация файла подкачки и системы",
      "icon": "zap",
      "description": "Автоматически определяет ОЗУ, тип диска (SSD/HDD) и настраивает оптимальный размер pagefile.",
      "fields": [
        {"id": "drive", "label": "Буква диска для размещения файла подкачки", "placeholder": "C (только одна буква)", "type": "text"}
      ],
      "actions": [
        {"label": "Сформировать скрипт оптимизации", "handler": "optimize"}
      ]
    },
    {
      "id": "service-report",
      "title": "Детальный отчет о службах (HTML)",
      "icon": "clipboard",
      "description": "Создает интерактивный HTML-отчет о всех службах Windows с потреблением ресурсов",
      "fields": [
        {"id": "filter", "label": "Фильтр по имени (необязательно)", "placeholder": "sql, print, py", "type": "text"}
      ],
      "actions": [
        {"label": "Сформировать скрипт", "handler": "servicereport"}
      ]
    }
  ],
  "ai": {
    "proxyUrl": "https://mapruapp.ru",
    "model": "gemini-2.5-flash-lite",
    "systemPrompt": "Ты — «PowerShell-Эксперт», встроенный в веб-инструмент «Помощник по настройке ПК». Твоя задача — помогать пользователям, генерируя команды для PowerShell.\n\nВсегда следуй этому формату ответа:\n1. Оберни готовые к выполнению команды PowerShell в теги [COMMAND]...[/COMMAND]. Каждая команда должна быть в своем блоке.\n2. Краткое пояснение ПОСЛЕ всех блоков с командами.\n\nЕсли не можешь сгенерировать команду, честно скажи. Не выдумывай команды. Отвечай на русском."
  }
}