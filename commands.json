{
  "sections": [
    {
      "id": "powershell",
      "title": "PowerShell",
      "icon": "terminal",
      "cards": [
        {
          "title": "Установка и обновление",
          "commands": [
            {"name": "Проверить версию", "cmd": "$PSVersionTable", "admin": false, "desc": "Показывает текущую версию PowerShell"},
            {"name": "Установить стабильную (winget)", "cmd": "winget install --id Microsoft.PowerShell --source winget", "admin": true, "desc": "Установка последней стабильной версии через winget"},
            {"name": "Установить preview (winget)", "cmd": "winget install --id Microsoft.PowerShell.Preview --source winget", "admin": true, "desc": "Установка предварительной версии для тестирования новых функций"},
            {
              "name": "Автоустановка PS7 с GitHub",
              "cmd": "[Net.ServicePointManager]::SecurityProtocol=[Net.SecurityProtocolType]::Tls12\n$ProgressPreference='SilentlyContinue'\ntry{\n  $a=(Invoke-RestMethod 'https://api.github.com/repos/PowerShell/PowerShell/releases/latest').assets|Where-Object{$_.name-like'PowerShell-*-win-x64.msi'}|Select-Object -First 1\n  $m=Join-Path $env:TEMP $a.name\n  Write-Host \"Скачиваю $($a.name)...\" -ForegroundColor Yellow\n  Invoke-WebRequest $a.browser_download_url -OutFile $m\n  Write-Host 'Установка...' -ForegroundColor Yellow\n  Start-Process msiexec.exe -ArgumentList \"/i `\"$m`\" /quiet\" -Wait\n  Remove-Item $m -ErrorAction SilentlyContinue\n  Write-Host 'Готово! Проверьте: pwsh --version' -ForegroundColor Green\n}catch{\n  Write-Host \"Ошибка: $($_.Exception.Message)\" -ForegroundColor Red\n}",
              "admin": true,
              "desc": "Скачивает и устанавливает последний PowerShell 7 с GitHub. Требует PS 5.1+"
            }
          ]
        },
        {
          "title": "Профиль и модули",
          "commands": [
            {"name": "Путь к профилю", "cmd": "$PROFILE", "admin": false, "desc": "Показывает путь к файлу профиля PowerShell"},
            {"name": "Создать профиль", "cmd": "if(!(Test-Path $PROFILE)){New-Item -Path $PROFILE -ItemType File -Force}", "admin": false, "desc": "Создает файл профиля, если его нет"},
            {"name": "Список установленных модулей", "cmd": "Get-Module -ListAvailable | Select-Object Name, Version, ModuleBase", "admin": false, "desc": "Все доступные модули PowerShell"},
            {"name": "Установить модуль PSReadLine", "cmd": "Install-Module -Name PSReadLine -Force -SkipPublisherCheck", "admin": true, "desc": "Улучшенная строка ввода для PowerShell"},
            {"name": "Обновить все модули", "cmd": "Get-InstalledModule | Update-Module", "admin": true, "desc": "Обновляет все установленные через PowerShellGet модули"}
          ]
        }
      ]
    },
    {
      "id": "dns",
      "title": "DNS",
      "icon": "globe",
      "cards": [
        {
          "title": "Управление DNS",
          "commands": [
            {"name": "Текущие DNS-серверы", "cmd": "Get-DnsClientServerAddress | Select-Object InterfaceAlias, ServerAddresses", "admin": false, "desc": "Показывает DNS для каждого сетевого подключения"},
            {"name": "Сброс кэша DNS", "cmd": "Clear-DnsClientCache", "admin": true, "desc": "Очищает локальный кэш DNS-записей"},
            {"name": "Сброс DNS на автоматические", "cmd": "Set-DnsClientServerAddress -InterfaceAlias \"Ethernet\" -ResetServerAddresses", "admin": true, "desc": "Возвращает DNS на получение по DHCP", "note": "Замените Ethernet на имя подключения"}
          ]
        },
        {
          "title": "Xbox DNS",
          "description": "DNS для работы ИИ-моделей",
          "commands": [
            {"name": "Установить Xbox DNS", "cmd": "Set-DnsClientServerAddress -InterfaceAlias \"Ethernet\" -ServerAddresses (\"176.99.11.77\",\"80.78.247.254\")", "admin": true, "desc": "Устанавливает Xbox DNS серверы"}
          ],
          "badges": [{"value": "176.99.11.77", "color": "blue"}, {"value": "80.78.247.254", "color": "blue"}]
        },
        {
          "title": "Google DNS",
          "commands": [
            {"name": "Установить Google DNS", "cmd": "Set-DnsClientServerAddress -InterfaceAlias \"Ethernet\" -ServerAddresses (\"8.8.8.8\",\"8.8.4.4\")", "admin": true, "desc": "Быстрые и надежные DNS от Google"}
          ],
          "badges": [{"value": "8.8.8.8", "color": "green"}, {"value": "8.8.4.4", "color": "green"}]
        },
        {
          "title": "Yandex DNS",
          "commands": [
            {"name": "Установить Yandex DNS", "cmd": "Set-DnsClientServerAddress -InterfaceAlias \"Ethernet\" -ServerAddresses (\"77.88.8.1\",\"77.88.8.8\")", "admin": true, "desc": "DNS от Яндекса, хорошая скорость в России"}
          ],
          "badges": [{"value": "77.88.8.1", "color": "green"}, {"value": "77.88.8.8", "color": "green"}]
        },
        {
          "title": "Cloudflare DNS",
          "commands": [
            {"name": "Установить Cloudflare DNS", "cmd": "Set-DnsClientServerAddress -InterfaceAlias \"Ethernet\" -ServerAddresses (\"1.1.1.1\",\"1.0.0.1\")", "admin": true, "desc": "Самые быстрые публичные DNS от Cloudflare"}
          ],
          "badges": [{"value": "1.1.1.1", "color": "purple"}, {"value": "1.0.0.1", "color": "purple"}]
        },
        {
          "title": "Безопасный DNS (DoH) для браузера",
          "description": "Шифрует DNS-запросы. Вставьте адрес в настройках безопасного DNS вашего браузера (Chrome, Edge, Яндекс).",
          "commands": [],
          "badges": [
            {"value": "https://xbox-dns.ru/dns-query", "color": "orange"},
            {"value": "https://dns.google/dns-query", "color": "green"},
            {"value": "https://cloudflare-dns.com/dns-query", "color": "purple"}
          ]
        }
      ]
    },
    {
      "id": "network",
      "title": "Сеть",
      "icon": "wifi",
      "cards": [
        {
          "title": "Сетевые команды",
          "commands": [
            {"name": "Включить общий доступ к файлам", "cmd": "netsh advfirewall firewall set rule group=\"Общий доступ к файлам и принтерам\" new enable=Yes", "admin": true, "desc": "Разрешает общий доступ к файлам и принтерам в локальной сети"},
            {"name": "Сброс Winsock", "cmd": "netsh winsock reset", "admin": true, "desc": "Полный сброс сетевого стека Windows"},
            {"name": "Сброс TCP/IP", "cmd": "netsh int ip reset", "admin": true, "desc": "Сбрасывает настройки TCP/IP протокола"},
            {"name": "Освободить IP-адрес", "cmd": "ipconfig /release", "admin": true, "desc": "Освобождает текущий IP-адрес от DHCP"},
            {"name": "Обновить IP-адрес", "cmd": "ipconfig /renew", "admin": true, "desc": "Запрашивает новый IP у DHCP-сервера"},
            {"name": "Сетевые адаптеры", "cmd": "Get-NetAdapter", "admin": false, "desc": "Список всех сетевых подключений и их статус"},
            {"name": "Тест подключения", "cmd": "Test-NetConnection google.com -Port 80", "admin": false, "desc": "Проверяет соединение с сервером на указанном порту"},
            {"name": "Таблица маршрутизации", "cmd": "route print", "admin": false, "desc": "Отображает таблицу маршрутов сети"},
            {"name": "Внешний IP-адрес", "cmd": "(Invoke-RestMethod 'https://api.ipify.org?format=json').ip", "admin": false, "desc": "Показывает ваш публичный IP-адрес"},
            {"name": "ARP-таблица", "cmd": "Get-NetNeighbor | Where-Object State -ne 'Unreachable' | Format-Table -AutoSize", "admin": false, "desc": "Таблица соответствия IP и MAC-адресов в сети"},
            {"name": "Открытые порты", "cmd": "Get-NetTCPConnection -State Listen | Select-Object LocalPort, OwningProcess, @{N='Process';E={(Get-Process -Id $_.OwningProcess).ProcessName}} | Sort-Object LocalPort | Format-Table", "admin": false, "desc": "Список всех прослушиваемых портов и процессов"},
            {"name": "Скорость адаптера", "cmd": "Get-NetAdapter | Where-Object Status -eq 'Up' | Select-Object Name, LinkSpeed, MediaType", "admin": false, "desc": "Скорость подключения активных сетевых адаптеров"}
          ]
        }
      ]
    },
    {
      "id": "system",
      "title": "Система",
      "icon": "settings",
      "cards": [
        {
          "title": "Обслуживание системы",
          "commands": [
            {"name": "Очистка временных файлов", "cmd": "Get-ChildItem -Path $env:TEMP -Recurse | Remove-Item -Force -Recurse -ErrorAction SilentlyContinue", "admin": false, "desc": "Удаляет временные файлы текущего пользователя"},
            {"name": "Проверка системных файлов (SFC)", "cmd": "sfc /scannow", "admin": true, "desc": "Сканирует и восстанавливает поврежденные системные файлы"},
            {"name": "Проверка диска C:", "cmd": "chkdsk C: /f", "admin": true, "desc": "Проверяет диск на ошибки и исправляет их"},
            {"name": "Дефрагментация диска C:", "cmd": "Optimize-Volume -DriveLetter C -Defrag", "admin": true, "desc": "Оптимизирует размещение файлов на диске"},
            {"name": "Очистка корзины", "cmd": "Clear-RecycleBin -Force", "admin": false, "desc": "Полностью очищает корзину для всех дисков"},
            {"name": "Информация о дисках", "cmd": "Get-Disk", "admin": true, "desc": "Показывает информацию о всех физических дисках"},
            {"name": "Перезагрузка (60 секунд)", "cmd": "shutdown /r /t 60", "admin": true, "desc": "Перезагружает компьютер через 60 секунд"},
            {"name": "Синхронизация системного времени", "cmd": "Set-Service -Name W32Time -StartupType Automatic; Start-Service -Name W32Time -ErrorAction SilentlyContinue; w32tm /config /manualpeerlist:'pool.ntp.org,0x8' /syncfromflags:manual /update; Start-Sleep -Seconds 5; w32tm /resync /force; w32tm /query /status; Get-Date", "admin": true, "desc": "Полный сброс службы времени и принудительная синхронизация"}
          ]
        },
        {
          "title": "Установленное ПО",
          "commands": [
            {"name": "Все программы (winget)", "cmd": "winget list", "admin": false, "desc": "Список всех установленных программ через winget"},
            {"name": "Обновить всё (winget)", "cmd": "winget upgrade --all", "admin": true, "desc": "Обновляет все программы, для которых есть обновления"},
            {"name": "Программы из реестра", "cmd": "Get-ItemProperty HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select-Object DisplayName, DisplayVersion, Publisher | Sort-Object DisplayName | Format-Table -AutoSize", "admin": false, "desc": "Полный список программ из реестра Windows"},
            {"name": "Пакеты из Microsoft Store", "cmd": "Get-AppxPackage | Select-Object Name, Version | Sort-Object Name", "admin": false, "desc": "Все приложения, установленные из Microsoft Store"}
          ]
        },
        {
          "title": "Питание и загрузка",
          "commands": [
            {"name": "Отчет по батарее", "cmd": "powercfg /batteryreport /output \"$env:USERPROFILE\\Desktop\\battery.html\"; Invoke-Item \"$env:USERPROFILE\\Desktop\\battery.html\"", "admin": true, "desc": "Создает подробный HTML-отчет о состоянии батареи"},
            {"name": "Текущая схема питания", "cmd": "powercfg /getactivescheme", "admin": false, "desc": "Показывает активную схему электропитания"},
            {"name": "Программы в автозагрузке", "cmd": "Get-CimInstance Win32_StartupCommand | Select-Object Name, Command, Location | Format-Table -AutoSize", "admin": false, "desc": "Список программ, запускающихся вместе с Windows"},
            {"name": "Время последней загрузки", "cmd": "(Get-CimInstance Win32_OperatingSystem).LastBootUpTime", "admin": false, "desc": "Когда компьютер был загружен в последний раз"}
          ]
        }
      ]
    },
    {
      "id": "services",
      "title": "Службы",
      "icon": "layers",
      "cards": [
        {
          "title": "Управление службами",
          "commands": [
            {"name": "Перезапуск Windows Update", "cmd": "Restart-Service -Name wuauserv", "admin": true, "desc": "Перезапускает службу обновлений Windows"},
            {"name": "Остановить Windows Update", "cmd": "Stop-Service -Name wuauserv", "admin": true, "desc": "Останавливает службу обновлений"},
            {"name": "Запустить Windows Update", "cmd": "Start-Service -Name wuauserv", "admin": true, "desc": "Запускает службу обновлений"},
            {"name": "Перезапуск службы печати", "cmd": "Restart-Service -Name Spooler -Force", "admin": true, "desc": "Перезапускает диспетчер печати"},
            {"name": "Перезапуск аудио", "cmd": "Restart-Service -Name AudioSrv", "admin": true, "desc": "Перезапускает службу Windows Audio"},
            {"name": "Все службы (сортировка)", "cmd": "Get-Service | Sort-Object Status, Name", "admin": false, "desc": "Показывает все службы и их статус"},
            {"name": "Службы в автозапуске", "cmd": "Get-Service | Where-Object {$_.StartType -eq 'Automatic'}", "admin": false, "desc": "Службы с автоматическим запуском"},
            {"name": "Перезапуск DHCP", "cmd": "Restart-Service -Name Dhcp", "admin": true, "desc": "Перезапускает DHCP-клиент"},
            {"name": "Остановленные службы", "cmd": "Get-Service | Where-Object Status -eq 'Stopped' | Select-Object Name, DisplayName | Sort-Object DisplayName", "admin": false, "desc": "Все службы, которые сейчас остановлены"},
            {"name": "Зависимости службы", "cmd": "Get-Service wuauserv | Select-Object -ExpandProperty DependentServices", "admin": false, "desc": "Показывает, какие службы зависят от указанной"}
          ]
        }
      ]
    },
    {
      "id": "registry",
      "title": "Реестр",
      "icon": "file-text",
      "cards": [
        {
          "title": "Настройки реестра и системы",
          "warning": "Создайте точку восстановления перед изменением реестра!",
          "commands": [
            {"name": "Создать точку восстановления", "cmd": "Checkpoint-Computer -Description \"Manual Restore Point\"", "admin": true, "desc": "Создает точку восстановления системы"},
            {"name": "Отключить телеметрию", "cmd": "Set-ItemProperty -Path \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection\" -Name \"AllowTelemetry\" -Value 0", "admin": true, "desc": "Минимизирует сбор данных Windows"},
            {"name": "Показать скрытые файлы", "cmd": "Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\" -Name \"Hidden\" -Value 1", "admin": false, "desc": "Включает отображение скрытых файлов в проводнике"},
            {"name": "Показать расширения файлов", "cmd": "Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\" -Name \"HideFileExt\" -Value 0", "admin": false, "desc": "Отображает расширения для всех типов файлов"},
            {"name": "Программы в автозапуске", "cmd": "Get-CimInstance -ClassName Win32_StartupCommand | Select-Object Name, Command, Location", "admin": false, "desc": "Показывает программы в автозапуске"},
            {"name": "Открыть редактор реестра", "cmd": "regedit", "admin": true, "desc": "Запускает regedit для ручного редактирования"},
            {"name": "Отключить уведомления", "cmd": "Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\PushNotifications\" -Name \"ToastEnabled\" -Value 0", "admin": false, "desc": "Отключает всплывающие уведомления Windows"},
            {"name": "Ускорить меню Пуск", "cmd": "Set-ItemProperty -Path \"HKCU:\\Control Panel\\Desktop\" -Name \"MenuShowDelay\" -Value 0", "admin": false, "desc": "Убирает задержку при открытии меню Пуск"},
            {"name": "Отключить Cortana", "cmd": "Set-ItemProperty -Path \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search\" -Name \"AllowCortana\" -Value 0", "admin": true, "desc": "Полностью отключает голосовой помощник Cortana"},
            {"name": "Классическое контекстное меню (Win11)", "cmd": "reg add \"HKCU\\Software\\Classes\\CLSID\\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\\InprocServer32\" /f /ve", "admin": false, "desc": "Возвращает полное контекстное меню правой кнопки мыши", "note": "Перезапустите Explorer"}
          ]
        }
      ]
    },
    {
      "id": "diagnostics",
      "title": "Диагностика",
      "icon": "activity",
      "cards": [
        {
          "title": "Информация о системе",
          "commands": [
            {"name": "Информация о процессоре", "cmd": "Get-CimInstance -ClassName Win32_Processor | Select-Object Name, NumberOfCores, MaxClockSpeed", "admin": false, "desc": "Подробная информация о CPU"},
            {"name": "Информация о памяти (RAM)", "cmd": "Get-CimInstance -ClassName Win32_OperatingSystem | Select-Object @{Name=\"Total RAM (GB)\";Expression={[math]::Round($_.TotalVisibleMemorySize/1MB,2)}}, @{Name=\"Free RAM (GB)\";Expression={[math]::Round($_.FreePhysicalMemory/1MB,2)}}", "admin": false, "desc": "Показывает общий объем и свободную оперативную память"},
            {"name": "Использование дисков", "cmd": "Get-Volume | Where-Object {$_.DriveType -eq \"Fixed\"} | Select-Object DriveLetter, @{Name=\"Size(GB)\";Expression={[math]::Round($_.Size/1GB,2)}}, @{Name=\"Free(GB)\";Expression={[math]::Round($_.SizeRemaining/1GB,2)}}", "admin": false, "desc": "Показывает свободное место на всех дисках"},
            {"name": "Топ-10 процессов по CPU", "cmd": "Get-Process | Sort-Object CPU -Descending | Select-Object -First 10 ProcessName, CPU, WorkingSet", "admin": false, "desc": "Процессы, больше всего загружающие процессор"},
            {"name": "Топ-10 процессов по RAM", "cmd": "Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10 ProcessName, @{Name='RAM(MB)';Expression={[math]::Round($_.WorkingSet/1MB,2)}}", "admin": false, "desc": "Процессы, потребляющие больше всего памяти"},
            {"name": "Время работы системы (Uptime)", "cmd": "Get-CimInstance -ClassName Win32_OperatingSystem | Select-Object @{Name=\"Uptime\";Expression={(Get-Date) - $_.LastBootUpTime}}", "admin": false, "desc": "Как долго работает компьютер без перезагрузки"},
            {"name": "Полная информация о ПК", "cmd": "Get-ComputerInfo", "admin": false, "desc": "Собирает всю основную информацию о системе"},
            {"name": "Диагностика RAM", "cmd": "mdsched", "admin": true, "desc": "Планирует проверку оперативной памяти при перезагрузке"},
            {"name": "Видеокарта (GPU)", "cmd": "Get-CimInstance -ClassName Win32_VideoController | Select-Object Name, DriverVersion, @{Name='VRAM(GB)';Expression={[math]::Round($_.AdapterRAM/1GB,2)}}", "admin": false, "desc": "Модель, версия драйвера и объем видеопамяти"},
            {"name": "Информация о BIOS", "cmd": "Get-CimInstance -ClassName Win32_BIOS | Select-Object Manufacturer, SMBIOSBIOSVersion, ReleaseDate", "admin": false, "desc": "Производитель и версия BIOS"},
            {"name": "Температура (если поддерживается)", "cmd": "Get-CimInstance MSAcpi_ThermalZoneTemperature -Namespace root/wmi -ErrorAction SilentlyContinue | Select-Object @{N='Zone';E={$_.InstanceName}}, @{N='Temp(C)';E={($_.CurrentTemperature-2732)/10}}", "admin": true, "desc": "Температура через WMI, работает не на всех системах"},
            {"name": "Последние 20 ошибок в журнале", "cmd": "Get-WinEvent -LogName System -MaxEvents 20 | Where-Object Level -le 2 | Select-Object TimeCreated, LevelDisplayName, Message | Format-Table -Wrap", "admin": true, "desc": "События с уровнем ошибки или критической ошибки"}
          ]
        }
      ]
    },
    {
      "id": "security",
      "title": "Безопасность",
      "icon": "shield",
      "cards": [
        {
          "title": "Антивирус и защита",
          "commands": [
            {"name": "Быстрое сканирование Defender", "cmd": "Start-MpScan -ScanType QuickScan", "admin": true, "desc": "Запускает быстрое сканирование Windows Defender"},
            {"name": "Полное сканирование Defender", "cmd": "Start-MpScan -ScanType FullScan", "admin": true, "desc": "Запускает полное сканирование всей системы"},
            {"name": "Обновить базы вирусов", "cmd": "Update-MpSignature", "admin": true, "desc": "Обновляет антивирусные определения Windows Defender"},
            {"name": "Статус Windows Defender", "cmd": "Get-MpPreference | Select-Object RealTimeProtectionEnabled, DisableBehaviorMonitoring, DisableIOAVProtection", "admin": false, "desc": "Показывает состояние защиты системы"},
            {"name": "DISM: проверка целостности", "cmd": "DISM /Online /Cleanup-Image /CheckHealth", "admin": true, "desc": "Проверяет целостность образа Windows"},
            {"name": "DISM: восстановление", "cmd": "DISM /Online /Cleanup-Image /RestoreHealth", "admin": true, "desc": "Восстанавливает поврежденные компоненты Windows"},
            {"name": "Статус брандмауэра", "cmd": "Get-NetFirewallProfile | Select-Object Name, Enabled", "admin": false, "desc": "Показывает включен ли Windows Firewall"},
            {"name": "Включить брандмауэр", "cmd": "Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True", "admin": true, "desc": "Включает брандмауэр для всех профилей сети"}
          ]
        },
        {
          "title": "Снятие блокировки скачанных файлов (Zone.Identifier)",
          "description": "Windows помечает файлы из интернета как потенциально опасные. Из-за этого PDF, скрипты и другие файлы могут не открываться или выдавать ошибку безопасности.",
          "commands": [
            {
              "name": "Разблокировать файлы в папке",
              "cmd": "Get-ChildItem -Path \"C:\\Users\\User\\Downloads\" -Recurse -File | Unblock-File\nWrite-Host 'Блокировка снята!' -ForegroundColor Green",
              "admin": false,
              "desc": "Снимает блокировку со всех файлов в указанной папке и подпапках",
              "note": "Замените путь на вашу папку"
            },
            {
              "name": "Отключить блокировку скачанных файлов навсегда",
              "cmd": "New-Item -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Attachments\" -Force\nSet-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Attachments\" -Name \"SaveZoneInformation\" -Value 1 -Type DWord",
              "admin": false,
              "desc": "Windows больше не будет помечать скачанные файлы как заблокированные",
              "note": "Требуется перезагрузка"
            },
            {
              "name": "Вернуть блокировку скачанных файлов",
              "cmd": "Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Attachments\" -Name \"SaveZoneInformation\" -Value 2 -Type DWord",
              "admin": false,
              "desc": "Возвращает стандартное поведение Windows по блокировке файлов"
            }
          ]
        },
        {
          "title": "Аудит безопасности",
          "commands": [
            {"name": "Аудит входов в систему", "cmd": "Get-WinEvent -LogName Security -FilterXPath \"*[System[EventID=4624]]\" -MaxEvents 20 | Select-Object TimeCreated, @{N='User';E={$_.Properties[5].Value}} | Format-Table", "admin": true, "desc": "Последние 20 событий входа в систему"},
            {"name": "Заблокированные подключения брандмауэром", "cmd": "Get-WinEvent -LogName Security -FilterXPath \"*[System[EventID=5157]]\" -MaxEvents 20 -ErrorAction SilentlyContinue | Select-Object TimeCreated, Message | Format-Table -Wrap", "admin": true, "desc": "Подключения, которые были заблокированы Windows Firewall"}
          ]
        }
      ]
    },
    {
      "id": "users",
      "title": "Пользователи",
      "icon": "users",
      "cards": [
        {
          "title": "Управление пользователями",
          "commands": [
            {"name": "Текущий пользователь", "cmd": "whoami", "admin": false, "desc": "Показывает имя текущего пользователя"},
            {"name": "Все локальные пользователи", "cmd": "Get-LocalUser | Select-Object Name, Enabled, LastLogon | Format-Table", "admin": false, "desc": "Список всех учетных записей на компьютере"},
            {"name": "Группы и их члены", "cmd": "Get-LocalGroup | ForEach-Object { $g=$_.Name; Get-LocalGroupMember $g -ErrorAction SilentlyContinue | Select-Object @{N='Group';E={$g}}, Name } | Format-Table", "admin": true, "desc": "Все группы и кто в них входит"},
            {"name": "Создать пользователя", "cmd": "$pw = Read-Host 'Пароль' -AsSecureString; New-LocalUser -Name 'NewUser' -Password $pw -FullName 'Новый Пользователь'", "admin": true, "desc": "Создает нового локального пользователя", "note": "Замените NewUser"},
            {"name": "Добавить в Администраторы", "cmd": "Add-LocalGroupMember -Group 'Administrators' -Member 'NewUser'", "admin": true, "desc": "Дает пользователю права администратора", "note": "Замените NewUser"},
            {"name": "Отключить пользователя", "cmd": "Disable-LocalUser -Name 'NewUser'", "admin": true, "desc": "Деактивирует учетную запись без удаления"},
            {"name": "Сменить пароль", "cmd": "$pw = Read-Host 'Новый пароль' -AsSecureString; Set-LocalUser -Name 'UserName' -Password $pw", "admin": true, "desc": "Меняет пароль для указанного пользователя", "note": "Замените UserName"}
          ]
        }
      ]
    },
    {
      "id": "cleanup",
      "title": "Очистка",
      "icon": "trash",
      "cards": [
        {
          "title": "Очистка системы",
          "commands": [
            {"name": "Очистка temp (пользователь)", "cmd": "Remove-Item \"$env:TEMP\\*\" -Recurse -Force -ErrorAction SilentlyContinue", "admin": false, "desc": "Удаляет временные файлы текущего пользователя"},
            {"name": "Очистка temp (система)", "cmd": "Remove-Item \"$env:windir\\Temp\\*\" -Recurse -Force -ErrorAction SilentlyContinue", "admin": true, "desc": "Удаляет системные временные файлы"},
            {"name": "Очистка кэша обновлений", "cmd": "Stop-Service wuauserv -Force; Remove-Item \"$env:windir\\SoftwareDistribution\\Download\\*\" -Recurse -Force -ErrorAction SilentlyContinue; Start-Service wuauserv", "admin": true, "desc": "Очищает скачанные файлы обновлений Windows"},
            {"name": "Очистка Prefetch", "cmd": "Remove-Item \"$env:windir\\Prefetch\\*\" -Force -ErrorAction SilentlyContinue", "admin": true, "desc": "Удаляет файлы предзагрузки программ"},
            {"name": "Размер папки temp", "cmd": "'{0:N2} MB' -f ((Get-ChildItem $env:TEMP -Recurse -ErrorAction SilentlyContinue | Measure-Object Length -Sum).Sum/1MB)", "admin": false, "desc": "Показывает сколько места занимают временные файлы"},
            {"name": "Очистка всех логов событий", "cmd": "wevtutil el | ForEach-Object { wevtutil cl $_ 2>$null }", "admin": true, "desc": "Очищает все журналы событий Windows"},
            {"name": "Очистка диска (GUI)", "cmd": "cleanmgr /d C", "admin": true, "desc": "Запускает встроенную утилиту очистки диска"},
            {"name": "Удалить старые точки восстановления", "cmd": "vssadmin delete shadows /for=C: /oldest", "admin": true, "desc": "Удаляет самую старую теневую копию для освобождения места"}
          ]
        }
      ]
    },
    {
      "id": "apps",
      "title": "Приложения",
      "icon": "monitor",
      "cards": [
        {
          "title": "Управление приложениями (winget)",
          "commands": [
            {"name": "Список установленных", "cmd": "winget list", "admin": false, "desc": "Показывает все установленные программы"},
            {"name": "Поиск пакета", "cmd": "winget search \"название\"", "admin": false, "desc": "Ищет приложение в репозитории winget", "note": "Замените название"},
            {"name": "Установить приложение", "cmd": "winget install --id \"App.Id\" --source winget", "admin": false, "desc": "Устанавливает приложение по его идентификатору", "note": "Замените App.Id"},
            {"name": "Удалить приложение", "cmd": "winget uninstall --id \"App.Id\"", "admin": false, "desc": "Удаляет установленное приложение", "note": "Замените App.Id"},
            {"name": "Обновить все приложения", "cmd": "winget upgrade --all --include-unknown", "admin": true, "desc": "Обновляет все программы, для которых есть обновления"},
            {"name": "Экспорт списка ПО на рабочий стол", "cmd": "winget list | Out-File \"$env:USERPROFILE\\Desktop\\apps.txt\"; Write-Host 'Сохранено на рабочий стол' -ForegroundColor Green", "admin": false, "desc": "Сохраняет список всех программ в текстовый файл"}
          ]
        },
        {
          "title": "Встроенные приложения Windows",
          "commands": [
            {"name": "Список всех встроенных приложений", "cmd": "Get-AppxPackage | Select-Object Name | Sort-Object Name", "admin": false, "desc": "Все приложения из Microsoft Store и встроенные"},
            {"name": "Удалить Xbox приложения", "cmd": "Get-AppxPackage *xbox* | Remove-AppxPackage", "admin": false, "desc": "Удаляет все приложения Xbox"},
            {"name": "Удалить Cortana", "cmd": "Get-AppxPackage *cortana* | Remove-AppxPackage", "admin": false, "desc": "Удаляет голосовой помощник Cortana"}
          ]
        }
      ]
    }
  ],
  "utilities": [
    {
      "id": "folder-access",
      "title": "Восстановление доступа к папке",
      "icon": "lock",
      "description": "Если после переустановки Windows нет доступа к файлам (\"Отказано в доступе\")",
      "fields": [
        {"id": "path", "label": "Путь к папке", "placeholder": "D:\\Мои документы", "type": "text"}
      ],
      "actions": [
        {"label": "Основной скрипт", "template": "Write-Host '1. Смена владельца на группу Администраторы...' -ForegroundColor Yellow\ntakeown /F \"{path}\" /R /A\nWrite-Host '2. Предоставление полного доступа всем пользователям...' -ForegroundColor Yellow\nicacls \"{path}\" /grant *S-1-5-32-545:F /T /Q\nWrite-Host 'Готово! Права для папки успешно применены.' -ForegroundColor Green"},
        {"label": "Снять 'Только чтение'", "template": "attrib -r \"{path}\" /S /D"},
        {"label": "Полный сброс прав", "template": "Write-Host '1. Принудительная смена владельца...' -ForegroundColor Yellow\ntakeown /F \"{path}\" /R /A\nWrite-Host '2. Полный сброс прав доступа и включение наследования...' -ForegroundColor Yellow\nicacls \"{path}\" /reset /T /C /Q\nWrite-Host 'Готово! Права полностью сброшены.' -ForegroundColor Green"}
      ]
    },
    {
      "id": "firewall-rule",
      "title": "Правило для Брандмауэра",
      "icon": "shield-plus",
      "description": "Создание разрешающего правила для открытия порта в брандмауэре Windows",
      "fields": [
        {"id": "ruleName", "label": "Название правила", "placeholder": "MyGameServer", "type": "text"},
        {"id": "port", "label": "Номер порта", "placeholder": "25565", "type": "number"},
        {"id": "protocol", "label": "Протокол", "type": "radio", "options": ["TCP", "UDP"], "default": "TCP"},
        {"id": "direction", "label": "Направление", "type": "radio", "options": ["Inbound", "Outbound", "Both"], "default": "Inbound"}
      ],
      "actions": [
        {"label": "Создать правило", "handler": "firewall"},
        {"label": "Проверить порт", "handler": "portcheck"}
      ]
    },
    {
      "id": "folder-size",
      "title": "Анализ размера папок",
      "icon": "pie-chart",
      "description": "Показывает размеры всех подпапок, сортируя от самой большой к самой маленькой",
      "fields": [
        {"id": "path", "label": "Путь к папке для анализа", "placeholder": "C:\\Program Files", "type": "text"}
      ],
      "actions": [
        {"label": "Сформировать команду", "template": "$targetPath = \"{path}\"\nWrite-Host \"Анализирую папку: $targetPath ...\" -ForegroundColor Yellow\nGet-ChildItem -Path $targetPath -Directory -ErrorAction SilentlyContinue |\n  Select-Object Name, @{Name='SizeBytes'; Expression={\n    (Get-ChildItem -Path $_.FullName -Recurse -File -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum -ErrorAction SilentlyContinue).Sum\n  }} |\n  Sort-Object -Property SizeBytes -Descending |\n  Select-Object Name, @{Name='Размер (ГБ)'; Expression={'{0:N2}' -f ($_.SizeBytes / 1GB)}}, @{Name='Размер (МБ)'; Expression={'{0:N2}' -f ($_.SizeBytes / 1MB)}} |\n  Format-Table -AutoSize"}
      ]
    },
    {
      "id": "file-search",
      "title": "Поиск файлов и текста",
      "icon": "search",
      "description": "Поиск файлов по имени, расширению или тексту внутри них",
      "fields": [
        {"id": "path", "label": "Папка для поиска", "placeholder": "C:\\Users\\Admin\\Documents", "type": "text"},
        {"id": "pattern", "label": "Маска имени файла (* = любой символ)", "placeholder": "*.txt или report_*.docx", "type": "text"},
        {"id": "text", "label": "Текст внутри файлов (необязательно)", "placeholder": "critical error", "type": "text"},
        {"id": "recursive", "label": "Искать в подпапках", "type": "checkbox", "default": true}
      ],
      "actions": [
        {"label": "Сформировать команду", "handler": "filesearch"}
      ]
    },
    {
      "id": "lan-scanner",
      "title": "Сканер ЛВС с отчетом",
      "icon": "radar",
      "description": "Сканирует сеть и создает интерактивный HTML-отчет. Требуется PowerShell 7.2+",
      "fields": [
        {"id": "baseIP", "label": "Базовый IP-адрес (с точкой в конце)", "placeholder": "192.168.1.", "type": "text"},
        {"id": "start", "label": "Начало диапазона", "placeholder": "1", "type": "number"},
        {"id": "end", "label": "Конец диапазона", "placeholder": "254", "type": "number"}
      ],
      "actions": [
        {"label": "Сформировать команду", "handler": "lanscan"}
      ]
    },
    {
      "id": "pagefile-optimize",
      "title": "Оптимизация файла подкачки и системы",
      "icon": "zap",
      "description": "Автоматически определяет ОЗУ, тип диска (SSD/HDD) и настраивает оптимальный размер pagefile. Также применяет дополнительные твики.",
      "fields": [
        {"id": "drive", "label": "Буква диска для размещения файла подкачки", "placeholder": "C (только одна буква)", "type": "text"}
      ],
      "actions": [
        {"label": "Сформировать скрипт оптимизации", "handler": "optimize"}
      ]
    },
    {
      "id": "service-report",
      "title": "Детальный отчет о службах (HTML)",
      "icon": "clipboard",
      "description": "Создает интерактивный HTML-отчет о всех службах Windows с потреблением ресурсов",
      "fields": [
        {"id": "filter", "label": "Фильтр по имени (необязательно)", "placeholder": "sql, print, py", "type": "text"}
      ],
      "actions": [
        {"label": "Сформировать скрипт", "handler": "servicereport"}
      ]
    }
  ],
  "ai": {
    "proxyUrl": "https://mapruapp.ru",
    "model": "gemini-2.5-flash-lite",
    "systemPrompt": "Ты — «PowerShell-Эксперт», встроенный в веб-инструмент «Помощник по настройке ПК». Твоя задача — помогать пользователям, генерируя команды для PowerShell.\n\nВсегда следуй этому формату ответа:\n1. Оберни готовые к выполнению команды PowerShell в теги [COMMAND]...[/COMMAND]. Каждая команда должна быть в своем блоке.\n2. Краткое пояснение ПОСЛЕ всех блоков с командами.\n\nЕсли не можешь сгенерировать команду, честно скажи. Не выдумывай команды. Отвечай на русском."
  }
}