<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–µ–Ω—é –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: #5d4037;
            margin-bottom: 30px;
            padding: 30px;
            background: white;
            border-radius: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }

        .chef-icon {
            font-size: 80px;
            margin-bottom: 15px;
            display: block;
        }

        header h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
            color: #d84315;
        }

        header p {
            font-size: 1.1em;
            color: #8d6e63;
        }

        .controls-panel {
            background: white;
            border-radius: 25px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            border: 3px solid #ffccbc;
        }

        .controls-row {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }

        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 50px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
        }

        .btn-primary {
            background: linear-gradient(135deg, #ff8a65 0%, #ff5722 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 87, 34, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #81c784 0%, #4caf50 100%);
            color: white;
        }

        .btn-secondary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.4);
        }

        .btn-toggle {
            background: linear-gradient(135deg, #ffb74d 0%, #ff9800 100%);
            color: white;
        }

        .btn-toggle:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 152, 0, 0.4);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .settings-row {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
            padding: 15px;
            background: #fff8e1;
            border-radius: 20px;
            margin-bottom: 15px;
        }

        .setting-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .setting-item label {
            font-weight: 600;
            color: #5d4037;
        }

        .setting-item select,
        .setting-item input[type="number"] {
            padding: 10px 15px;
            border: 2px solid #ffccbc;
            border-radius: 15px;
            font-size: 1em;
            background: white;
            cursor: pointer;
            color: #5d4037;
        }

        .setting-item select:focus,
        .setting-item input:focus {
            outline: none;
            border-color: #ff5722;
        }

        .ingredients-section {
            margin-top: 15px;
            overflow: hidden;
            max-height: 0;
            transition: max-height 0.5s ease, padding 0.3s ease;
        }

        .ingredients-section.open {
            max-height: 2000px;
            padding-top: 20px;
        }

        .ingredients-section h3 {
            margin-bottom: 15px;
            color: #5d4037;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .add-ingredient-row {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .add-ingredient-row input {
            flex: 1;
            min-width: 200px;
            padding: 12px 20px;
            border: 2px solid #ffccbc;
            border-radius: 25px;
            font-size: 1em;
            color: #5d4037;
        }

        .add-ingredient-row input:focus {
            outline: none;
            border-color: #ff5722;
        }

        .add-ingredient-row input::placeholder {
            color: #bcaaa4;
        }

        .btn-add {
            padding: 12px 25px;
            background: linear-gradient(135deg, #a5d6a7 0%, #66bb6a 100%);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-add:hover {
            transform: scale(1.05);
        }

        .category-container {
            margin-bottom: 15px;
            background: #fff8e1;
            border-radius: 20px;
            overflow: hidden;
        }

        .category-header {
            padding: 15px 20px;
            background: linear-gradient(135deg, #ffe0b2 0%, #ffcc80 100%);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-weight: 700;
            color: #5d4037;
            transition: background 0.3s ease;
        }

        .category-header:hover {
            background: linear-gradient(135deg, #ffcc80 0%, #ffb74d 100%);
        }

        .category-header .arrow {
            transition: transform 0.3s ease;
        }

        .category-header.open .arrow {
            transform: rotate(180deg);
        }

        .category-tags {
            display: none;
            flex-wrap: wrap;
            gap: 8px;
            padding: 15px 20px;
        }

        .category-tags.open {
            display: flex;
        }

        .tag {
            padding: 8px 16px;
            background: white;
            border-radius: 20px;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 2px solid #ffe0b2;
            color: #5d4037;
            user-select: none;
        }

        .tag:hover {
            border-color: #ff9800;
            background: #fff8e1;
        }

        .tag.selected {
            background: linear-gradient(135deg, #ff8a65 0%, #ff5722 100%);
            color: white;
            border-color: #ff5722;
        }

        .selected-tags-container {
            margin-top: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border-radius: 20px;
            min-height: 60px;
        }

        .selected-tags-container h4 {
            color: #2e7d32;
            margin-bottom: 12px;
            font-size: 0.95em;
        }

        .selected-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .selected-tag {
            padding: 8px 14px;
            background: linear-gradient(135deg, #81c784 0%, #4caf50 100%);
            color: white;
            border-radius: 20px;
            font-size: 0.85em;
            display: flex;
            align-items: center;
            gap: 8px;
            animation: popIn 0.3s ease;
        }

        @keyframes popIn {
            0% { transform: scale(0); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .selected-tag .remove {
            cursor: pointer;
            font-weight: bold;
            opacity: 0.8;
            font-size: 1.1em;
        }

        .selected-tag .remove:hover {
            opacity: 1;
        }

        .empty-selection {
            color: #81c784;
            font-style: italic;
        }

        .menu-result {
            background: white;
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            border: 3px solid #c8e6c9;
        }

        .menu-result h2 {
            text-align: center;
            color: #5d4037;
            margin-bottom: 25px;
            font-size: 1.8em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .loading-container {
            text-align: center;
            padding: 60px 20px;
        }

        .cooking-animation {
            font-size: 80px;
            animation: cooking 1s ease-in-out infinite;
        }

        @keyframes cooking {
            0%, 100% { transform: rotate(-5deg); }
            50% { transform: rotate(5deg); }
        }

        .loading-text {
            margin-top: 20px;
            font-size: 1.2em;
            color: #8d6e63;
        }

        .loading-dots::after {
            content: '';
            animation: dots 1.5s steps(4, end) infinite;
        }

        @keyframes dots {
            0%, 20% { content: ''; }
            40% { content: '.'; }
            60% { content: '..'; }
            80%, 100% { content: '...'; }
        }

        .menu-content {
            line-height: 1.8;
            color: #5d4037;
        }

        .menu-content .meal-block {
            background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 5px solid #ff9800;
        }

        .menu-content .meal-title {
            font-size: 1.3em;
            font-weight: 700;
            color: #e65100;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .menu-content .meal-name {
            font-size: 1.1em;
            font-weight: 600;
            color: #5d4037;
            margin-bottom: 10px;
        }

        .menu-content .meal-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }

        .menu-content .info-badge {
            background: white;
            padding: 10px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .menu-content .info-badge .value {
            font-size: 1.2em;
            font-weight: 700;
            color: #ff5722;
        }

        .menu-content .info-badge .label {
            font-size: 0.75em;
            color: #8d6e63;
            text-transform: uppercase;
        }

        .menu-content .ingredients-list {
            background: white;
            padding: 15px;
            border-radius: 12px;
            margin: 10px 0;
        }

        .menu-content .ingredients-list h5 {
            color: #4caf50;
            margin-bottom: 8px;
        }

        .menu-content .recipe-text {
            background: white;
            padding: 15px;
            border-radius: 12px;
            font-style: italic;
            color: #6d4c41;
        }

        .menu-content .recipe-text h5 {
            font-style: normal;
            color: #ff5722;
            margin-bottom: 8px;
        }

        .daily-total {
            background: linear-gradient(135deg, #c8e6c9 0%, #a5d6a7 100%);
            border-radius: 20px;
            padding: 25px;
            margin-top: 25px;
            text-align: center;
        }

        .daily-total h3 {
            color: #2e7d32;
            margin-bottom: 20px;
            font-size: 1.3em;
        }

        .total-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
        }

        .total-item {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .total-item .value {
            font-size: 1.8em;
            font-weight: 700;
            color: #ff5722;
        }

        .total-item .label {
            font-size: 0.85em;
            color: #8d6e63;
            margin-top: 5px;
        }

        .placeholder-message {
            text-align: center;
            padding: 60px 20px;
            color: #bcaaa4;
        }

        .placeholder-message .icon {
            font-size: 80px;
            margin-bottom: 20px;
        }

        .placeholder-message h3 {
            color: #8d6e63;
            margin-bottom: 10px;
        }

        .placeholder-message p {
            font-size: 1.1em;
        }

        .btn-clear {
            background: linear-gradient(135deg, #ef9a9a 0%, #e57373 100%);
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 15px;
            font-size: 0.85em;
            cursor: pointer;
            margin-left: auto;
        }

        .btn-clear:hover {
            transform: scale(1.05);
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.6em;
            }

            .chef-icon {
                font-size: 60px;
            }

            .controls-row {
                flex-direction: column;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }

            .settings-row {
                flex-direction: column;
            }

            .setting-item {
                width: 100%;
                justify-content: space-between;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <span class="chef-icon">üë®‚Äçüç≥</span>
            <h1>–ú–µ–Ω—é –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è</h1>
            <p>–í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –ø–æ –∑–¥–æ—Ä–æ–≤–æ–º—É –ø–∏—Ç–∞–Ω–∏—é</p>
        </header>

        <div class="controls-panel">
            <div class="controls-row">
                <button class="btn btn-primary" onclick="generateMenu()">
                    üç≥ –°–æ—Å—Ç–∞–≤–∏—Ç—å –º–µ–Ω—é
                </button>
                <button class="btn btn-toggle" onclick="toggleIngredients()">
                    ü•ó –í—ã–±—Ä–∞—Ç—å –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã
                </button>
                <button class="btn btn-secondary" onclick="generateRandomMenu()">
                    üé≤ –°–ª—É—á–∞–π–Ω–æ–µ –º–µ–Ω—é
                </button>
            </div>

            <div class="settings-row">
                <div class="setting-item">
                    <label>üî• –ö–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å:</label>
                    <select id="calorieTarget">
                        <option value="1200">1200 –∫–∫–∞–ª</option>
                        <option value="1500">1500 –∫–∫–∞–ª</option>
                        <option value="1800" selected>1800 –∫–∫–∞–ª</option>
                        <option value="2000">2000 –∫–∫–∞–ª</option>
                        <option value="2200">2200 –∫–∫–∞–ª</option>
                        <option value="2500">2500 –∫–∫–∞–ª</option>
                        <option value="3000">3000 –∫–∫–∞–ª</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label>üë• –ü–æ—Ä—Ü–∏–π:</label>
                    <input type="number" id="portions" value="1" min="1" max="10" style="width: 70px;">
                </div>
                <div class="setting-item">
                    <label>üçΩÔ∏è –¢–∏–ø –ø–∏—Ç–∞–Ω–∏—è:</label>
                    <select id="dietType">
                        <option value="balanced">–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ</option>
                        <option value="protein">–í—ã—Å–æ–∫–æ–±–µ–ª–∫–æ–≤–æ–µ</option>
                        <option value="lowcarb">–ù–∏–∑–∫–æ—É–≥–ª–µ–≤–æ–¥–Ω–æ–µ</option>
                        <option value="vegetarian">–í–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω—Å–∫–æ–µ</option>
                        <option value="vegan">–í–µ–≥–∞–Ω—Å–∫–æ–µ</option>
                    </select>
                </div>
            </div>

            <div class="ingredients-section" id="ingredientsSection">
                <h3>üõí –î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–∏ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ –∏–∑ —Å–ø–∏—Å–∫–∞:</h3>
                
                <div class="add-ingredient-row">
                    <input type="text" id="customIngredient" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞..." onkeypress="handleIngredientKeypress(event)">
                    <button class="btn-add" onclick="addCustomIngredient()">+ –î–æ–±–∞–≤–∏—Ç—å</button>
                </div>

                <div id="categoriesContainer"></div>

                <div class="selected-tags-container">
                    <div style="display: flex; align-items: center; margin-bottom: 12px;">
                        <h4 style="margin: 0;">‚úÖ –í—ã–±—Ä–∞–Ω–Ω—ã–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã:</h4>
                        <button class="btn-clear" onclick="clearAllIngredients()" id="clearBtn" style="display: none;">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ</button>
                    </div>
                    <div class="selected-tags" id="selectedTags">
                        <span class="empty-selection">–ü–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ –≤—ã–±—Ä–∞–Ω–æ...</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="menu-result" id="menuResult">
            <div class="placeholder-message">
                <div class="icon">üç¥</div>
                <h3>–ì–æ—Ç–æ–≤—ã —Å–æ—Å—Ç–∞–≤–∏—Ç—å –º–µ–Ω—é!</h3>
                <p>–ù–∞–∂–º–∏—Ç–µ "–°–æ—Å—Ç–∞–≤–∏—Ç—å –º–µ–Ω—é" –∏–ª–∏ "–°–ª—É—á–∞–π–Ω–æ–µ –º–µ–Ω—é" –¥–ª—è –Ω–∞—á–∞–ª–∞</p>
            </div>
        </div>
    </div>

    <script>
        const MAPRUAPP_PROXY_BASE_URL = "https://mapruapp.ru";

        const ingredientCategories = {
            "ü•© –ú—è—Å–æ –∏ –ø—Ç–∏—Ü–∞": [
                "–≥–æ–≤—è–¥–∏–Ω–∞", "—Å–≤–∏–Ω–∏–Ω–∞", "–±–∞—Ä–∞–Ω–∏–Ω–∞", "—Ç–µ–ª—è—Ç–∏–Ω–∞", "–∫—Ä–æ–ª–∏–∫",
                "–∫—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞", "–∫—É—Ä–∏–Ω–æ–µ —Ñ–∏–ª–µ", "–∫—É—Ä–∏–Ω—ã–µ –±—ë–¥—Ä–∞", "–∫—É—Ä–∏—Ü–∞ —Ü–µ–ª–∞—è",
                "–∏–Ω–¥–µ–π–∫–∞", "—É—Ç–∫–∞", "—Ñ–∞—Ä—à –∫—É—Ä–∏–Ω—ã–π", "—Ñ–∞—Ä—à –≥–æ–≤—è–∂–∏–π", "—Ñ–∞—Ä—à —Å–≤–∏–Ω–æ–π",
                "–ø–µ—á–µ–Ω—å –∫—É—Ä–∏–Ω–∞—è", "–ø–µ—á–µ–Ω—å –≥–æ–≤—è–∂—å—è", "—Å–µ—Ä–¥—Ü–µ", "—è–∑—ã–∫ –≥–æ–≤—è–∂–∏–π"
            ],
            "üêü –†—ã–±–∞ –∏ –º–æ—Ä–µ–ø—Ä–æ–¥—É–∫—Ç—ã": [
                "–ª–æ—Å–æ—Å—å", "—Å—ë–º–≥–∞", "—Ñ–æ—Ä–µ–ª—å", "—Ç—Ä–µ—Å–∫–∞", "–º–∏–Ω—Ç–∞–π", "—Ö–µ–∫", "–¥–æ—Ä–∞–¥–æ",
                "—Å–∏–±–∞—Å", "—Ç—É–Ω–µ—Ü", "—Å–∫—É–º–±—Ä–∏—è", "—Å–µ–ª—å–¥—å", "–∫–∞—Ä–ø", "—Å—É–¥–∞–∫", "–æ–∫—É–Ω—å",
                "–∫—Ä–µ–≤–µ—Ç–∫–∏", "–∫–∞–ª—å–º–∞—Ä—ã", "–º–∏–¥–∏–∏", "–æ—Å—å–º–∏–Ω–æ–≥", "–≥—Ä–µ–±–µ—à–∫–∏", "–∫—Ä–∞–±–æ–≤–æ–µ –º—è—Å–æ",
                "–∏–∫—Ä–∞ –∫—Ä–∞—Å–Ω–∞—è", "–º–æ—Ä—Å–∫–∞—è –∫–∞–ø—É—Å—Ç–∞"
            ],
            "ü•õ –ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã": [
                "–º–æ–ª–æ–∫–æ", "–∫–µ—Ñ–∏—Ä", "—Ä—è–∂–µ–Ω–∫–∞", "–π–æ–≥—É—Ä—Ç", "–π–æ–≥—É—Ä—Ç –≥—Ä–µ—á–µ—Å–∫–∏–π",
                "—Ç–≤–æ—Ä–æ–≥", "—Ç–≤–æ—Ä–æ–≥ –æ–±–µ–∑–∂–∏—Ä–µ–Ω–Ω—ã–π", "—Å–º–µ—Ç–∞–Ω–∞", "—Å–ª–∏–≤–∫–∏", "–º–∞—Å–ª–æ —Å–ª–∏–≤–æ—á–Ω–æ–µ",
                "—Å—ã—Ä —Ç–≤—ë—Ä–¥—ã–π", "—Å—ã—Ä –º—è–≥–∫–∏–π", "–º–æ—Ü–∞—Ä–µ–ª–ª–∞", "–ø–∞—Ä–º–µ–∑–∞–Ω", "—Ñ–µ—Ç–∞", "–±—Ä—ã–Ω–∑–∞",
                "—Ä–∏–∫–æ—Ç—Ç–∞", "–º–∞—Å–∫–∞—Ä–ø–æ–Ω–µ", "—Å—ã—Ä –ø–ª–∞–≤–ª–µ–Ω—ã–π", "–ø—Ä–æ—Å—Ç–æ–∫–≤–∞—à–∞"
            ],
            "ü•ö –Ø–π—Ü–∞": [
                "—è–π—Ü–∞ –∫—É—Ä–∏–Ω—ã–µ", "—è–π—Ü–∞ –ø–µ—Ä–µ–ø–µ–ª–∏–Ω—ã–µ", "–±–µ–ª–æ–∫ —è–∏—á–Ω—ã–π", "–∂–µ–ª—Ç–æ–∫ —è–∏—á–Ω—ã–π"
            ],
            "üåæ –ö—Ä—É–ø—ã –∏ –∑–ª–∞–∫–∏": [
                "—Ä–∏—Å –±–µ–ª—ã–π", "—Ä–∏—Å –±—É—Ä—ã–π", "—Ä–∏—Å –±–∞—Å–º–∞—Ç–∏", "–≥—Ä–µ—á–∫–∞", "–æ–≤—Å—è–Ω–∫–∞",
                "–ø—à–µ–Ω–æ", "–ø–µ—Ä–ª–æ–≤–∫–∞", "–±—É–ª–≥—É—Ä", "–∫—É—Å–∫—É—Å", "–∫–∏–Ω–æ–∞", "–º–∞–Ω–∫–∞",
                "–∫—É–∫—É—Ä—É–∑–Ω–∞—è –∫—Ä—É–ø–∞", "—è—á–Ω–µ–≤–∞—è –∫—Ä—É–ø–∞", "–ø–æ–ª–±–∞", "—á–µ—á–µ–≤–∏—Ü–∞ –∫—Ä–∞—Å–Ω–∞—è",
                "—á–µ—á–µ–≤–∏—Ü–∞ –∑–µ–ª—ë–Ω–∞—è", "–Ω—É—Ç", "—Ñ–∞—Å–æ–ª—å –±–µ–ª–∞—è", "—Ñ–∞—Å–æ–ª—å –∫—Ä–∞—Å–Ω–∞—è",
                "–≥–æ—Ä–æ—Ö", "–º–∞—à", "–æ—Ç—Ä—É–±–∏ –æ–≤—Å—è–Ω—ã–µ", "–æ—Ç—Ä—É–±–∏ –ø—à–µ–Ω–∏—á–Ω—ã–µ"
            ],
            "üçû –ú—É—á–Ω—ã–µ –∏–∑–¥–µ–ª–∏—è": [
                "—Ö–ª–µ–± –±–µ–ª—ã–π", "—Ö–ª–µ–± —á—ë—Ä–Ω—ã–π", "—Ö–ª–µ–± —Ü–µ–ª—å–Ω–æ–∑–µ—Ä–Ω–æ–≤–æ–π", "–±–∞—Ç–æ–Ω",
                "–ª–∞–≤–∞—à", "–ª–µ–ø—ë—à–∫–∞", "–ø–∏—Ç—Ç–∞", "–±–∞–≥–µ—Ç", "–±—É–ª–æ—á–∫–∞", "—Å—É—Ö–∞—Ä–∏",
                "—Ö–ª–µ–±—Ü—ã —Ä–∏—Å–æ–≤—ã–µ", "—Ö–ª–µ–±—Ü—ã —Ä–∂–∞–Ω—ã–µ", "–º—É–∫–∞ –ø—à–µ–Ω–∏—á–Ω–∞—è", "–º—É–∫–∞ —Ä–∂–∞–Ω–∞—è",
                "–º—É–∫–∞ –æ–≤—Å—è–Ω–∞—è", "–º—É–∫–∞ –∫—É–∫—É—Ä—É–∑–Ω–∞—è", "–º—É–∫–∞ –º–∏–Ω–¥–∞–ª—å–Ω–∞—è", "–º—É–∫–∞ –∫–æ–∫–æ—Å–æ–≤–∞—è"
            ],
            "üçù –ú–∞–∫–∞—Ä–æ–Ω—ã": [
                "—Å–ø–∞–≥–µ—Ç—Ç–∏", "–ø–µ–Ω–Ω–µ", "—Ñ–∞—Ä—Ñ–∞–ª–ª–µ", "—Ñ—É–∑–∏–ª–ª–∏", "–ª–∞–∑–∞–Ω—å—è",
                "–º–∞–∫–∞—Ä–æ–Ω—ã —Ü–µ–ª—å–Ω–æ–∑–µ—Ä–Ω–æ–≤—ã–µ", "–ª–∞–ø—à–∞ —è–∏—á–Ω–∞—è", "–ª–∞–ø—à–∞ —Ä–∏—Å–æ–≤–∞—è",
                "–ª–∞–ø—à–∞ –≥—Ä–µ—á–Ω–µ–≤–∞—è", "–≤–µ—Ä–º–∏—à–µ–ª—å"
            ],
            "ü•¨ –û–≤–æ—â–∏": [
                "–∫–∞—Ä—Ç–æ—Ñ–µ–ª—å", "–º–æ—Ä–∫–æ–≤—å", "—Å–≤—ë–∫–ª–∞", "–ª—É–∫ —Ä–µ–ø—á–∞—Ç—ã–π", "–ª—É–∫ –∫—Ä–∞—Å–Ω—ã–π",
                "–ª—É–∫ –∑–µ–ª—ë–Ω—ã–π", "—á–µ—Å–Ω–æ–∫", "–∫–∞–ø—É—Å—Ç–∞ –±–µ–ª–æ–∫–æ—á–∞–Ω–Ω–∞—è", "–∫–∞–ø—É—Å—Ç–∞ –ø–µ–∫–∏–Ω—Å–∫–∞—è",
                "–∫–∞–ø—É—Å—Ç–∞ —Ü–≤–µ—Ç–Ω–∞—è", "–±—Ä–æ–∫–∫–æ–ª–∏", "–±—Ä—é—Å—Å–µ–ª—å—Å–∫–∞—è –∫–∞–ø—É—Å—Ç–∞", "–∫–æ–ª—å—Ä–∞–±–∏",
                "–æ–≥—É—Ä–µ—Ü", "–ø–æ–º–∏–¥–æ—Ä", "–ø–æ–º–∏–¥–æ—Ä—ã —á–µ—Ä—Ä–∏", "–ø–µ—Ä–µ—Ü –±–æ–ª–≥–∞—Ä—Å–∫–∏–π",
                "–ø–µ—Ä–µ—Ü —á–∏–ª–∏", "–±–∞–∫–ª–∞–∂–∞–Ω", "–∫–∞–±–∞—á–æ–∫", "—Ü—É–∫–∫–∏–Ω–∏", "—Ç—ã–∫–≤–∞",
                "–ø–∞—Ç–∏—Å—Å–æ–Ω", "—Ä–µ–¥–∏—Å", "—Ä–µ–¥—å–∫–∞", "–¥–∞–π–∫–æ–Ω", "—Ä–µ–ø–∞", "—Å–µ–ª—å–¥–µ—Ä–µ–π",
                "—Å–ø–∞—Ä–∂–∞", "–∞—Ä—Ç–∏—à–æ–∫", "—Ñ–µ–Ω—Ö–µ–ª—å", "–±–∞—Ç–∞—Ç", "—Ç–æ–ø–∏–Ω–∞–º–±—É—Ä"
            ],
            "ü•ó –ó–µ–ª–µ–Ω—å –∏ —Å–∞–ª–∞—Ç—ã": [
                "—Å–∞–ª–∞—Ç –∞–π—Å–±–µ—Ä–≥", "—Å–∞–ª–∞—Ç —Ä–æ–º–∞–Ω–æ", "—Ä—É–∫–∫–æ–ª–∞", "—à–ø–∏–Ω–∞—Ç", "–º–∞–Ω–≥–æ–ª—å–¥",
                "–∫—Ä–µ—Å—Å-—Å–∞–ª–∞—Ç", "—É–∫—Ä–æ–ø", "–ø–µ—Ç—Ä—É—à–∫–∞", "–∫–∏–Ω–∑–∞", "–±–∞–∑–∏–ª–∏–∫",
                "–º—è—Ç–∞", "—Ä–æ–∑–º–∞—Ä–∏–Ω", "—Ç–∏–º—å—è–Ω", "–æ—Ä–µ–≥–∞–Ω–æ", "—ç—Å—Ç—Ä–∞–≥–æ–Ω",
                "–∑–µ–ª—ë–Ω—ã–π –ª—É–∫", "—â–∞–≤–µ–ª—å", "—á–µ—Ä–µ–º—à–∞"
            ],
            "üçé –§—Ä—É–∫—Ç—ã": [
                "—è–±–ª–æ–∫–æ", "–≥—Ä—É—à–∞", "–±–∞–Ω–∞–Ω", "–∞–ø–µ–ª—å—Å–∏–Ω", "–º–∞–Ω–¥–∞—Ä–∏–Ω", "–≥—Ä–µ–π–ø—Ñ—Ä—É—Ç",
                "–ª–∏–º–æ–Ω", "–ª–∞–π–º", "–∫–∏–≤–∏", "–º–∞–Ω–≥–æ", "–∞–Ω–∞–Ω–∞—Å", "–ø–∞–ø–∞–π—è", "–º–∞—Ä–∞–∫—É–π—è",
                "–ø–µ—Ä—Å–∏–∫", "–Ω–µ–∫—Ç–∞—Ä–∏–Ω", "–∞–±—Ä–∏–∫–æ—Å", "—Å–ª–∏–≤–∞", "–≤–∏—à–Ω—è", "—á–µ—Ä–µ—à–Ω—è",
                "–≤–∏–Ω–æ–≥—Ä–∞–¥", "–≥—Ä–∞–Ω–∞—Ç", "—Ö—É—Ä–º–∞", "–∏–Ω–∂–∏—Ä", "–¥—ã–Ω—è", "–∞—Ä–±—É–∑",
                "–ø–æ–º–µ–ª–æ", "–∫—É–º–∫–≤–∞—Ç", "–ª–∏—á–∏", "–¥—Ä–∞–∫–æ–Ω–∏–π —Ñ—Ä—É–∫—Ç"
            ],
            "ü´ê –Ø–≥–æ–¥—ã": [
                "–∫–ª—É–±–Ω–∏–∫–∞", "–º–∞–ª–∏–Ω–∞", "—á–µ—Ä–Ω–∏–∫–∞", "–≥–æ–ª—É–±–∏–∫–∞", "–µ–∂–µ–≤–∏–∫–∞",
                "—Å–º–æ—Ä–æ–¥–∏–Ω–∞ —á—ë—Ä–Ω–∞—è", "—Å–º–æ—Ä–æ–¥–∏–Ω–∞ –∫—Ä–∞—Å–Ω–∞—è", "–∫—Ä—ã–∂–æ–≤–Ω–∏–∫", "–∫–ª—é–∫–≤–∞",
                "–±—Ä—É—Å–Ω–∏–∫–∞", "–æ–±–ª–µ–ø–∏—Ö–∞", "–∂–∏–º–æ–ª–æ—Å—Ç—å", "–º–æ—Ä–æ—à–∫–∞", "—à–∏–ø–æ–≤–Ω–∏–∫"
            ],
            "ü•ú –û—Ä–µ—Ö–∏ –∏ —Å–µ–º–µ–Ω–∞": [
                "–≥—Ä–µ—Ü–∫–∏–π –æ—Ä–µ—Ö", "–º–∏–Ω–¥–∞–ª—å", "—Ñ—É–Ω–¥—É–∫", "–∫–µ—à—å—é", "—Ñ–∏—Å—Ç–∞—à–∫–∏",
                "–∞—Ä–∞—Ö–∏—Å", "–∫–µ–¥—Ä–æ–≤—ã–µ –æ—Ä–µ—Ö–∏", "–º–∞–∫–∞–¥–∞–º–∏—è", "–ø–µ–∫–∞–Ω", "–±—Ä–∞–∑–∏–ª—å—Å–∫–∏–π –æ—Ä–µ—Ö",
                "—Å–µ–º–µ–Ω–∞ –ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–∏–∫–∞", "—Å–µ–º–µ–Ω–∞ —Ç—ã–∫–≤—ã", "—Å–µ–º–µ–Ω–∞ –ª—å–Ω–∞", "—Å–µ–º–µ–Ω–∞ —á–∏–∞",
                "–∫—É–Ω–∂—É—Ç", "–º–∞–∫", "–∫–æ–Ω–æ–ø–ª—è–Ω—ã–µ —Å–µ–º–µ–Ω–∞"
            ],
            "üçØ –°—É—Ö–æ—Ñ—Ä—É–∫—Ç—ã –∏ —Å–ª–∞–¥–æ—Å—Ç–∏": [
                "–∏–∑—é–º", "–∫—É—Ä–∞–≥–∞", "—á–µ—Ä–Ω–æ—Å–ª–∏–≤", "—Ñ–∏–Ω–∏–∫–∏", "–∏–Ω–∂–∏—Ä —Å—É—à—ë–Ω—ã–π",
                "—Å—É—à—ë–Ω–∞—è –∫–ª—é–∫–≤–∞", "—Å—É—à—ë–Ω–∞—è –≤–∏—à–Ω—è", "—Ü—É–∫–∞—Ç—ã", "–∫–æ–∫–æ—Å–æ–≤–∞—è —Å—Ç—Ä—É–∂–∫–∞",
                "–º—ë–¥", "–∫–ª–µ–Ω–æ–≤—ã–π —Å–∏—Ä–æ–ø", "—Å–∏—Ä–æ–ø –∞–≥–∞–≤—ã", "—Å—Ç–µ–≤–∏—è", "–≥–æ—Ä—å–∫–∏–π —à–æ–∫–æ–ª–∞–¥"
            ],
            "ü´í –ú–∞—Å–ª–∞ –∏ —Å–æ—É—Å—ã": [
                "–æ–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ", "–ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–æ–µ –º–∞—Å–ª–æ", "–∫–æ–∫–æ—Å–æ–≤–æ–µ –º–∞—Å–ª–æ",
                "–ª—å–Ω—è–Ω–æ–µ –º–∞—Å–ª–æ", "–∫—É–Ω–∂—É—Ç–Ω–æ–µ –º–∞—Å–ª–æ", "–º–∞—Å–ª–æ –≤–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã—Ö –∫–æ—Å—Ç–æ—á–µ–∫",
                "—Å–æ–µ–≤—ã–π —Å–æ—É—Å", "–±–∞–ª—å–∑–∞–º–∏—á–µ—Å–∫–∏–π —É–∫—Å—É—Å", "—è–±–ª–æ—á–Ω—ã–π —É–∫—Å—É—Å",
                "–≥–æ—Ä—á–∏—Ü–∞", "–º–∞–π–æ–Ω–µ–∑", "–∫–µ—Ç—á—É–ø", "—Ç–æ–º–∞—Ç–Ω–∞—è –ø–∞—Å—Ç–∞", "–∞–¥–∂–∏–∫–∞",
                "–ø–µ—Å—Ç–æ", "—Ç–∞—Ö–∏–Ω–∏", "—Ö—É–º—É—Å"
            ],
            "üßÄ –ü—Ä–æ—á–∏–µ –ø—Ä–æ–¥—É–∫—Ç—ã": [
                "—Ç–æ—Ñ—É", "—Ç–µ–º–ø–µ", "—Å–æ–µ–≤–æ–µ –º–æ–ª–æ–∫–æ", "–º–∏–Ω–¥–∞–ª—å–Ω–æ–µ –º–æ–ª–æ–∫–æ", "–æ–≤—Å—è–Ω–æ–µ –º–æ–ª–æ–∫–æ",
                "–∫–æ–∫–æ—Å–æ–≤–æ–µ –º–æ–ª–æ–∫–æ", "–∫–æ–∫–æ—Å–æ–≤—ã–µ —Å–ª–∏–≤–∫–∏", "–∞—Ä–∞—Ö–∏—Å–æ–≤–∞—è –ø–∞—Å—Ç–∞",
                "–º–∏–Ω–¥–∞–ª—å–Ω–∞—è –ø–∞—Å—Ç–∞", "–ø—Ä–æ—Ç–µ–∏–Ω–æ–≤—ã–π –ø–æ—Ä–æ—à–æ–∫", "–≥—Ä–∞–Ω–æ–ª–∞", "–º—é—Å–ª–∏",
                "–∂–µ–ª–∞—Ç–∏–Ω", "–∞–≥–∞—Ä-–∞–≥–∞—Ä", "–¥—Ä–æ–∂–∂–∏", "—Ä–∞–∑—Ä—ã—Ö–ª–∏—Ç–µ–ª—å", "–≤–∞–Ω–∏–ª–∏–Ω",
                "–∫–∞–∫–∞–æ –ø–æ—Ä–æ—à–æ–∫", "–∫–æ–∫–æ—Å–æ–≤–æ–µ –º–∞—Å–ª–æ", "–º–∞—Å–ª–∏–Ω—ã", "–æ–ª–∏–≤–∫–∏", "–∫–∞–ø–µ—Ä—Å—ã",
                "–∫–æ—Ä–Ω–∏—à–æ–Ω—ã", "–∫–≤–∞—à–µ–Ω–∞—è –∫–∞–ø—É—Å—Ç–∞", "–∫–∏–º—á–∏"
            ],
            "üßÇ –°–ø–µ—Ü–∏–∏ –∏ –ø—Ä–∏–ø—Ä–∞–≤—ã": [
                "—Å–æ–ª—å", "–ø–µ—Ä–µ—Ü —á—ë—Ä–Ω—ã–π", "–ø–µ—Ä–µ—Ü –±–µ–ª—ã–π", "–ø–∞–ø—Ä–∏–∫–∞", "–∫—É—Ä–∫—É–º–∞",
                "–∫–∞—Ä—Ä–∏", "–∫–æ—Ä–∏–∞–Ω–¥—Ä", "–∑–∏—Ä–∞", "–∫–æ—Ä–∏—Ü–∞", "–∏–º–±–∏—Ä—å", "–º—É—Å–∫–∞—Ç–Ω—ã–π –æ—Ä–µ—Ö",
                "–≥–≤–æ–∑–¥–∏–∫–∞", "–±–∞–¥—å—è–Ω", "–∫–∞—Ä–¥–∞–º–æ–Ω", "—à–∞—Ñ—Ä–∞–Ω", "—Å—É–º–∞—Ö",
                "–ø—Ä–æ–≤–∞–Ω—Å–∫–∏–µ —Ç—Ä–∞–≤—ã", "–∏—Ç–∞–ª—å—è–Ω—Å–∫–∏–µ —Ç—Ä–∞–≤—ã", "—Ö–º–µ–ª–∏-—Å—É–Ω–µ–ª–∏"
            ],
            "ü´ó –ù–∞–ø–∏—Ç–∫–∏": [
                "–∑–µ–ª—ë–Ω—ã–π —á–∞–π", "—á—ë—Ä–Ω—ã–π —á–∞–π", "–∫–æ—Ñ–µ", "–∫–∞–∫–∞–æ", "—Ü–∏–∫–æ—Ä–∏–π",
                "–∫–æ–º–ø–æ—Ç", "–º–æ—Ä—Å", "–∫–∏—Å–µ–ª—å", "—Å–º—É–∑–∏", "—Å–≤–µ–∂–µ–≤—ã–∂–∞—Ç—ã–π —Å–æ–∫"
            ],
            "üçÑ –ì—Ä–∏–±—ã": [
                "—à–∞–º–ø–∏–Ω—å–æ–Ω—ã", "–≤–µ—à–µ–Ω–∫–∏", "–±–µ–ª—ã–µ –≥—Ä–∏–±—ã", "–ª–∏—Å–∏—á–∫–∏", "–æ–ø—è—Ç–∞",
                "—à–∏–∏—Ç–∞–∫–µ", "–ø–æ—Ä—Ç–æ–±–µ–ª–ª–æ", "–≥—Ä–∏–±—ã —Å—É—à—ë–Ω—ã–µ", "–≥—Ä–∏–±—ã –º–∞—Ä–∏–Ω–æ–≤–∞–Ω–Ω—ã–µ"
            ]
        };

        let selectedIngredients = [];
        let isIngredientsOpen = false;

        function initializeCategories() {
            const container = document.getElementById('categoriesContainer');
            container.innerHTML = '';

            for (const [category, ingredients] of Object.entries(ingredientCategories)) {
                const sortedIngredients = [...ingredients].sort((a, b) => a.localeCompare(b, 'ru'));
                
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'category-container';
                
                categoryDiv.innerHTML = `
                    <div class="category-header" onclick="toggleCategory(this)">
                        <span>${category} (${sortedIngredients.length})</span>
                        <span class="arrow">‚ñº</span>
                    </div>
                    <div class="category-tags">
                        ${sortedIngredients.map(ing => `
                            <span class="tag" onclick="toggleIngredient('${ing}', this)">${ing}</span>
                        `).join('')}
                    </div>
                `;
                
                container.appendChild(categoryDiv);
            }
        }

        function toggleCategory(header) {
            header.classList.toggle('open');
            header.nextElementSibling.classList.toggle('open');
        }

        function toggleIngredients() {
            const section = document.getElementById('ingredientsSection');
            isIngredientsOpen = !isIngredientsOpen;
            section.classList.toggle('open', isIngredientsOpen);
        }

        function toggleIngredient(ingredient, tagElement) {
            const index = selectedIngredients.indexOf(ingredient);
            if (index > -1) {
                selectedIngredients.splice(index, 1);
                tagElement.classList.remove('selected');
            } else {
                selectedIngredients.push(ingredient);
                tagElement.classList.add('selected');
            }
            updateSelectedTagsDisplay();
        }

        function addCustomIngredient() {
            const input = document.getElementById('customIngredient');
            const ingredient = input.value.trim().toLowerCase();
            
            if (ingredient && !selectedIngredients.includes(ingredient)) {
                selectedIngredients.push(ingredient);
                updateSelectedTagsDisplay();
                input.value = '';
            }
        }

        function handleIngredientKeypress(event) {
            if (event.key === 'Enter') {
                addCustomIngredient();
            }
        }

        function removeIngredient(ingredient) {
            const index = selectedIngredients.indexOf(ingredient);
            if (index > -1) {
                selectedIngredients.splice(index, 1);
                
                const tags = document.querySelectorAll('.tag:not(.tag-category)');
                tags.forEach(tag => {
                    if (tag.textContent === ingredient) {
                        tag.classList.remove('selected');
                    }
                });
                
                updateSelectedTagsDisplay();
            }
        }

        function clearAllIngredients() {
            selectedIngredients = [];
            const tags = document.querySelectorAll('.tag.selected');
            tags.forEach(tag => tag.classList.remove('selected'));
            updateSelectedTagsDisplay();
        }

        function updateSelectedTagsDisplay() {
            const container = document.getElementById('selectedTags');
            const clearBtn = document.getElementById('clearBtn');
            
            if (selectedIngredients.length === 0) {
                container.innerHTML = '<span class="empty-selection">–ü–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ –≤—ã–±—Ä–∞–Ω–æ...</span>';
                clearBtn.style.display = 'none';
                return;
            }
            
            clearBtn.style.display = 'block';
            container.innerHTML = selectedIngredients.map(ing => `
                <span class="selected-tag">
                    ${ing}
                    <span class="remove" onclick="removeIngredient('${ing}')">&times;</span>
                </span>
            `).join('');
        }

        function showLoading() {
            const result = document.getElementById('menuResult');
            result.innerHTML = `
                <div class="loading-container">
                    <div class="cooking-animation">üç≥</div>
                    <p class="loading-text">–®–µ—Ñ-–ø–æ–≤–∞—Ä –≥–æ—Ç–æ–≤–∏—Ç –≤–∞—à–µ –º–µ–Ω—é<span class="loading-dots"></span></p>
                </div>
            `;
        }

        async function generateMenu() {
            const targetCalories = document.getElementById('calorieTarget').value;
            const portions = document.getElementById('portions').value;
            const dietType = document.getElementById('dietType').value;
            
            const dietTypeNames = {
                'balanced': '—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ',
                'protein': '–≤—ã—Å–æ–∫–æ–±–µ–ª–∫–æ–≤–æ–µ',
                'lowcarb': '–Ω–∏–∑–∫–æ—É–≥–ª–µ–≤–æ–¥–Ω–æ–µ',
                'vegetarian': '–≤–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω—Å–∫–æ–µ',
                'vegan': '–≤–µ–≥–∞–Ω—Å–∫–æ–µ'
            };

            const ingredientsText = selectedIngredients.length > 0 
                ? `–ò—Å–ø–æ–ª—å–∑—É–π –¢–û–õ–¨–ö–û —ç—Ç–∏ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã: ${selectedIngredients.join(', ')}.`
                : '–ò—Å–ø–æ–ª—å–∑—É–π –ª—é–±—ã–µ –ø–æ–ª–µ–∑–Ω—ã–µ –∏ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã.';

            showLoading();

            const prompt = `–¢—ã –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –¥–∏–µ—Ç–æ–ª–æ–≥ –∏ —à–µ—Ñ-–ø–æ–≤–∞—Ä. –°–æ—Å—Ç–∞–≤—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –º–µ–Ω—é –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è –Ω–∞ –û–î–ò–ù –¥–µ–Ω—å.

–ü–ê–†–ê–ú–ï–¢–†–´:
- –¶–µ–ª–µ–≤–∞—è –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å: ${targetCalories} –∫–∫–∞–ª –Ω–∞ –¥–µ–Ω—å
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ä—Ü–∏–π: ${portions}
- –¢–∏–ø –ø–∏—Ç–∞–Ω–∏—è: ${dietTypeNames[dietType]}
${ingredientsText}

–¢–†–ï–ë–û–í–ê–ù–ò–Ø –ö –ú–ï–ù–Æ:
1. –ú–µ–Ω—é –¥–æ–ª–∂–Ω–æ –≤–∫–ª—é—á–∞—Ç—å 5 –ø—Ä–∏—ë–º–æ–≤ –ø–∏—â–∏: –ó–∞–≤—Ç—Ä–∞–∫, –ü–µ—Ä–µ–∫—É—Å (—É—Ç—Ä–µ–Ω–Ω–∏–π), –û–±–µ–¥, –ü–æ–ª–¥–Ω–∏–∫, –£–∂–∏–Ω
2. –û–±—â–∞—è –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å –≤—Å–µ—Ö –±–ª—é–¥ –¥–æ–ª–∂–Ω–∞ —Å–æ—Å—Ç–∞–≤–ª—è—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ ${targetCalories} –∫–∫–∞–ª
3. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞–ª–æ—Ä–∏–π: –ó–∞–≤—Ç—Ä–∞–∫ ~25%, –ü–µ—Ä–µ–∫—É—Å ~10%, –û–±–µ–¥ ~35%, –ü–æ–ª–¥–Ω–∏–∫ ~10%, –£–∂–∏–Ω ~20%
4. –ë–ª—é–¥–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–∫—É—Å–Ω—ã–º–∏, –ø–æ–ª–µ–∑–Ω—ã–º–∏ –∏ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º–∏ –¥–ª—è –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –¥–æ–º–∞

–î–õ–Ø –ö–ê–ñ–î–û–ì–û –ü–†–ò–Å–ú–ê –ü–ò–©–ò –£–ö–ê–ñ–ò:
- –ù–∞–∑–≤–∞–Ω–∏–µ –±–ª—é–¥–∞
- –°–ø–∏—Å–æ–∫ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ —Å –≥—Ä–∞–º–º–æ–≤–∫–æ–π (—É—á–∏—Ç—ã–≤–∞—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ä—Ü–∏–π: ${portions})
- –ö–∞–ª–æ—Ä–∏–∏, –±–µ–ª–∫–∏, –∂–∏—Ä—ã, —É–≥–ª–µ–≤–æ–¥—ã
- –ö—Ä–∞—Ç–∫–∏–π –ø–æ—à–∞–≥–æ–≤—ã–π —Ä–µ—Ü–µ–ø—Ç –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è

–í –ö–û–ù–¶–ï –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–∫–∞–∂–∏ –ò–¢–û–ì–û –∑–∞ –¥–µ–Ω—å: –æ–±—â–∏–µ –∫–∞–ª–æ—Ä–∏–∏, –±–µ–ª–∫–∏, –∂–∏—Ä—ã, —É–≥–ª–µ–≤–æ–¥—ã.

–û—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ, —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ. –ò—Å–ø–æ–ª—å–∑—É–π —ç–º–æ–¥–∑–∏ –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è.`;

            try {
                const response = await fetch(`${MAPRUAPP_PROXY_BASE_URL}/ai/api/v1/chat/completions`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        model: "gemini-2.5-flash-lite",
                        messages: [{ role: "user", content: prompt }],
                        max_tokens: 8192
                    })
                });

                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data?.error?.message || `–û—à–∏–±–∫–∞ ${response.status}`);
                }

                const aiText = data.choices?.[0]?.message?.content || '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç';
                displayMenu(aiText);

            } catch (error) {
                displayError(error.message);
            }
        }

        async function generateRandomMenu() {
            const targetCalories = document.getElementById('calorieTarget').value;
            const portions = document.getElementById('portions').value;
            const dietType = document.getElementById('dietType').value;
            
            const dietTypeNames = {
                'balanced': '—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ',
                'protein': '–≤—ã—Å–æ–∫–æ–±–µ–ª–∫–æ–≤–æ–µ',
                'lowcarb': '–Ω–∏–∑–∫–æ—É–≥–ª–µ–≤–æ–¥–Ω–æ–µ',
                'vegetarian': '–≤–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω—Å–∫–æ–µ',
                'vegan': '–≤–µ–≥–∞–Ω—Å–∫–æ–µ'
            };

            showLoading();

            const prompt = `–¢—ã –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–π —à–µ—Ñ-–ø–æ–≤–∞—Ä –∏ –¥–∏–µ—Ç–æ–ª–æ–≥. –ü—Ä–∏–¥—É–º–∞–π –û–†–ò–ì–ò–ù–ê–õ–¨–ù–û–ï –∏ –ò–ù–¢–ï–†–ï–°–ù–û–ï –º–µ–Ω—é –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è –Ω–∞ –¥–µ–Ω—å.

–ü–ê–†–ê–ú–ï–¢–†–´:
- –¶–µ–ª–µ–≤–∞—è –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å: ${targetCalories} –∫–∫–∞–ª
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ä—Ü–∏–π: ${portions}
- –¢–∏–ø –ø–∏—Ç–∞–Ω–∏—è: ${dietTypeNames[dietType]}

–í–ê–ñ–ù–û: –ü—Ä–µ–¥–ª–æ–∂–∏ –Ω–µ–æ–±—ã—á–Ω—ã–µ, –Ω–æ –ø–æ–ª–µ–∑–Ω—ã–µ –±–ª—é–¥–∞. –£–¥–∏–≤–∏! –ú–æ–∂–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–ª—é–¥–∞ —Ä–∞–∑–Ω—ã—Ö –∫—É—Ö–æ–Ω—å –º–∏—Ä–∞.

–ú–µ–Ω—é –¥–æ–ª–∂–Ω–æ –≤–∫–ª—é—á–∞—Ç—å: –ó–∞–≤—Ç—Ä–∞–∫, –ü–µ—Ä–µ–∫—É—Å, –û–±–µ–¥, –ü–æ–ª–¥–Ω–∏–∫, –£–∂–∏–Ω.

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª—é–¥–∞ —É–∫–∞–∂–∏:
- –ù–∞–∑–≤–∞–Ω–∏–µ (–∫—Ä–µ–∞—Ç–∏–≤–Ω–æ–µ!)
- –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã —Å –≥—Ä–∞–º–º–æ–≤–∫–æ–π –Ω–∞ ${portions} –ø–æ—Ä—Ü–∏–π
- –ö–ë–ñ–£ (–∫–∞–ª–æ—Ä–∏–∏, –±–µ–ª–∫–∏, –∂–∏—Ä—ã, —É–≥–ª–µ–≤–æ–¥—ã)
- –ü–æ—à–∞–≥–æ–≤—ã–π —Ä–µ—Ü–µ–ø—Ç

–í –∫–æ–Ω—Ü–µ - –ò–¢–û–ì–û –∑–∞ –¥–µ–Ω—å —Å —Å—É–º–º–æ–π –ö–ë–ñ–£.

–û—Ñ–æ—Ä–º–∏ –∫—Ä–∞—Å–∏–≤–æ —Å —ç–º–æ–¥–∑–∏. –û—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º.`;

            try {
                const response = await fetch(`${MAPRUAPP_PROXY_BASE_URL}/ai/api/v1/chat/completions`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        model: "gemini-2.5-flash-lite",
                        messages: [{ role: "user", content: prompt }],
                        max_tokens: 8192
                    })
                });

                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data?.error?.message || `–û—à–∏–±–∫–∞ ${response.status}`);
                }

                const aiText = data.choices?.[0]?.message?.content || '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç';
                displayMenu(aiText);

            } catch (error) {
                displayError(error.message);
            }
        }

        function displayMenu(text) {
            const result = document.getElementById('menuResult');
            
            let formattedText = text
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                .replace(/^### (.*$)/gm, '<h4 style="color: #e65100; margin: 15px 0 10px;">$1</h4>')
                .replace(/^## (.*$)/gm, '<h3 style="color: #d84315; margin: 20px 0 15px;">$1</h3>')
                .replace(/^# (.*$)/gm, '<h2 style="color: #bf360c; margin: 25px 0 15px;">$1</h2>')
                .replace(/^[\-\‚Ä¢] (.*$)/gm, '<li style="margin-left: 20px;">$1</li>')
                .replace(/\n/g, '<br>');

            result.innerHTML = `
                <h2>üë®‚Äçüç≥ –í–∞—à–µ –º–µ–Ω—é –Ω–∞ –¥–µ–Ω—å</h2>
                <div class="menu-content">${formattedText}</div>
            `;
        }

        function displayError(message) {
            const result = document.getElementById('menuResult');
            result.innerHTML = `
                <div class="placeholder-message">
                    <div class="icon">üòî</div>
                    <h3>–£–ø—Å! –ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫</h3>
                    <p style="color: #e57373;">${message}</p>
                    <p style="margin-top: 15px;">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑ —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥</p>
                </div>
            `;
        }

        initializeCategories();
    </script>
</body>
</html>