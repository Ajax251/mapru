<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û–±–µ–∑–ª–∏—á–∏–≤–∞–Ω–∏–µ –≤—ã–ø–∏—Å–æ–∫ –ï–ì–†–ù</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üîí</text></svg>">
    <style>
        :root {
            --primary: #0EA5E9;
            --primary-light: #38BDF8;
            --primary-dark: #0284C7;
            --primary-bg: #F0F9FF;
            --primary-bg-hover: #E0F2FE;
            --bg-gradient-start: #F8FAFC;
            --bg-gradient-end: #E0F2FE;
            --card-bg: #FFFFFF;
            --text-main: #0C4A6E;
            --text-secondary: #64748B;
            --text-muted: #94A3B8;
            --border: #BAE6FD;
            --border-light: #E0F2FE;
            --success-bg: #DCFCE7;
            --success-text: #166534;
            --error: #EF4444;
            --error-bg: #FEE2E2;
            --shadow-lg: 0 10px 40px -10px rgba(14, 165, 233, 0.15), 0 4px 20px -5px rgba(0, 0, 0, 0.08);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html, body { height: 100%; overflow: hidden; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: linear-gradient(145deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
            color: var(--text-main);
            display: flex; align-items: center; justify-content: center; padding: 24px;
        }

        .container { width: 100%; max-width: 580px; }
        .card { background: var(--card-bg); border-radius: 24px; box-shadow: var(--shadow-lg); padding: 40px; border: 1px solid var(--border-light); }
        .card-header { text-align: center; margin-bottom: 32px; }
        .header-icon {
            width: 72px; height: 72px; background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            border-radius: 20px; display: inline-flex; align-items: center; justify-content: center; margin-bottom: 20px;
            box-shadow: 0 8px 24px -4px rgba(14, 165, 233, 0.4);
        }
        .header-icon svg { width: 36px; height: 36px; color: white; }
        .card-header h1 { font-size: 28px; font-weight: 700; margin: 0 0 10px 0; color: var(--text-main); }
        .card-header p { color: var(--text-secondary); font-size: 16px; }

        .upload-zone {
            border: 2px dashed var(--border); border-radius: 16px; padding: 36px 28px; text-align: center; cursor: pointer;
            transition: all 0.25s ease; position: relative; background: var(--primary-bg);
        }
        .upload-zone:hover, .upload-zone.dragover { border-color: var(--primary); background: var(--primary-bg-hover); transform: translateY(-2px); box-shadow: 0 8px 24px -8px rgba(14, 165, 233, 0.25); }
        .upload-zone input[type="file"] { position: absolute; width: 100%; height: 100%; top: 0; left: 0; opacity: 0; cursor: pointer; }
        .upload-icon {
            width: 64px; height: 64px; background: white; border-radius: 16px; display: inline-flex; align-items: center; justify-content: center;
            margin-bottom: 16px; box-shadow: 0 4px 12px rgba(14, 165, 233, 0.15);
        }
        .upload-icon svg { width: 32px; height: 32px; color: var(--primary); }
        .upload-text { font-size: 18px; font-weight: 600; color: var(--text-main); margin-bottom: 6px; }
        .upload-subtext { font-size: 14px; color: var(--text-secondary); }
        .upload-subtext span { color: var(--primary); font-weight: 600; }

        .file-info { display: none; margin-top: 16px; padding: 14px 18px; background: var(--success-bg); border-radius: 12px; color: var(--success-text); font-weight: 500; font-size: 15px; align-items: center; gap: 12px; }
        .file-info.visible { display: flex; }
        .file-info svg { width: 22px; height: 22px; flex-shrink: 0; }
        .file-info span { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

        .settings { margin-top: 28px; padding-top: 28px; border-top: 1px solid var(--border-light); }
        .settings-title { display: flex; align-items: center; gap: 8px; font-size: 13px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 16px; }
        .settings-title svg { width: 16px; height: 16px; }

        .checkbox-row {
            display: flex; align-items: center; padding: 14px 16px; margin-bottom: 10px; border-radius: 12px; cursor: pointer;
            transition: all 0.2s; background: var(--primary-bg); border: 1px solid transparent;
        }
        .checkbox-row:hover { background: var(--primary-bg-hover); border-color: var(--border); }
        .checkbox-row:last-child { margin-bottom: 0; }
        .checkbox-row input { width: 20px; height: 20px; margin-right: 14px; accent-color: var(--primary); cursor: pointer; flex-shrink: 0; }
        
        .checkbox-icon {
            width: 36px; height: 36px; background: white; border-radius: 10px; display: flex; align-items: center; justify-content: center;
            margin-right: 14px; box-shadow: 0 2px 8px rgba(14, 165, 233, 0.1);
        }
        .checkbox-icon svg { width: 18px; height: 18px; color: var(--primary); }
        
        .checkbox-label .label-main { font-size: 16px; font-weight: 500; color: var(--text-main); }
        .checkbox-label .label-hint { font-size: 13px; color: var(--text-secondary); margin-top: 2px; }

        .btn-process {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%); color: white; border: none; width: 100%;
            padding: 18px; border-radius: 14px; font-size: 17px; font-weight: 600; cursor: pointer; margin-top: 28px; transition: all 0.25s ease;
            display: flex; justify-content: center; align-items: center; box-shadow: 0 8px 24px -4px rgba(14, 165, 233, 0.4);
        }
        .btn-process:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 12px 32px -4px rgba(14, 165, 233, 0.5); }
        .btn-process:disabled { background: #E2E8F0; color: var(--text-muted); cursor: not-allowed; box-shadow: none; }
        .spinner { width: 20px; height: 20px; border: 2px solid rgba(255,255,255,0.3); border-radius: 50%; border-top-color: white; animation: spin 0.8s linear infinite; margin-right: 10px; display: none; }
        @keyframes spin { to { transform: rotate(360deg); } }

        .error-message { color: var(--error); font-size: 14px; text-align: center; margin-top: 16px; display: none; padding: 14px; background: var(--error-bg); border-radius: 12px; }
        .error-message.visible { display: block; }
        .legal-footer { margin-top: 24px; padding-top: 24px; border-top: 1px solid var(--border-light); }
        .legal-title { display: flex; align-items: center; gap: 8px; font-size: 13px; font-weight: 600; color: var(--text-main); margin-bottom: 10px; }
        .legal-title svg { width: 16px; height: 16px; color: var(--primary); }
        .legal-text { font-size: 13px; color: var(--text-secondary); line-height: 1.7; }

        @media (max-height: 800px) {
            .card { padding: 28px; } .card-header { margin-bottom: 24px; } .header-icon { width: 60px; height: 60px; margin-bottom: 16px; }
            .header-icon svg { width: 30px; height: 30px; } .card-header h1 { font-size: 24px; }
            .upload-zone { padding: 28px 24px; } .settings { margin-top: 20px; padding-top: 20px; }
            .btn-process { margin-top: 20px; padding: 16px; } .legal-footer { margin-top: 18px; padding-top: 18px; }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="card">
        <div class="card-header">
            <div class="header-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                    <path d="M9 12l2 2 4-4"/>
                </svg>
            </div>
            <h1>–û–±–µ–∑–ª–∏—á–∏–≤–∞–Ω–∏–µ –≤—ã–ø–∏—Å–æ–∫ –ï–ì–†–ù</h1>
            <p>–°–∫—Ä–æ–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–¥–∞—á–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞</p>
        </div>

        <div class="upload-zone" id="dropZone">
            <input type="file" id="fileInput" accept="application/pdf">
            <div class="upload-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                    <polyline points="14 2 14 8 20 8"/>
                    <line x1="12" y1="18" x2="12" y2="12"/>
                    <line x1="9" y1="15" x2="15" y2="15"/>
                </svg>
            </div>
            <div class="upload-text">–ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤—ã–ø–∏—Å–∫—É –ï–ì–†–ù</div>
            <div class="upload-subtext">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª —Å—é–¥–∞ –∏–ª–∏ <span>–≤—ã–±–µ—Ä–∏—Ç–µ</span> ¬∑ PDF –¥–æ 4.5 –ú–ë</div>
        </div>

        <div class="file-info" id="fileName">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                <polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
            <span></span>
        </div>

        <div class="settings">
            <div class="settings-title">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="3"/>
                    <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                </svg>
                –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±–µ–∑–ª–∏—á–∏–≤–∞–Ω–∏—è
            </div>
            
            <label class="checkbox-row">
                <input type="checkbox" id="checkKuvi" checked>
                <div class="checkbox-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                        <polyline points="22,6 12,13 2,6"/>
                    </svg>
                </div>
                <div class="checkbox-label">
                    <div class="label-main">–°–∫—Ä—ã—Ç—å –Ω–æ–º–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞</div>
                    <div class="label-hint">–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤—ã–ø–∏—Å–∫–∏ (‚Ññ –ö–£–í–ò)</div>
                </div>
            </label>
            
            <label class="checkbox-row">
                <input type="checkbox" id="checkFio" checked>
                <div class="checkbox-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                        <circle cx="12" cy="7" r="4"/>
                    </svg>
                </div>
                <div class="checkbox-label">
                    <div class="label-main">–°–∫—Ä—ã—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è</div>
                    <div class="label-hint">–§–ò–û –ª–∏—Ü–∞, –∑–∞–ø—Ä–æ—Å–∏–≤—à–µ–≥–æ –≤—ã–ø–∏—Å–∫—É</div>
                </div>
            </label>

            <label class="checkbox-row">
                <input type="checkbox" id="checkEds" checked>
                <div class="checkbox-icon">
                    <!-- –ò–∫–æ–Ω–∫–∞ "–ü–µ—Ä–æ" -->
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 19l7-7 3 3-7 7-3-3z"/>
                        <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/>
                        <path d="M2 2l7.586 7.586"/>
                        <circle cx="11" cy="11" r="2"/>
                    </svg>
                </div>
                <div class="checkbox-label">
                    <div class="label-main">–û—á–∏—Å—Ç–∏—Ç—å —à—Ç–∞–º–ø –≠–¶–ü</div>
                    <div class="label-hint">–£–¥–∞–ª–∏—Ç —Ç–µ–∫—Å—Ç –∏ –≥–µ—Ä–±, —Å–æ—Ö—Ä–∞–Ω–∏–≤ —Å–∏–Ω—é—é —Ä–∞–º–∫—É</div>
                </div>
            </label>
        </div>

        <button class="btn-process" id="processBtn" disabled>
            <div class="spinner" id="loader"></div>
            <span id="btnText">–û–±–µ–∑–ª–∏—á–∏—Ç—å –∏ —Å–∫–∞—á–∞—Ç—å</span>
        </button>

        <div class="error-message" id="errorMsg"></div>

        <div class="legal-footer">
            <div class="legal-title">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="12" y1="16" x2="12" y2="12"/>
                    <line x1="12" y1="8" x2="12.01" y2="8"/>
                </svg>
                –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            </div>
            <div class="legal-text">
                –î–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∑–∞—â–∏—Ç—ã –¥–∞–Ω–Ω—ã—Ö (–∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏–∏) –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–¥–∞—á–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º –≤ –æ–∑–Ω–∞–∫–æ–º–∏—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª—è—Ö. –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —é—Ä–∏–¥–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã–º –æ—Ä–∏–≥–∏–Ω–∞–ª–æ–º. –§–∞–π–ª—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ –∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è.
            </div>
        </div>
    </div>
</div>

<script>
    const API_URL = 'https://vypcls.vercel.app/api/process'; // –ò–ª–∏ –≤–∞—à –ª–æ–∫–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å

    const fileInput = document.getElementById('fileInput');
    const fileNameDisplay = document.getElementById('fileName');
    const fileNameText = fileNameDisplay.querySelector('span');
    const processBtn = document.getElementById('processBtn');
    const dropZone = document.getElementById('dropZone');
    const loader = document.getElementById('loader');
    const btnText = document.getElementById('btnText');
    const errorMsg = document.getElementById('errorMsg');

    ['dragenter', 'dragover'].forEach(event => {
        dropZone.addEventListener(event, (e) => {
            e.preventDefault();
            dropZone.classList.add('dragover');
        });
    });

    ['dragleave', 'drop'].forEach(event => {
        dropZone.addEventListener(event, (e) => {
            e.preventDefault();
            dropZone.classList.remove('dragover');
        });
    });

    dropZone.addEventListener('drop', (e) => {
        if (e.dataTransfer.files.length) {
            fileInput.files = e.dataTransfer.files;
            handleFileSelect();
        }
    });

    fileInput.addEventListener('change', handleFileSelect);

    function handleFileSelect() {
        errorMsg.classList.remove('visible');
        if (fileInput.files.length > 0) {
            const file = fileInput.files[0];
            if (file.type !== 'application/pdf') {
                showError('–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –≤ —Ñ–æ—Ä–º–∞—Ç–µ PDF');
                resetFileInput();
                return;
            }
            if (file.size > 4.5 * 1024 * 1024) {
                showError('–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π (–º–∞–∫—Å–∏–º—É–º 4.5 –ú–ë)');
                resetFileInput();
                return;
            }
            fileNameText.textContent = file.name;
            fileNameDisplay.classList.add('visible');
            processBtn.disabled = false;
        }
    }

    function showError(message) {
        errorMsg.textContent = message;
        errorMsg.classList.add('visible');
    }

    function resetFileInput() {
        fileInput.value = '';
        fileNameDisplay.classList.remove('visible');
        processBtn.disabled = true;
    }

    processBtn.addEventListener('click', async () => {
        const file = fileInput.files[0];
        if (!file) return;

        processBtn.disabled = true;
        loader.style.display = 'inline-block';
        btnText.textContent = '–û–±—Ä–∞–±–æ—Ç–∫–∞...';
        errorMsg.classList.remove('visible');

        const formData = new FormData();
        formData.append('file', file);
        formData.append('delete_kuvi', document.getElementById('checkKuvi').checked);
        formData.append('delete_fio', document.getElementById('checkFio').checked);
        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä
        formData.append('delete_eds', document.getElementById('checkEds').checked);

        try {
            const response = await fetch(API_URL, {
                method: 'POST',
                body: formData
            });

            if (!response.ok) {
                const errData = await response.json().catch(() => ({}));
                throw new Error(errData.error || '–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–∞');
            }

            const blob = await response.blob();
            const downloadUrl = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = downloadUrl;
            a.download = file.name.replace('.pdf', '') + '_–æ–±–µ–∑–ª–∏—á–µ–Ω–æ.pdf';
            document.body.appendChild(a);
            a.click();
            a.remove();
            window.URL.revokeObjectURL(downloadUrl);

            btnText.textContent = '–ì–æ—Ç–æ–≤–æ!';
            setTimeout(() => { btnText.textContent = '–û–±–µ–∑–ª–∏—á–∏—Ç—å –∏ —Å–∫–∞—á–∞—Ç—å'; }, 2000);

        } catch (err) {
            showError(err.message);
        } finally {
            processBtn.disabled = false;
            loader.style.display = 'none';
            if (btnText.textContent === '–û–±—Ä–∞–±–æ—Ç–∫–∞...') {
                btnText.textContent = '–û–±–µ–∑–ª–∏—á–∏—Ç—å –∏ —Å–∫–∞—á–∞—Ç—å';
            }
        }
    });
</script>

</body>
</html>