<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ассистент</title>
    <link id="favicon" rel="icon" href="https://vsemap.ru/favicon.svg" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            /* Light theme */
            --bg-base: #f3f3f3;
            --bg-layer: rgba(255, 255, 255, 0.7);
            --bg-card: rgba(255, 255, 255, 0.8);
            --bg-card-hover: rgba(255, 255, 255, 0.9);
            --bg-subtle: rgba(0, 0, 0, 0.03);
            --bg-subtle-hover: rgba(0, 0, 0, 0.06);
            --border-color: rgba(0, 0, 0, 0.08);
            --border-color-strong: rgba(0, 0, 0, 0.12);
            --text-primary: #1a1a1a;
            --text-secondary: #616161;
            --text-tertiary: #8a8a8a;
            --accent: #0078d4;
            --accent-hover: #106ebe;
            --accent-light: rgba(0, 120, 212, 0.1);
            --shadow-card: 0 2px 8px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.06);
            --shadow-dropdown: 0 8px 32px rgba(0, 0, 0, 0.12);
            --mica-opacity: 0.85;
        }

        [data-theme="dark"] {
            --bg-base: #202020;
            --bg-layer: rgba(45, 45, 45, 0.8);
            --bg-card: rgba(50, 50, 50, 0.8);
            --bg-card-hover: rgba(60, 60, 60, 0.9);
            --bg-subtle: rgba(255, 255, 255, 0.05);
            --bg-subtle-hover: rgba(255, 255, 255, 0.08);
            --border-color: rgba(255, 255, 255, 0.08);
            --border-color-strong: rgba(255, 255, 255, 0.12);
            --text-primary: #ffffff;
            --text-secondary: #ababab;
            --text-tertiary: #767676;
            --accent: #60cdff;
            --accent-hover: #4cc2ff;
            --accent-light: rgba(96, 205, 255, 0.15);
            --shadow-card: 0 2px 8px rgba(0, 0, 0, 0.2);
            --shadow-dropdown: 0 8px 32px rgba(0, 0, 0, 0.32);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI Variable', 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: var(--bg-base);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* Background with Mica effect */
        .mica-background {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: -1;
            background-size: cover;
            background-position: center;
            filter: blur(80px) saturate(1.2);
            opacity: var(--mica-opacity);
            transform: scale(1.2);
        }

        /* Main layout */
        .app-container {
            display: flex;
            min-height: 100vh;
        }

        /* Navigation Panel */
        .nav-panel {
            width: 280px;
            background: var(--bg-layer);
            backdrop-filter: blur(20px);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            padding: 12px;
            transition: width 0.3s ease, transform 0.3s ease;
            position: relative;
            z-index: 100;
        }

        .nav-panel.collapsed {
            width: 60px;
        }

        .nav-header {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            margin-bottom: 8px;
        }

        .nav-logo {
            width: 32px;
            height: 32px;
            background: var(--accent);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            flex-shrink: 0;
        }

        .nav-title {
            margin-left: 12px;
            font-size: 16px;
            font-weight: 600;
            white-space: nowrap;
            overflow: hidden;
            opacity: 1;
            transition: opacity 0.2s ease;
        }

        .nav-panel.collapsed .nav-title {
            opacity: 0;
        }

        .nav-toggle {
            position: absolute;
            right: -16px;
            top: 20px;
            width: 32px;
            height: 32px;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--text-secondary);
            box-shadow: var(--shadow-card);
        }

        .nav-toggle:hover {
            background: var(--bg-card-hover);
            color: var(--text-primary);
        }

        .nav-section {
            margin-top: 8px;
        }

        .nav-section-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-tertiary);
            padding: 8px 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            white-space: nowrap;
            overflow: hidden;
        }

        .nav-panel.collapsed .nav-section-title {
            opacity: 0;
            height: 0;
            padding: 0;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 10px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.15s ease;
            color: var(--text-primary);
            text-decoration: none;
            position: relative;
            margin: 2px 0;
        }

        .nav-item:hover {
            background: var(--bg-subtle-hover);
        }

        .nav-item.active {
            background: var(--accent-light);
        }

        .nav-item.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 3px;
            height: 16px;
            background: var(--accent);
            border-radius: 2px;
        }

        .nav-item i {
            width: 20px;
            font-size: 16px;
            color: var(--text-secondary);
            flex-shrink: 0;
            text-align: center;
        }

        .nav-item.active i {
            color: var(--accent);
        }

        .nav-item span {
            margin-left: 12px;
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            opacity: 1;
            transition: opacity 0.2s ease;
        }

        .nav-panel.collapsed .nav-item span {
            opacity: 0;
        }

        .nav-spacer {
            flex: 1;
        }

        .nav-footer {
            border-top: 1px solid var(--border-color);
            padding-top: 8px;
            margin-top: 8px;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 24px 32px;
            overflow-y: auto;
            max-height: 100vh;
        }

        .content-header {
            margin-bottom: 24px;
        }

        .content-title {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .content-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* Search Box */
        .search-container {
            margin-bottom: 24px;
        }

        .search-box {
            display: flex;
            align-items: center;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 0 16px;
            transition: all 0.2s ease;
            box-shadow: var(--shadow-card);
        }

        .search-box:focus-within {
            border-color: var(--accent);
            box-shadow: 0 0 0 2px var(--accent-light);
        }

        .search-box i {
            color: var(--text-tertiary);
            font-size: 16px;
        }

        .search-box input {
            flex: 1;
            padding: 14px 12px;
            border: none;
            background: transparent;
            font-size: 15px;
            color: var(--text-primary);
            outline: none;
            font-family: inherit;
        }

        .search-box input::placeholder {
            color: var(--text-tertiary);
        }

        .search-hint {
            font-size: 12px;
            color: var(--text-tertiary);
            margin-top: 8px;
            padding-left: 4px;
        }

        /* Button Grid */
        .button-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 12px;
            margin-bottom: 24px;
        }

        .action-button {
            display: flex;
            align-items: center;
            padding: 14px 16px;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.15s ease;
            text-decoration: none;
            color: var(--text-primary);
            box-shadow: var(--shadow-card);
        }

        .action-button:hover {
            background: var(--bg-card-hover);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .action-button:active {
            transform: scale(0.98);
        }

        .action-button img {
            width: 24px;
            height: 24px;
            border-radius: 4px;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .action-button i {
            width: 24px;
            font-size: 18px;
            margin-right: 12px;
            flex-shrink: 0;
            text-align: center;
        }

        .action-button span {
            font-size: 14px;
            font-weight: 500;
        }

        /* Accent buttons */
        .action-button.accent {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
        }

        .action-button.accent:hover {
            background: var(--accent-hover);
            border-color: var(--accent-hover);
        }

        .action-button.accent i {
            color: white;
        }

        /* Button colors */
        .action-button[data-color="blue"] i { color: #0078d4; }
        .action-button[data-color="red"] i { color: #e81123; }
        .action-button[data-color="green"] i { color: #107c10; }
        .action-button[data-color="orange"] i { color: #ff8c00; }
        .action-button[data-color="purple"] i { color: #881798; }
        .action-button[data-color="teal"] i { color: #00b7c3; }

        /* Mode Tabs */
        .mode-tabs {
            display: flex;
            gap: 4px;
            background: var(--bg-subtle);
            padding: 4px;
            border-radius: 8px;
            margin-bottom: 20px;
            width: fit-content;
        }

        .mode-tab {
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.15s ease;
            color: var(--text-secondary);
            border: none;
            background: transparent;
        }

        .mode-tab:hover {
            color: var(--text-primary);
            background: var(--bg-subtle-hover);
        }

        .mode-tab.active {
            background: var(--bg-card);
            color: var(--text-primary);
            box-shadow: var(--shadow-card);
        }

        /* Cards */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: var(--shadow-card);
        }

        .card-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 12px;
        }

        /* Dropdown Menu */
        .dropdown-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 999;
            display: none;
        }

        .dropdown-overlay.show {
            display: block;
        }

        .dropdown-menu {
            position: absolute;
            background: var(--bg-layer);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 6px;
            min-width: 220px;
            box-shadow: var(--shadow-dropdown);
            z-index: 1000;
            opacity: 0;
            transform: translateY(-8px);
            pointer-events: none;
            transition: all 0.15s ease;
        }

        .dropdown-menu.show {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            padding: 10px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.1s ease;
            color: var(--text-primary);
            text-decoration: none;
            font-size: 14px;
        }

        .dropdown-item:hover {
            background: var(--bg-subtle-hover);
        }

        .dropdown-item i {
            width: 20px;
            margin-right: 12px;
            color: var(--text-secondary);
            font-size: 14px;
            text-align: center;
        }

        .dropdown-separator {
            height: 1px;
            background: var(--border-color);
            margin: 6px 0;
        }

        .dropdown-submenu {
            position: relative;
        }

        .dropdown-submenu > .dropdown-item::after {
            content: '\f054';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            font-size: 10px;
            margin-left: auto;
            color: var(--text-tertiary);
        }

        .dropdown-submenu-content {
            position: absolute;
            left: 100%;
            top: 0;
            margin-left: 4px;
            background: var(--bg-layer);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 6px;
            min-width: 200px;
            box-shadow: var(--shadow-dropdown);
            opacity: 0;
            transform: translateX(-8px);
            pointer-events: none;
            transition: all 0.15s ease;
        }

        .dropdown-submenu:hover > .dropdown-submenu-content {
            opacity: 1;
            transform: translateX(0);
            pointer-events: auto;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s ease;
        }

        .modal-overlay.show {
            opacity: 1;
            pointer-events: auto;
        }

        .modal-content {
            background: var(--bg-layer);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 24px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--shadow-dropdown);
            transform: scale(0.95);
            transition: transform 0.2s ease;
        }

        .modal-overlay.show .modal-content {
            transform: scale(1);
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-list {
            list-style: none;
            margin-bottom: 20px;
        }

        .modal-list li a {
            display: flex;
            align-items: center;
            padding: 12px;
            border-radius: 8px;
            text-decoration: none;
            color: var(--text-primary);
            transition: background 0.15s ease;
        }

        .modal-list li a:hover {
            background: var(--bg-subtle-hover);
        }

        .modal-list li img {
            width: 24px;
            height: 24px;
            margin-right: 12px;
            border-radius: 4px;
        }

        .modal-footer {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
            padding-top: 16px;
            border-top: 1px solid var(--border-color);
        }

        .btn {
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.15s ease;
            border: none;
            font-family: inherit;
        }

        .btn-primary {
            background: var(--accent);
            color: white;
        }

        .btn-primary:hover {
            background: var(--accent-hover);
        }

        .btn-secondary {
            background: var(--bg-subtle);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: var(--bg-subtle-hover);
        }

        /* Theme Toggle */
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .theme-toggle-switch {
            width: 44px;
            height: 24px;
            background: var(--bg-subtle);
            border-radius: 12px;
            position: relative;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .theme-toggle-switch::after {
            content: '';
            position: absolute;
            width: 18px;
            height: 18px;
            background: var(--text-primary);
            border-radius: 50%;
            top: 3px;
            left: 3px;
            transition: transform 0.2s ease;
        }

        [data-theme="dark"] .theme-toggle-switch::after {
            transform: translateX(20px);
        }

        /* Quick Actions Bar */
        .quick-actions {
            position: fixed;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
            padding: 8px;
            background: var(--bg-layer);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            box-shadow: var(--shadow-dropdown);
            z-index: 500;
        }

        .quick-action {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.15s ease;
            color: var(--text-secondary);
            text-decoration: none;
            background: transparent;
            border: none;
        }

        .quick-action:hover {
            background: var(--bg-subtle-hover);
            color: var(--text-primary);
        }

        .quick-action img {
            width: 24px;
            height: 24px;
        }

        /* Status indicator */
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #107c10;
            margin-left: auto;
        }

        /* Responsive */
        @media (max-width: 900px) {
            .nav-panel {
                position: fixed;
                left: 0;
                top: 0;
                bottom: 0;
                transform: translateX(-100%);
                z-index: 1000;
            }

            .nav-panel.mobile-open {
                transform: translateX(0);
            }

            .main-content {
                padding: 16px;
            }

            .mobile-nav-toggle {
                display: flex;
            }

            .button-grid {
                grid-template-columns: 1fr;
            }

            .quick-actions {
                bottom: 16px;
            }
        }

        @media (min-width: 901px) {
            .mobile-nav-toggle {
                display: none;
            }
        }

        /* Navigator input */
        .nav-input-container {
            display: none;
            flex: 1;
        }

        .nav-input-container.active {
            display: flex;
        }

        .nav-input-container input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-card);
            color: var(--text-primary);
            font-size: 13px;
            outline: none;
        }

        .nav-input-container input:focus {
            border-color: var(--accent);
        }

        /* Section visibility */
        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
            animation: fadeIn 0.2s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(8px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Info cards for instructions */
        .info-card {
            background: var(--accent-light);
            border: 1px solid var(--accent);
            border-radius: 8px;
            padding: 16px;
            margin-top: 16px;
        }

        .info-card strong {
            display: block;
            margin-bottom: 8px;
            color: var(--accent);
        }

        .info-card ol {
            padding-left: 20px;
            margin: 0;
            color: var(--text-primary);
        }

        .info-card ol li {
            margin-bottom: 4px;
        }
    </style>
</head>
<body>
    <!-- Mica Background -->
    <div class="mica-background" id="micaBackground"></div>

    <!-- App Container -->
    <div class="app-container">
        <!-- Navigation Panel -->
        <nav class="nav-panel" id="navPanel">
            <div class="nav-header">
                <div class="nav-logo">
                    <i class="fas fa-compass"></i>
                </div>
                <span class="nav-title">Ассистент</span>
            </div>
            
            <button class="nav-toggle" id="navToggle" title="Свернуть панель">
                <i class="fas fa-chevron-left"></i>
            </button>

            <div class="nav-section">
                <div class="nav-section-title">Основное</div>
                <a href="#" class="nav-item active" data-section="cadastral">
                    <i class="fas fa-map-marked-alt"></i>
                    <span>Кадастр</span>
                </a>
                <a href="#" class="nav-item" data-section="search">
                    <i class="fas fa-search"></i>
                    <span>Поиск</span>
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Инструменты</div>
                <a href="#" class="nav-item" data-section="images">
                    <i class="fas fa-image"></i>
                    <span>Изображения</span>
                </a>
                <a href="#" class="nav-item" data-section="text">
                    <i class="fas fa-file-alt"></i>
                    <span>Текст</span>
                </a>
                <a href="#" class="nav-item" data-section="geo">
                    <i class="fas fa-drafting-compass"></i>
                    <span>Геоданные</span>
                </a>
                <a href="#" class="nav-item" data-section="desktop">
                    <i class="fas fa-desktop"></i>
                    <span>Рабочий стол</span>
                </a>
                <a href="#" class="nav-item" data-section="ai">
                    <i class="fas fa-robot"></i>
                    <span>AI</span>
                </a>
                <a href="#" class="nav-item" data-section="apps">
                    <i class="fas fa-th-large"></i>
                    <span>Приложения</span>
                </a>
            </div>

            <div class="nav-spacer"></div>

            <div class="nav-footer">
                <a href="#" class="nav-item" data-section="rosreestr" id="rosreestrNavItem">
                    <i class="fas fa-landmark"></i>
                    <span>Росреестр</span>
                </a>
                <div class="nav-item" id="themeToggleNav">
                    <i class="fas fa-moon"></i>
                    <span>Тема</span>
                    <div class="theme-toggle-switch" style="margin-left: auto;"></div>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Mobile Nav Toggle -->
            <button class="mobile-nav-toggle action-button" id="mobileNavToggle" style="margin-bottom: 16px; width: fit-content;">
                <i class="fas fa-bars"></i>
                <span>Меню</span>
            </button>

            <!-- Cadastral Section -->
            <section class="content-section active" id="section-cadastral">
                <div class="content-header">
                    <h1 class="content-title">Кадастровый поиск</h1>
                    <p class="content-subtitle">Поиск по кадастровому номеру или адресу</p>
                </div>

                <div class="search-container">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="searchText" placeholder="Введите кадастровый номер или адрес...">
                    </div>
                    <p class="search-hint" id="searchHint">Формат: 00:00:0000000:0 или адрес на русском языке</p>
                </div>

                <div class="mode-tabs">
                    <button class="mode-tab active" data-mode="cadastral">Кадастровый номер</button>
                    <button class="mode-tab" data-mode="address">Адрес</button>
                </div>

                <!-- Cadastral Number Buttons -->
                <div class="button-grid" id="cadastralButtons">
                    <a href="#" class="action-button accent" id="pkkButton" data-color="blue">
                        <img src="img/r.png" alt="PKK">
                        <span>Публичная карта</span>
                    </a>
                    <a href="#" class="action-button" id="kadastrmapButton" data-color="orange">
                        <img src="img/nr.png" alt="Н.Реестр">
                        <span>Н.Реестр</span>
                    </a>
                    <a href="#" class="action-button" id="rosreestrButton" data-color="blue">
                        <img src="img/mapr.png" alt="Map">
                        <span>Кадастровая карта</span>
                    </a>
                    <a href="#" class="action-button" id="egrpButton" data-color="green">
                        <img src="img/savannah.png" alt="EGRP">
                        <span>ЕГРН</span>
                    </a>
                    <a href="#" class="action-button" id="roscadastresButton" data-color="blue">
                        <img src="img/map.png" alt="Map">
                        <span>Карта</span>
                    </a>
                </div>

                <!-- Address Buttons -->
                <div class="button-grid" id="addressButtons" style="display: none;">
                    <a href="#" class="action-button accent" id="addressPKKButton">
                        <img src="img/r.png" alt="PKK">
                        <span>Публичная карта</span>
                    </a>
                    <a href="#" class="action-button" id="addressKadastrmapButton">
                        <img src="img/favicon-128x128-annotated.png" alt="Н.Реестр">
                        <span>Н.Реестр</span>
                    </a>
                    <a href="#" class="action-button" id="yandexButton" data-color="red">
                        <img src="img/ymaps.png" alt="Yandex">
                        <span>Яндекс Карты</span>
                    </a>
                    <a href="#" class="action-button" id="googleButton" data-color="blue">
                        <img src="img/gmaps.png" alt="Google">
                        <span>Google Карты</span>
                    </a>
                    <a href="#" class="action-button" id="earthButton" data-color="green">
                        <img src="img/gearth.png" alt="Earth">
                        <span>Планета Земля</span>
                    </a>
                    <a href="#" class="action-button" id="bingButton" data-color="teal">
                        <img src="img/bing-annotated.png" alt="Bing">
                        <span>Bing Карты</span>
                    </a>
                    <a href="#" class="action-button" id="gisButton" data-color="blue">
                        <img src="img/2gis.png" alt="2GIS">
                        <span>2ГИС</span>
                    </a>
                    <a href="#" class="action-button" id="addressMapButton">
                        <img src="img/map.png" alt="Map">
                        <span>Карта</span>
                    </a>
                    <a href="#" class="action-button" id="yandexNavButton" data-color="red">
                        <img src="img/ynav.png" alt="Navigator">
                        <span class="nav-button-text">Навигатор</span>
                        <div class="nav-input-container">
                            <input type="text" placeholder="Конечный пункт (Enter/Ctrl+Enter)" id="navEndPoint">
                        </div>
                    </a>
                </div>
            </section>

            <!-- Search (F9) Section -->
            <section class="content-section" id="section-search">
                <div class="content-header">
                    <h1 class="content-title">Поиск</h1>
                    <p class="content-subtitle">Быстрый поиск по различным сервисам</p>
                </div>

                <div class="search-container">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="f9SearchText" placeholder="Введите поисковый запрос...">
                    </div>
                </div>

                <div class="button-grid">
                    <a href="#" class="action-button" id="aiSearchButton" data-color="orange">
                        <i class="fab fa-android"></i>
                        <span>AI Поиск</span>
                    </a>
                    <a href="#" class="action-button" id="pharmaciesButton" data-color="green">
                        <i class="fas fa-pills"></i>
                        <span>Аптеки</span>
                    </a>
                    <a href="#" class="action-button" id="audiobooksButton" data-color="blue">
                        <i class="fas fa-headphones"></i>
                        <span>Аудиокниги</span>
                    </a>
                    <a href="#" class="action-button" id="quotesButton" data-color="purple">
                        <i class="fas fa-chart-line"></i>
                        <span>Котировки</span>
                    </a>
                    <a href="#" class="action-button" id="marketplacesButton" data-color="red">
                        <i class="fas fa-shopping-cart"></i>
                        <span>Маркетплейсы</span>
                    </a>
                    <a href="#" class="action-button" id="organizationsButton" data-color="orange">
                        <i class="fas fa-building"></i>
                        <span>Организации</span>
                    </a>
                    <a href="#" class="action-button" id="legalSystemsButton" data-color="teal">
                        <i class="fas fa-balance-scale"></i>
                        <span>Правовые системы</span>
                    </a>
                    <a href="#" class="action-button" id="siteSearchButton">
                        <i class="fas fa-globe"></i>
                        <span>Поиск на сайте</span>
                    </a>
                </div>
            </section>

            <!-- Images Section -->
            <section class="content-section" id="section-images">
                <div class="content-header">
                    <h1 class="content-title">Изображения</h1>
                    <p class="content-subtitle">Инструменты для работы с изображениями</p>
                </div>

                <div class="button-grid">
                    <a href="pdf" target="_blank" class="action-button" data-color="red">
                        <i class="fas fa-file-pdf"></i>
                        <span>PDF</span>
                    </a>
                    <a href="https://mapruapp.ru/pdf-converter/" target="_blank" class="action-button">
                        <i class="fas fa-photo-video"></i>
                        <span>PDF в JPG</span>
                    </a>
                    <a href="animate" target="_blank" class="action-button" data-color="purple">
                        <i class="fas fa-wand-magic-sparkles"></i>
                        <span>Анимации</span>
                    </a>
                    <a href="диаграммы.html" target="_blank" class="action-button" data-color="blue">
                        <i class="fas fa-pie-chart"></i>
                        <span>Диаграммы</span>
                    </a>
                    <a href="img.html" target="_blank" class="action-button" data-color="green">
                        <i class="fas fa-file-image"></i>
                        <span>Изображения</span>
                    </a>
                    <a href="collage.html" target="_blank" class="action-button" data-color="orange">
                        <i class="fas fa-puzzle-piece"></i>
                        <span>Коллаж</span>
                    </a>
                    <a href="подпись.html" target="_blank" class="action-button">
                        <i class="fas fa-file-signature"></i>
                        <span>Подпись</span>
                    </a>
                    <a href="наложение.html" target="_blank" class="action-button" data-color="teal">
                        <i class="fas fa-clone"></i>
                        <span>Наложение</span>
                    </a>
                    <a href="pv" target="_blank" class="action-button" data-color="red">
                        <i class="fas fa-external-link-alt"></i>
                        <span>Просмотр PDF</span>
                    </a>
                    <a href="split" target="_blank" class="action-button">
                        <i class="fas fa-cut"></i>
                        <span>Разделитель</span>
                    </a>
                    <a href="image" target="_blank" class="action-button" data-color="purple">
                        <i class="fas fa-image"></i>
                        <span>Редактор</span>
                    </a>
                    <a href="stereo.html" target="_blank" class="action-button" data-color="blue">
                        <i class="fas fa-binoculars"></i>
                        <span>Стереокартинки</span>
                    </a>
                    <a href="эскизы.html" target="_blank" class="action-button">
                        <i class="fas fa-images"></i>
                        <span>Эскизы</span>
                    </a>
                </div>
            </section>

            <!-- Text Section -->
            <section class="content-section" id="section-text">
                <div class="content-header">
                    <h1 class="content-title">Текст</h1>
                    <p class="content-subtitle">Инструменты для работы с текстом</p>
                </div>

                <div class="button-grid">
                    <a href="note.html" target="_blank" class="action-button" data-color="orange">
                        <i class="fas fa-sticky-note"></i>
                        <span>Заметки</span>
                    </a>
                    <a href="nb.html" target="_blank" class="action-button" data-color="blue">
                        <i class="fas fa-book-open"></i>
                        <span>Записная книжка</span>
                    </a>
                    <a href="кадастровый_номер.html" target="_blank" class="action-button">
                        <i class="fas fa-hashtag"></i>
                        <span>Кадастровый номер</span>
                    </a>
                    <a href="поиск_текста.html" target="_blank" class="action-button" data-color="green">
                        <i class="fas fa-search"></i>
                        <span>Поиск текста</span>
                    </a>
                    <a href="проверка.html" target="_blank" class="action-button" data-color="purple">
                        <i class="fas fa-spell-check"></i>
                        <span>Проверка текста</span>
                    </a>
                    <a href="doc.html" target="_blank" class="action-button">
                        <i class="fas fa-keyboard"></i>
                        <span>Редактор текста</span>
                    </a>
                    <a href="строки.html" target="_blank" class="action-button" data-color="teal">
                        <i class="fas fa-text-width"></i>
                        <span>Строки</span>
                    </a>
                    <a href="table" target="_blank" class="action-button" data-color="blue">
                        <i class="fas fa-th-list"></i>
                        <span>Таблица</span>
                    </a>
                    <a href="eml" target="_blank" class="action-button" data-color="red">
                        <i class="fas fa-envelope"></i>
                        <span>EML</span>
                    </a>
                    <a href="xml" target="_blank" class="action-button" data-color="orange">
                        <i class="fab fa-readme"></i>
                        <span>Просмотр XML</span>
                    </a>
                </div>
            </section>

            <!-- Geo Section -->
            <section class="content-section" id="section-geo">
                <div class="content-header">
                    <h1 class="content-title">Геоданные</h1>
                    <p class="content-subtitle">Инструменты для работы с геоданными</p>
                </div>

                <div class="button-grid">
                    <a href="схема.html" target="_blank" class="action-button" data-color="blue">
                        <i class="fas fa-map-pin"></i>
                        <span>Схема</span>
                    </a>
                    <a href="схема_xml.html" target="_blank" class="action-button">
                        <i class="fas fa-map"></i>
                        <span>Схема XML</span>
                    </a>
                    <a href="editor" target="_blank" class="action-button" data-color="green">
                        <i class="fas fa-pencil-alt"></i>
                        <span>ГеоРедактор</span>
                    </a>
                    <a href="cv.html" target="_blank" class="action-button" data-color="purple">
                        <i class="fas fa-exchange"></i>
                        <span>Конвертер координат</span>
                    </a>
                    <a href="conv.html" target="_blank" class="action-button">
                        <i class="fas fa-ruler-combined"></i>
                        <span>Конвертер XML</span>
                    </a>
                    <a href="ot.html" target="_blank" class="action-button" data-color="orange">
                        <i class="fas fa-print"></i>
                        <span>Печать</span>
                    </a>
                    <a href="kn.html" target="_blank" class="action-button" data-color="blue">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>Поиск в XML</span>
                    </a>
                    <a href="kpt.html" target="_blank" class="action-button" data-color="teal">
                        <i class="fas fa-file-export"></i>
                        <span>Создать XML КПТ</span>
                    </a>
                    <a href="zu.html" target="_blank" class="action-button">
                        <i class="fas fa-vector-square"></i>
                        <span>ЗУ из XML</span>
                    </a>
                    <a href="tools.html" target="_blank" class="action-button" data-color="red">
                        <i class="fas fa-screwdriver-wrench"></i>
                        <span>Инструменты</span>
                    </a>
                    <a href="mapmini.html" target="_blank" class="action-button" data-color="green">
                        <i class="fas fa-globe"></i>
                        <span>Карта Мини</span>
                    </a>
                    <a href="photomap.html" target="_blank" class="action-button" data-color="purple">
                        <i class="fas fa-camera"></i>
                        <span>Фото на карте</span>
                    </a>
                </div>
            </section>

            <!-- Desktop Section -->
            <section class="content-section" id="section-desktop">
                <div class="content-header">
                    <h1 class="content-title">Рабочий стол</h1>
                    <p class="content-subtitle">Системные инструменты и утилиты</p>
                </div>

                <div class="card">
                    <h3 class="card-title">Web-разработка</h3>
                    <div class="button-grid">
                        <a href="html.html" target="_blank" class="action-button" data-color="orange">
                            <i class="fas fa-code"></i>
                            <span>HTML</span>
                        </a>
                        <a href="http.html" target="_blank" class="action-button" data-color="blue">
                            <i class="fas fa-link"></i>
                            <span>HTTP</span>
                        </a>
                        <a href="supabase.html" target="_blank" class="action-button" data-color="green">
                            <i class="fas fa-database"></i>
                            <span>Supabase</span>
                        </a>
                        <a href="parser.html" target="_blank" class="action-button">
                            <i class="fas fa-exchange-alt"></i>
                            <span>XML JSON</span>
                        </a>
                        <a href="ps.html" target="_blank" class="action-button" data-color="purple">
                            <i class="fas fa-terminal"></i>
                            <span>PS</span>
                        </a>
                        <a href="int.html" target="_blank" class="action-button" data-color="teal">
                            <i class="fas fa-microchip"></i>
                            <span>Интерпретатор</span>
                        </a>
                        <a href="src.html" target="_blank" class="action-button" data-color="red">
                            <i class="fas fa-file-code"></i>
                            <span>Исходный код</span>
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">Утилиты</h3>
                    <div class="button-grid">
                        <a href="webcam" target="_blank" class="action-button" data-color="blue">
                            <i class="fas fa-camera"></i>
                            <span>Веб-камера</span>
                        </a>
                        <a href="win" target="_blank" class="action-button" data-color="purple">
                            <i class="fas fa-desktop"></i>
                            <span>Виртуальный ПК</span>
                        </a>
                        <a href="ipcam" target="_blank" class="action-button">
                            <i class="fas fa-video"></i>
                            <span>Камеры</span>
                        </a>
                        <a href="setup.html" target="_blank" class="action-button" data-color="teal">
                            <i class="fas fa-gear"></i>
                            <span>Настройка</span>
                        </a>
                        <a href="https://mapruapp.ru/chat/" target="_blank" class="action-button" data-color="green">
                            <i class="fas fa-sms"></i>
                            <span>Переписка</span>
                        </a>
                        <a href="поиск_файлов.html" target="_blank" class="action-button" data-color="orange">
                            <i class="fas fa-binoculars"></i>
                            <span>Поиск файлов</span>
                        </a>
                        <a href="f1.html" target="_blank" class="action-button">
                            <i class="fas fa-question-circle"></i>
                            <span>Помощь F1</span>
                        </a>
                        <a href="app.html" target="_blank" class="action-button" data-color="blue">
                            <i class="fas fa-th"></i>
                            <span>Программы</span>
                        </a>
                        <a href="ext.html" target="_blank" class="action-button" data-color="red">
                            <i class="fas fa-puzzle-piece"></i>
                            <span>Расширения</span>
                        </a>
                        <a href="files" target="_blank" class="action-button">
                            <i class="fas fa-file-alt"></i>
                            <span>Файлы</span>
                        </a>
                    </div>
                </div>
            </section>

            <!-- AI Section -->
            <section class="content-section" id="section-ai">
                <div class="content-header">
                    <h1 class="content-title">Искусственный интеллект</h1>
                    <p class="content-subtitle">AI-инструменты и помощники</p>
                </div>

                <div class="button-grid">
                    <a href="ai.html" target="_blank" class="action-button accent">
                        <i class="fas fa-star"></i>
                        <span>ИИ</span>
                    </a>
                    <a href="an.html" target="_blank" class="action-button" data-color="blue">
                        <i class="fas fa-magnifying-glass-chart"></i>
                        <span>Анализ</span>
                    </a>
                    <a href="https://mapruapp.ru/file-processor/" target="_blank" class="action-button" data-color="orange">
                        <i class="fas fa-file-signature"></i>
                        <span>Архивариус</span>
                    </a>
                    <a href="wiki.html" target="_blank" class="action-button" data-color="purple">
                        <i class="fas fa-question-circle"></i>
                        <span>Википедия</span>
                    </a>
                    <a href="диаграмма.html" target="_blank" class="action-button" data-color="teal">
                        <i class="fas fa-chart-line"></i>
                        <span>Диаграмма</span>
                    </a>
                    <a href="https://mapruapp.ru/doc-parser/" target="_blank" class="action-button" data-color="green">
                        <i class="fas fa-clipboard-check"></i>
                        <span>Документы</span>
                    </a>
                    <a href="cons.html" target="_blank" class="action-button" data-color="blue">
                        <i class="fas fa-headset"></i>
                        <span>Консультант</span>
                    </a>
                    <a href="medcons.html" target="_blank" class="action-button" data-color="red">
                        <i class="fas fa-first-aid"></i>
                        <span>МедПомощник</span>
                    </a>
                    <a href="https://mapruapp.ru/doc-generator/" target="_blank" class="action-button">
                        <i class="fas fa-user-tie"></i>
                        <span>Референт</span>
                    </a>
                    <a href="versus.html" target="_blank" class="action-button" data-color="purple">
                        <i class="fas fa-balance-scale"></i>
                        <span>Сравнение</span>
                    </a>
                </div>
            </section>

            <!-- Apps Section -->
            <section class="content-section" id="section-apps">
                <div class="content-header">
                    <h1 class="content-title">Приложения</h1>
                    <p class="content-subtitle">Дополнительные инструменты и сервисы</p>
                </div>

                <div class="card">
                    <h3 class="card-title">География</h3>
                    <div class="button-grid">
                        <a href="city.html" target="_blank" class="action-button" data-color="blue">
                            <i class="fas fa-globe"></i>
                            <span>Города</span>
                        </a>
                        <a href="explorer.html" target="_blank" class="action-button" data-color="green">
                            <i class="fas fa-globe-europe"></i>
                            <span>Исследователь</span>
                        </a>
                        <a href="vg.html" target="_blank" class="action-button" data-color="purple">
                            <i class="fas fa-street-view"></i>
                            <span>ВидеоГид</span>
                        </a>
                        <a href="https://mapruapp.ru/tracker/" target="_blank" class="action-button" data-color="red">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>Трекер</span>
                        </a>
                        <a href="weather.html" target="_blank" class="action-button" data-color="teal">
                            <i class="fas fa-cloud-sun"></i>
                            <span>Погода</span>
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">Инструменты</h3>
                    <div class="button-grid">
                        <a href="calendar.html" target="_blank" class="action-button" data-color="orange">
                            <i class="fas fa-calendar-alt"></i>
                            <span>Календарь</span>
                        </a>
                        <a href="ruler" target="_blank" class="action-button">
                            <i class="fas fa-ruler"></i>
                            <span>Линейка</span>
                        </a>
                        <a href="timer.html" target="_blank" class="action-button" data-color="blue">
                            <i class="fas fa-stopwatch"></i>
                            <span>Таймер</span>
                        </a>
                        <a href="lab.html" target="_blank" class="action-button" data-color="purple">
                            <i class="fas fa-flask"></i>
                            <span>Лаборатория</span>
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">Медиа</h3>
                    <div class="button-grid">
                        <a href="audio.html" target="_blank" class="action-button" data-color="green">
                            <i class="fas fa-headphones"></i>
                            <span>Аудио</span>
                        </a>
                        <a href="music.html" target="_blank" class="action-button" data-color="purple">
                            <i class="fas fa-music"></i>
                            <span>Музыка</span>
                        </a>
                        <a href="piano.html" target="_blank" class="action-button">
                            <i class="fas fa-keyboard"></i>
                            <span>Пианино</span>
                        </a>
                        <a href="video.html" target="_blank" class="action-button" data-color="red">
                            <i class="fas fa-video"></i>
                            <span>Видео</span>
                        </a>
                        <a href="youtube.html" target="_blank" class="action-button" data-color="red">
                            <i class="fas fa-play"></i>
                            <span>YouTube</span>
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">Обучение</h3>
                    <div class="button-grid">
                        <a href="words.html" target="_blank" class="action-button" data-color="blue">
                            <i class="fas fa-language"></i>
                            <span>Слова</span>
                        </a>
                        <a href="тестирование.html" target="_blank" class="action-button" data-color="green">
                            <i class="fas fa-check-circle"></i>
                            <span>Тестирование</span>
                        </a>
                        <a href="telegram" target="_blank" class="action-button" data-color="blue">
                            <i class="fas fa-comment-dots"></i>
                            <span>Боты</span>
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">Финансы</h3>
                    <div class="button-grid">
                        <a href="pr.html" target="_blank" class="action-button" data-color="orange">
                            <i class="fas fa-shopping-bag"></i>
                            <span>Анализ цен</span>
                        </a>
                        <a href="https://mapruapp.ru/market-monitor/" target="_blank" class="action-button" data-color="green">
                            <i class="fas fa-chart-area"></i>
                            <span>Котировки</span>
                        </a>
                        <a href="trade.html" target="_blank" class="action-button" data-color="purple">
                            <i class="fas fa-chart-line"></i>
                            <span>Торговый симулятор</span>
                        </a>
                        <a href="food.html" target="_blank" class="action-button" data-color="teal">
                            <i class="fas fa-apple-alt"></i>
                            <span>Продукты</span>
                        </a>
                    </div>
                </div>

                <div class="button-grid">
                    <a href="edu/sim.html" target="_blank" class="action-button accent">
                        <i class="fas fa-rocket"></i>
                        <span>Симулятор</span>
                    </a>
                </div>
            </section>

            <!-- Rosreestr Section -->
            <section class="content-section" id="section-rosreestr">
                <div class="content-header">
                    <h1 class="content-title">Росреестр</h1>
                    <p class="content-subtitle">Сервисы Росреестра и связанные ресурсы</p>
                </div>

                <div class="card">
                    <h3 class="card-title">Личный кабинет</h3>
                    <div class="button-grid">
                        <a href="https://lk.rosreestr.ru/request-access-egrn/property-search" target="_blank" class="action-button accent" id="rosreestrSearchLink">
                            <i class="fas fa-search"></i>
                            <span>Поиск</span>
                        </a>
                        <a href="https://lk.rosreestr.ru/request-access-egrn/my-claims" target="_blank" class="action-button" data-color="blue">
                            <i class="fas fa-clipboard-list"></i>
                            <span>Заявки</span>
                        </a>
                        <a href="https://lk.rosreestr.ru/eservices/real-estate-objects-online" target="_blank" class="action-button" data-color="green">
                            <i class="fas fa-info-circle"></i>
                            <span>Информация</span>
                        </a>
                        <a href="https://lk.rosreestr.ru/eservices/request-info-from-egrn/real-estate-object-or-its-rightholder" target="_blank" class="action-button" data-color="orange">
                            <i class="fas fa-shopping-cart"></i>
                            <span>Заказать</span>
                        </a>
                        <a href="https://lk.rosreestr.ru/my-applications" target="_blank" class="action-button">
                            <i class="fas fa-list-alt"></i>
                            <span>Выписки</span>
                        </a>
                        <a href="https://lk.rosreestr.ru/my-plans" target="_blank" class="action-button" data-color="purple">
                            <i class="fas fa-check"></i>
                            <span>Проверка файла</span>
                        </a>
                        <a href="https://lk.rosreestr.ru/eservices/check-request" target="_blank" class="action-button" data-color="teal">
                            <i class="fas fa-question-circle"></i>
                            <span>Статус</span>
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">Госуслуги</h3>
                    <div class="button-grid">
                        <a href="https://www.gosuslugi.ru/600447/1/form" target="_blank" class="action-button" data-color="blue">
                            <i class="fas fa-archive"></i>
                            <span>Материалы</span>
                        </a>
                        <a href="https://www.gosuslugi.ru/600141/1/form" target="_blank" class="action-button" data-color="green">
                            <i class="fas fa-check-circle"></i>
                            <span>Схема</span>
                        </a>
                        <a href="https://lk.gosuslugi.ru/orders?" target="_blank" class="action-button" data-color="purple">
                            <i class="fas fa-file-signature"></i>
                            <span>Заявления</span>
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">Полигон</h3>
                    <div class="button-grid">
                        <a href="https://polygon.top/ws/fir/" target="_blank" class="action-button" data-color="orange">
                            <i class="fas fa-book"></i>
                            <span>Архив КПТ</span>
                        </a>
                        <a href="https://polygon.top/ws/k11/" target="_blank" class="action-button" data-color="blue">
                            <i class="fas fa-retweet"></i>
                            <span>Конвертер КПТ</span>
                        </a>
                        <a href="https://polygon.top/ws/csc/" target="_blank" class="action-button" data-color="green">
                            <i class="fas fa-arrow-right-arrow-left"></i>
                            <span>Конвертер координат</span>
                        </a>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">Сайты</h3>
                    <div class="button-grid">
                        <a href="https://nspd.gov.ru/urban-analyze/search" target="_blank" class="action-button" data-color="blue">
                            <i class="fas fa-drafting-compass"></i>
                            <span>НСПД</span>
                        </a>
                        <a href="rt" target="_blank" class="action-button" data-color="green">
                            <i class="fas fa-tree"></i>
                            <span>РТ</span>
                        </a>
                        <a href="fgistp" target="_blank" class="action-button" data-color="purple">
                            <i class="fas fa-street-view"></i>
                            <span>ФГИС ТП</span>
                        </a>
                        <a href="https://fias.nalog.ru/" target="_blank" class="action-button" data-color="orange">
                            <i class="fas fa-location-dot"></i>
                            <span>ФИАС</span>
                        </a>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Quick Actions Bar -->
    <div class="quick-actions" id="quickActions">
        <a href="https://web.whatsapp.com/" target="_blank" class="quick-action" title="WhatsApp">
            <i class="fab fa-whatsapp" style="color: #25D366;"></i>
        </a>
        <a href="https://web.telegram.org/" target="_blank" class="quick-action" title="Telegram">
            <i class="fab fa-telegram-plane" style="color: #0088cc;"></i>
        </a>
        <a href="https://web.max.ru/" target="_blank" class="quick-action" title="Max">
            <img src="img/max.png" alt="Max">
        </a>
        <button class="quick-action" id="quickEmail" title="Email: mapruapp@gmail.com">
            <i class="fas fa-envelope" style="color: #EA4335;"></i>
        </button>
    </div>

    <!-- Modal for F9 Services -->
    <div class="modal-overlay" id="f9ModalOverlay">
        <div class="modal-content">
            <h2 class="modal-title" id="f9ModalTitle"></h2>
            <ul class="modal-list" id="f9ModalList"></ul>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="f9ModalClose">Закрыть</button>
                <button class="btn btn-primary" id="f9ModalOpenAll">Открыть все</button>
            </div>
        </div>
    </div>

    <!-- Info Modal -->
    <div class="modal-overlay" id="infoModalOverlay">
        <div class="modal-content">
            <h2 class="modal-title" id="infoModalTitle"></h2>
            <div id="infoModalBody"></div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="infoModalClose">ОК</button>
            </div>
        </div>
    </div>

    <!-- Site Search Modal -->
    <div class="modal-overlay" id="siteSearchModal">
        <div class="modal-content" style="max-width: 400px;">
            <h2 class="modal-title">Поиск на сайте</h2>
            <div class="search-box" style="margin-bottom: 16px;">
                <i class="fas fa-globe"></i>
                <input type="text" id="siteSearchUrl" placeholder="Введите домен сайта (например: example.com)">
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="siteSearchCancel">Отмена</button>
                <button class="btn btn-primary" id="siteSearchSubmit">Искать</button>
            </div>
        </div>
    </div>

    <script>
        // ==================== Configuration ====================
        const sevenDigitsRegions = [
            '06', '07', '09', '10', '11', '12', '13', '14', '17', '23',
            '24', '27', '31', '32', '35', '36', '41', '42', '47', '48',
            '50', '52', '53', '56', '57', '58', '59', '60', '61', '62',
            '63', '64', '65', '66', '67', '69', '70', '71', '72', '74',
            '77', '78', '79'
        ];

        const backgroundImages = [
            'wall/photo-1539667547529-84c607280d20.jpg',
            'wall/photo-1470329508532-be27fda94658.jpg',
            'wall/photo-1542259009477-d625272157b7.jpg',
            'wall/photo-1464822759023-fed622ff2c3b.jpg',
            'wall/photo-1495107334309-fcf20504a5ab.jpg',
            'wall/photo-1440558929809-1412944a6225.jpg',
            'wall/photo-1509088960169-ecb53eda6ed8.jpg',
            'wall/photo-1444723121867-7a241cacace9.jpg',
            'wall/photo-1639787422603-67df3f9759e2.jpg',
            'wall/photo-1613988800332-3e20b47801a4.jpg',
            'wall/photo-1452302372225-a5ba1edd65ca.jpg',
            'wall/photo-1585130401366-fe05a8d813c4.jpg',
            'wall/photo-1507525428034-b723cf961d3e.jpg',
        ];

        // ==================== State ====================
        let currentMode = 'cadastral'; // 'cadastral' or 'address'
        let currentModalUrls = [];

        // ==================== DOM Elements ====================
        const searchText = document.getElementById('searchText');
        const f9SearchText = document.getElementById('f9SearchText');
        const cadastralButtons = document.getElementById('cadastralButtons');
        const addressButtons = document.getElementById('addressButtons');
        const navPanel = document.getElementById('navPanel');
        const micaBackground = document.getElementById('micaBackground');

        // ==================== Utility Functions ====================
        function formatCadastralNumber(text) {
            text = text.replace(/[^\d]/g, '');
            const firstTwoDigits = text.slice(0, 2);
            const isSevenDigits = sevenDigitsRegions.includes(firstTwoDigits);
            const thirdBlockLength = isSevenDigits ? 7 : 6;

            let formattedText = '';
            if (text.length > 0) formattedText += text.slice(0, 2);
            if (text.length > 2) formattedText += ':' + text.slice(2, 4);
            if (text.length > 4) {
                const remainingDigits = text.slice(4);
                if (remainingDigits.length <= thirdBlockLength) {
                    formattedText += ':' + remainingDigits;
                } else {
                    formattedText += ':' + remainingDigits.slice(0, thirdBlockLength) + ':' + remainingDigits.slice(thirdBlockLength);
                }
            }
            return formattedText;
        }

        function isValidCadastralNumber(text) {
            const firstTwoDigits = text.slice(0, 2);
            const isSevenDigits = sevenDigitsRegions.includes(firstTwoDigits);
            const digitsAfterSecondColon = isSevenDigits ? 7 : 6;
            const pattern = new RegExp(`^\\d{2}:\\d{2}:\\d{${digitsAfterSecondColon}}:\\d+$`);
            return pattern.test(text);
        }

        function replaceEnglishWithRussian(text) {
            const map = {
                'q': 'й', 'w': 'ц', 'e': 'у', 'r': 'к', 't': 'е', 'y': 'н', 'u': 'г', 'i': 'ш', 'o': 'щ', 'p': 'з', '[': 'х', ']': 'ъ',
                'a': 'ф', 's': 'ы', 'd': 'в', 'f': 'а', 'g': 'п', 'h': 'р', 'j': 'о', 'k': 'л', 'l': 'д', ';': 'ж', '\'': 'э',
                'z': 'я', 'x': 'ч', 'c': 'с', 'v': 'м', 'b': 'и', 'n': 'т', 'm': 'ь', ',': 'б', '.': 'ю', '/': '.',
                'Q': 'Й', 'W': 'Ц', 'E': 'У', 'R': 'К', 'T': 'Е', 'Y': 'Н', 'U': 'Г', 'I': 'Ш', 'O': 'Щ', 'P': 'З', '{': 'Х', '}': 'Ъ',
                'A': 'Ф', 'S': 'Ы', 'D': 'В', 'F': 'А', 'G': 'П', 'H': 'Р', 'J': 'О', 'K': 'Л', 'L': 'Д', ':': 'Ж', '"': 'Э',
                'Z': 'Я', 'X': 'Ч', 'C': 'С', 'V': 'М', 'B': 'И', 'N': 'Т', 'M': 'Ь', '<': 'Б', '>': 'Ю', '?': ','
            };
            return text.split('').map(char => map[char] || char).join('');
        }

        async function copyToClipboard(text, onSuccessCallback) {
            if (!text || text.length <= 5) {
                if (onSuccessCallback) onSuccessCallback();
                return;
            }

            try {
                await navigator.clipboard.writeText(text);
                console.log('Текст скопирован:', text);
                if (onSuccessCallback) onSuccessCallback();
            } catch (err) {
                console.error('Ошибка копирования:', err);
                if (onSuccessCallback) onSuccessCallback();
            }
        }

        function openSite(baseUrl, isAddress) {
            const text = searchText.value;
            if (isAddress) {
                if (/[А-Яа-я]/.test(text.charAt(0))) {
                    window.open(`${baseUrl}${encodeURIComponent(text)}`, '_blank', 'noopener,noreferrer');
                }
            } else {
                if (isValidCadastralNumber(text)) {
                    window.open(`${baseUrl}${text}`, '_blank', 'noopener,noreferrer');
                }
            }
        }

        // ==================== Theme Management ====================
        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            updateThemeIcon(savedTheme);
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
        }

        function updateThemeIcon(theme) {
            const icon = document.querySelector('#themeToggleNav i');
            if (icon) {
                icon.className = theme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
            }
        }

        // ==================== Background ====================
        function initBackground() {
            const randomIndex = Math.floor(Math.random() * backgroundImages.length);
            micaBackground.style.backgroundImage = `url("${backgroundImages[randomIndex]}")`;
        }

        // ==================== Navigation ====================
        function initNavigation() {
            const navItems = document.querySelectorAll('.nav-item[data-section]');
            const sections = document.querySelectorAll('.content-section');

            navItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    const sectionId = item.dataset.section;

                    // Update active nav item
                    navItems.forEach(nav => nav.classList.remove('active'));
                    item.classList.add('active');

                    // Show corresponding section
                    sections.forEach(section => {
                        section.classList.remove('active');
                        if (section.id === `section-${sectionId}`) {
                            section.classList.add('active');
                        }
                    });

                    // Close mobile nav
                    navPanel.classList.remove('mobile-open');
                });
            });

            // Nav toggle
            document.getElementById('navToggle').addEventListener('click', () => {
                navPanel.classList.toggle('collapsed');
                const icon = document.querySelector('#navToggle i');
                icon.classList.toggle('fa-chevron-left');
                icon.classList.toggle('fa-chevron-right');
            });

            // Mobile nav toggle
            document.getElementById('mobileNavToggle').addEventListener('click', () => {
                navPanel.classList.toggle('mobile-open');
            });

            // Theme toggle
            document.getElementById('themeToggleNav').addEventListener('click', toggleTheme);
        }

        // ==================== Mode Tabs ====================
        function initModeTabs() {
            const modeTabs = document.querySelectorAll('.mode-tab');
            modeTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    modeTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    currentMode = tab.dataset.mode;
                    updateButtonsVisibility();
                });
            });
        }

        function updateButtonsVisibility() {
            if (currentMode === 'cadastral') {
                cadastralButtons.style.display = 'grid';
                addressButtons.style.display = 'none';
            } else {
                cadastralButtons.style.display = 'none';
                addressButtons.style.display = 'grid';
            }
        }

        // ==================== Search Input ====================
        function initSearchInput() {
            searchText.addEventListener('input', function() {
                this.value = replaceEnglishWithRussian(this.value);
                const firstChar = this.value.trim().charAt(0);

                if (/[А-Яа-я]/.test(firstChar)) {
                    // Address mode
                    currentMode = 'address';
                    document.querySelectorAll('.mode-tab').forEach(t => {
                        t.classList.toggle('active', t.dataset.mode === 'address');
                    });
                } else {
                    // Cadastral mode
                    this.value = formatCadastralNumber(this.value.replace(/[^\d]/g, ''));
                    currentMode = 'cadastral';
                    document.querySelectorAll('.mode-tab').forEach(t => {
                        t.classList.toggle('active', t.dataset.mode === 'cadastral');
                    });
                }
                updateButtonsVisibility();
            });

            searchText.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    document.getElementById('pkkButton').click();
                }
            });

            // Auto-paste from clipboard on focus
            searchText.addEventListener('focus', async function() {
                if (this.value.length > 0) return;
                try {
                    const clipboardText = await navigator.clipboard.readText();
                    if (isValidCadastralNumber(clipboardText)) {
                        this.value = clipboardText;
                        this.style.backgroundColor = 'var(--accent-light)';
                        setTimeout(() => {
                            this.style.backgroundColor = '';
                        }, 1000);
                    }
                } catch (err) {
                    // Clipboard access denied, ignore
                }
            });
        }

        // ==================== PKK Button ====================
        async function handlePkkButtonClick(layers = encodeURIComponent('36048,36328,36329,36049')) {
            const text = searchText.value.trim();

            if (!text || !isValidCadastralNumber(text)) {
                copyToClipboard(text, () => {
                    window.open('https://nspd.gov.ru/map', '_blank', 'noopener,noreferrer');
                });
                return;
            }

            try {
                const apiUrl = `https://nspd.gov.ru/api/geoportal/v2/search/geoportal?thematicSearchId=1&query=${text}`;
                const response = await fetch(apiUrl);
                const data = await response.json();

                if (data.code === 204 || !data.data?.features?.length) {
                    copyToClipboard(text, () => {
                        window.open('https://nspd.gov.ru/map', '_blank', 'noopener,noreferrer');
                    });
                    return;
                }

                const feature = data.data.features[0];
                const geometry = feature.geometry;
                let coordinates;

                if (geometry.type === 'Polygon') {
                    coordinates = geometry.coordinates[0][0];
                } else if (geometry.type === 'Point') {
                    coordinates = geometry.coordinates;
                } else {
                    throw new Error('Unsupported geometry');
                }

                const [x, y] = coordinates;
                if (x.toString().includes("5632576") || y.toString().includes("5632576")) {
                    copyToClipboard(text, () => {
                        window.open('https://nspd.gov.ru/map', '_blank', 'noopener,noreferrer');
                    });
                } else {
                    const mapUrl = `https://nspd.gov.ru/map?query=${encodeURIComponent(text)}&zoom=20&coordinate_x=${x}&coordinate_y=${y}&theme_id=1&is_copy_url=true&active_layers=${layers}`;
                    copyToClipboard(text, () => {
                        window.open(mapUrl, '_blank', 'noopener,noreferrer');
                    });
                }
            } catch (error) {
                copyToClipboard(text, () => {
                    window.open('https://nspd.gov.ru/map', '_blank', 'noopener,noreferrer');
                });
            }
        }

        // ==================== Button Event Listeners ====================
        function initCadastralButtons() {
            // PKK Button
            document.getElementById('pkkButton').addEventListener('click', (e) => {
                e.preventDefault();
                handlePkkButtonClick();
            });

            // Kadastrmap Button
            document.getElementById('kadastrmapButton').addEventListener('click', (e) => {
                e.preventDefault();
                const text = searchText.value;
                if (isValidCadastralNumber(text)) {
                    window.open(`https://kadastrcheck.ru/search/${text}`, '_blank', 'noopener,noreferrer');
                } else {
                    window.open('https://kadastrcheck.ru/search?query=' + encodeURIComponent(text), '_blank', 'noopener,noreferrer');
                }
            });

            // Rosreestr Button
            document.getElementById('rosreestrButton').addEventListener('click', (e) => {
                e.preventDefault();
                const text = searchText.value;
                window.open('https://map.ru/pkk?kad=' + encodeURIComponent(text), '_blank', 'noopener,noreferrer');
            });

            // EGRP Button
            document.getElementById('egrpButton').addEventListener('click', (e) => {
                e.preventDefault();
                const text = searchText.value;
                copyToClipboard(text, () => {
                    window.open('egrn.html', '_blank', 'noopener,noreferrer');
                });
            });

            // Roscadastres Button
            document.getElementById('roscadastresButton').addEventListener('click', (e) => {
                e.preventDefault();
                const text = searchText.value;
                copyToClipboard(text, () => {
                    window.open('map.html', '_blank', 'noopener,noreferrer');
                });
            });
        }

        function initAddressButtons() {
            // Address PKK Button
            document.getElementById('addressPKKButton').addEventListener('click', (e) => {
                e.preventDefault();
                const text = searchText.value;
                copyToClipboard(text, () => {
                    window.open('https://nspd.gov.ru/map', '_blank', 'noopener,noreferrer');
                });
            });

            // Address Kadastrmap Button
            document.getElementById('addressKadastrmapButton').addEventListener('click', (e) => {
                e.preventDefault();
                const text = searchText.value;
                copyToClipboard(text, () => {
                    window.open('https://kadastrcheck.ru/search?query=' + encodeURIComponent(text), '_blank', 'noopener,noreferrer');
                });
            });

            // Map buttons
            document.getElementById('yandexButton').addEventListener('click', (e) => {
                e.preventDefault();
                openSite('https://yandex.ru/maps/?text=', true);
            });

            document.getElementById('googleButton').addEventListener('click', (e) => {
                e.preventDefault();
                openSite('https://www.google.com/maps/search/', true);
            });

            document.getElementById('earthButton').addEventListener('click', (e) => {
                e.preventDefault();
                openSite('https://earth.google.com/web/search/', true);
            });

            document.getElementById('bingButton').addEventListener('click', (e) => {
                e.preventDefault();
                openSite('https://www.bing.com/maps?q=', true);
            });

            document.getElementById('gisButton').addEventListener('click', (e) => {
                e.preventDefault();
                openSite('https://2gis.ru/search/', true);
            });

            document.getElementById('addressMapButton').addEventListener('click', (e) => {
                e.preventDefault();
                const text = searchText.value;
                copyToClipboard(text, () => {
                    window.open('map.html', '_blank', 'noopener,noreferrer');
                });
            });

            // Navigator Button
            const yandexNavButton = document.getElementById('yandexNavButton');
            const navEndPoint = document.getElementById('navEndPoint');
            const navButtonText = yandexNavButton.querySelector('.nav-button-text');
            const navInputContainer = yandexNavButton.querySelector('.nav-input-container');

            yandexNavButton.addEventListener('click', (e) => {
                e.preventDefault();
                navButtonText.style.display = 'none';
                navInputContainer.classList.add('active');
                navEndPoint.focus();
            });

            navEndPoint.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    e.stopPropagation();
                    const startPoint = searchText.value;
                    const endPoint = navEndPoint.value;
                    let url;

                    if (e.ctrlKey) {
                        url = `https://www.google.com/maps/dir/?api=1&origin=${encodeURIComponent(startPoint)}&destination=${encodeURIComponent(endPoint)}`;
                    } else {
                        url = `https://yandex.ru/maps/?rtext=${encodeURIComponent(startPoint)}~${encodeURIComponent(endPoint)}&rtt=auto`;
                    }

                    window.open(url, '_blank', 'noopener,noreferrer');
                    navEndPoint.value = '';
                    navInputContainer.classList.remove('active');
                    navButtonText.style.display = '';
                }

                if (e.key === 'Escape') {
                    navInputContainer.classList.remove('active');
                    navButtonText.style.display = '';
                }
            });

            navEndPoint.addEventListener('input', function() {
                this.value = replaceEnglishWithRussian(this.value);
            });

            document.addEventListener('click', (e) => {
                if (!yandexNavButton.contains(e.target)) {
                    navInputContainer.classList.remove('active');
                    navButtonText.style.display = '';
                }
            });
        }

        // ==================== F9 Search Buttons ====================
        function initF9Buttons() {
            const f9ModalOverlay = document.getElementById('f9ModalOverlay');
            const f9ModalTitle = document.getElementById('f9ModalTitle');
            const f9ModalList = document.getElementById('f9ModalList');
            const f9ModalClose = document.getElementById('f9ModalClose');
            const f9ModalOpenAll = document.getElementById('f9ModalOpenAll');

            function showF9Modal(title, services) {
                const query = f9SearchText.value || searchText.value;
                const searchQuery = encodeURIComponent(query);

                f9ModalTitle.textContent = title;
                f9ModalList.innerHTML = '';
                currentModalUrls = [];

                services.forEach(service => {
                    const fullUrl = service.url.includes('{query}')
                        ? service.url.replace('{query}', searchQuery)
                        : service.url;
                    currentModalUrls.push(fullUrl);

                    const listItem = document.createElement('li');
                    const link = document.createElement('a');
                    link.href = fullUrl;
                    link.target = '_blank';
                    link.rel = 'noopener noreferrer';

                    const favicon = document.createElement('img');
                    const domain = new URL(service.url.replace('{query}', 'test')).hostname;
                    favicon.src = `https://www.google.com/s2/favicons?sz=32&domain_url=${domain}`;
                    favicon.alt = service.name;
                    favicon.onerror = function() { this.style.visibility = 'hidden'; };

                    const nameSpan = document.createElement('span');
                    nameSpan.textContent = service.name;

                    link.appendChild(favicon);
                    link.appendChild(nameSpan);
                    listItem.appendChild(link);
                    f9ModalList.appendChild(listItem);
                });

                f9ModalOverlay.classList.add('show');
            }

            function hideF9Modal() {
                f9ModalOverlay.classList.remove('show');
            }

            f9ModalClose.addEventListener('click', hideF9Modal);
            f9ModalOverlay.addEventListener('click', (e) => {
                if (e.target === f9ModalOverlay) hideF9Modal();
            });

            f9ModalOpenAll.addEventListener('click', () => {
                currentModalUrls.forEach((url, index) => {
                    setTimeout(() => {
                        window.open(url, '_blank', 'noopener,noreferrer');
                    }, index * 100);
                });
                hideF9Modal();
            });

            // AI Search
            document.getElementById('aiSearchButton').addEventListener('click', (e) => {
                e.preventDefault();
                showF9Modal('AI Поиск', [
                    { name: "Yandex", url: "https://ya.ru/n?text={query}" },
                    { name: "Phind", url: "https://www.phind.com/search?q={query}" },
                    { name: "Perplexity", url: "https://www.perplexity.ai/search?q={query}" },
                    { name: "iAsk.ai", url: "https://iask.ai/?mode=question&q={query}" }
                ]);
            });

            // Pharmacies
            document.getElementById('pharmaciesButton').addEventListener('click', (e) => {
                e.preventDefault();
                showF9Modal('Аптеки', [
                    { name: "Фармленд", url: "https://farmlend.ru/search?keyword={query}" },
                    { name: "Аптека.ру", url: "https://apteka.ru/search/?q={query}" },
                    { name: "Вита", url: "https://vitaexpress.ru/search/?q={query}" },
                    { name: "Аптеки Плюс", url: "https://aptekiplus.ru/kazan/catalog/root/?q={query}" }
                ]);
            });

            // Audiobooks
            document.getElementById('audiobooksButton').addEventListener('click', (e) => {
                e.preventDefault();
                showF9Modal('Аудиокниги', [
                    { name: "aKniga", url: "https://akniga.org/search/books/?q={query}" },
                    { name: "Книги в Ухе", url: "https://knigivuhe.com/index.php?do=search&subaction=search&story={query}" },
                    { name: "KnigaVuhe", url: "https://knigavuhe.org/search/?q={query}" }
                ]);
            });

            // Quotes
            document.getElementById('quotesButton').addEventListener('click', (e) => {
                e.preventDefault();
                const query = f9SearchText.value || searchText.value;
                if (query.trim() === "") {
                    showF9Modal('Котировки', [
                        { name: "Finviz Forex", url: "https://finviz.com/forex.ashx" },
                        { name: "Finviz Crypto", url: "https://finviz.com/crypto.ashx" },
                        { name: "Finviz Stock Map", url: "https://finviz.com/map.ashx?t=sec_all" }
                    ]);
                } else {
                    showF9Modal('Котировки', [
                        { name: "Investing.com", url: "https://ru.investing.com/search/?q={query}" }
                    ]);
                }
            });

            // Marketplaces
            document.getElementById('marketplacesButton').addEventListener('click', (e) => {
                e.preventDefault();
                showF9Modal('Маркетплейсы', [
                    { name: "Ozon", url: "https://www.ozon.ru/search/?text={query}" },
                    { name: "МегаМаркет", url: "https://megamarket.ru/catalog/?q={query}" },
                    { name: "Wildberries", url: "https://www.wildberries.ru/catalog/0/search.aspx?search={query}" },
                    { name: "Яндекс.Маркет", url: "https://market.yandex.ru/search?text={query}" },
                    { name: "МагнитМаркет", url: "https://mm.ru/search?query={query}" },
                    { name: "AliExpress", url: "https://aliexpress.ru/wholesale?SearchText={query}" },
                    { name: "Pepper.ru", url: "https://www.pepper.ru/search_result?keyword={query}" }
                ]);
            });

            // Organizations
            document.getElementById('organizationsButton').addEventListener('click', (e) => {
                e.preventDefault();
                showF9Modal('Организации', [
                    { name: "ФНС", url: "https://pb.nalog.ru/search.html#t=1&mode=search-all&queryAll={query}" },
                    { name: "СПАРК-Интерфакс", url: "https://spark-interfax.ru/search?Query={query}&type=all&sort=" },
                    { name: "List-Org", url: "https://www.list-org.com/search?val={query}" }
                ]);
            });

            // Legal Systems
            document.getElementById('legalSystemsButton').addEventListener('click', (e) => {
                e.preventDefault();
                showF9Modal('Правовые системы', [
                    { name: "Техэксперт", url: "https://docs.cntd.ru/search?q={query}" },
                    { name: "Гарант", url: "https://ivo.garant.ru/#/basesearch/{query}" },
                    { name: "Контур.Норматив", url: "https://normativ.kontur.ru/?query={query}&searching=true" },
                    { name: "КонсультантПлюс", url: "https://www.consultant.ru/search/?q={query}" }
                ]);
            });

            // Site Search
            const siteSearchModal = document.getElementById('siteSearchModal');
            const siteSearchUrl = document.getElementById('siteSearchUrl');

            document.getElementById('siteSearchButton').addEventListener('click', (e) => {
                e.preventDefault();
                siteSearchModal.classList.add('show');
                siteSearchUrl.focus();
            });

            document.getElementById('siteSearchCancel').addEventListener('click', () => {
                siteSearchModal.classList.remove('show');
            });

            document.getElementById('siteSearchSubmit').addEventListener('click', () => {
                performSiteSearch();
            });

            siteSearchUrl.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    performSiteSearch();
                }
                if (e.key === 'Escape') {
                    siteSearchModal.classList.remove('show');
                }
            });

            siteSearchModal.addEventListener('click', (e) => {
                if (e.target === siteSearchModal) {
                    siteSearchModal.classList.remove('show');
                }
            });

            function performSiteSearch() {
                const query = f9SearchText.value || searchText.value;
                const site = siteSearchUrl.value.trim();
                const searchQuery = site ? `site:${site} ${query}` : query;

                window.open(`https://yandex.ru/search/?text=${encodeURIComponent(searchQuery)}`, '_blank', 'noopener,noreferrer');
                window.open(`https://www.google.com/search?q=${encodeURIComponent(searchQuery)}`, '_blank', 'noopener,noreferrer');

                siteSearchModal.classList.remove('show');
                siteSearchUrl.value = '';
            }

            // F9 Search input Enter key
            f9SearchText.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const query = f9SearchText.value.trim();
                    if (query) {
                        window.open(`https://iask.ai/?mode=question&q=${encodeURIComponent(query)}`, '_blank', 'noopener,noreferrer');
                    }
                }
            });
        }

        // ==================== Rosreestr Section ====================
        function initRosreestrSection() {
            document.getElementById('rosreestrSearchLink').addEventListener('click', (e) => {
                e.preventDefault();
                const text = searchText.value;
                copyToClipboard(text, () => {
                    window.open('https://lk.rosreestr.ru/request-access-egrn/property-search', '_blank', 'noopener,noreferrer');
                });
            });
        }

        // ==================== Quick Actions ====================
        function initQuickActions() {
            document.getElementById('quickEmail').addEventListener('click', () => {
                copyToClipboard('mapruapp@gmail.com', () => {
                    const btn = document.getElementById('quickEmail');
                    const icon = btn.querySelector('i');
                    icon.className = 'fas fa-check';
                    icon.style.color = '#107c10';
                    setTimeout(() => {
                        icon.className = 'fas fa-envelope';
                        icon.style.color = '#EA4335';
                    }, 2000);
                });
            });
        }

        // ==================== Info Modal ====================
        function initInfoModal() {
            const infoModalOverlay = document.getElementById('infoModalOverlay');
            const infoModalClose = document.getElementById('infoModalClose');

            infoModalClose.addEventListener('click', () => {
                infoModalOverlay.classList.remove('show');
            });

            infoModalOverlay.addEventListener('click', (e) => {
                if (e.target === infoModalOverlay) {
                    infoModalOverlay.classList.remove('show');
                }
            });
        }

        // ==================== Keyboard Shortcuts ====================
        function initKeyboardShortcuts() {
            document.addEventListener('keydown', (e) => {
                // F9 - Switch to Search section
                if (e.key === 'F9') {
                    e.preventDefault();
                    document.querySelector('[data-section="search"]').click();
                }

                // F8 - Toggle theme
                if (e.key === 'F8') {
                    e.preventDefault();
                    toggleTheme();
                }

                // Escape - Close modals
                if (e.key === 'Escape') {
                    document.querySelectorAll('.modal-overlay.show').forEach(modal => {
                        modal.classList.remove('show');
                    });
                }
            });
        }

        // ==================== Initialize ====================
        document.addEventListener('DOMContentLoaded', () => {
            initTheme();
            initBackground();
            initNavigation();
            initModeTabs();
            initSearchInput();
            initCadastralButtons();
            initAddressButtons();
            initF9Buttons();
            initRosreestrSection();
            initQuickActions();
            initInfoModal();
            initKeyboardShortcuts();
        });
    </script>
</body>
</html>