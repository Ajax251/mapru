
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://img.icons8.com/?size=100&id=15359&format=png&color=000000">
    <title>–ü–æ–≥–æ–¥–∞</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f0f0f0;
            font-family: sans-serif;
            margin: 0;
            background-size: cover;
            background-position: center;
            transition: background-image 0.3s ease;
            overflow: hidden;
        }
        .weather-widget {
            background-color: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            text-align: center;
            transition: transform 0.2s ease-in-out;
            user-select: none;
            z-index: 10;
            width: 400px;
            display: flex;
            flex-direction: column;
            align-items: center;
            color: white;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.8);
        }

        .weather-widget:hover {
            transform: scale(1.05);
        }

        .weather-widget #city-input {
            margin-top: 10px;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            display: none;
            width: 90%;
            text-align: center;
            color: #333;
        }

        .show-input #city-input {
            display: block;
        }

        #weather-data {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #weather-data .main-info {
            display: flex;
            align-items: center;
        }

        #weather-data .current-weather {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            cursor: pointer;
        }

        #weather-data .current-weather .weather-icon {
            font-size: 60px;
        }
          #weather-data .current-weather .temperature-link{
             color: white;
             text-decoration: none;
          }

        #weather-data .details {
            display: flex;
            justify-content: space-around;
            width: 100%;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        #weather-data .details > div {
            padding: 5px;
            text-align: center;
        }

        #weather-data .forecast-wrapper {
            margin-top: -10px;
            width: 100%;
        }

        #weather-data .forecast {
            display: flex;
            justify-content: space-around;
            width: 100%;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        #weather-data .forecast > div {
            text-align: center;
            padding: 5px;
        }

        .date-time {
            margin-bottom: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            color: white;
             cursor: pointer;
        }

       .weather-widget .city-name {
           font-size: 1.4rem;
           color: white;
           font-weight: bold;
           margin-bottom: 5px;
            cursor: pointer;
           text-decoration: none;
       }

        #weather-data div {
            white-space: nowrap;
            color: white;
        }

        @keyframes fall {
            to {
                transform: translateY(105vh);
            }
        }

        .rain {
            position: absolute;
            color: rgba(255, 255, 255, 0.7);
            font-size: 1.2rem;
            user-select: none;
            pointer-events: none;
            animation-name: fall;
            animation-timing-function: linear;
            animation-iteration-count: infinite;
            transform: skewY(-10deg);
            will-change: transform;
        }

        .snow {
            position: absolute;
            color: #fff;
            font-size: 1rem;
            user-select: none;
            pointer-events: none;
            animation-name: fall;
            animation-timing-function: linear;
            animation-iteration-count: infinite;
            will-change: transform;
        }

        @media (max-width: 768px) {
            .weather-widget {
                width: 90%;
                padding: 15px;
            }

            #weather-data .details {
                flex-direction: column;
            }

            #weather-data .forecast {
                flex-direction: column;
            }
        }
        
.distance-info {
    font-size: 1rem;
    color: white;
    text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.8);
     margin-top: 20px; /* –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É */
    margin-bottom: 10px; /* –û—Å—Ç–∞–≤–ª—è–µ–º –æ—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É */
    opacity: 0;
    transition: opacity 0.5s ease-in-out;
    text-align: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç */
    width: 100%; /* –ó–∞–Ω–∏–º–∞–µ—Ç –≤—Å—é —à–∏—Ä–∏–Ω—É */
}

.distance-info.visible {
    opacity: 1;
}
    </style>
    <link rel="stylesheet" href="/webfonts/all.min.css"
          integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg=="
          crossorigin="anonymous" referrerpolicy="no-referrer"/>
</head>
<body>
<div class="weather-widget" id="weather-widget">
    <div id="weather-data">
        <a class="city-name" id="city-name-display" target="_blank">–ó–∞–≥—Ä—É–∑–∫–∞...</a>
        <div class="date-time"></div>
        <div class="main-info">
            <div class="current-weather">
                <a href="#" class="temperature-link" target="_blank" id="icon-link">
                    <i class="weather-icon"></i>
                </a>
                <a href="#" class="temperature-link" target="_blank" id="temperature-link">
                    <div id="temperature">--¬∞C</div>
                </a>
                <div id="description"></div>
            </div>
        </div>
        <div class="details">
            <div>–û—â—É—â–∞–µ—Ç—Å—è: <span id="feels-like">--¬∞C</span></div>
            <div>–í–ª–∞–∂–Ω–æ—Å—Ç—å: <span id="humidity">--%</span></div>
            <div>–í–µ—Ç–µ—Ä: <span id="wind-speed">-- –º/—Å</span></div>
        </div>
        <div class="forecast-wrapper">
            <h3>–ó–∞–≤—Ç—Ä–∞</h3>
            <div class="forecast"></div>
        </div>
       
        <div class="distance-info" id="distance-info"></div>
    </div>
    <input type="text" id="city-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –≥–æ—Ä–æ–¥">
</div>
<script>
    const weatherWidget = document.getElementById('weather-widget');
    const cityInput = document.getElementById('city-input');
    const temperatureElement = document.getElementById('temperature');
    const cityNameElement = document.getElementById('city-name-display');
    const descriptionElement = document.getElementById('description');
    const feelsLikeElement = document.getElementById('feels-like');
    const humidityElement = document.getElementById('humidity');
    const windSpeedElement = document.getElementById('wind-speed');
    const weatherIcon = document.querySelector('.weather-icon');
    const body = document.body;
    const dateTimeElement = document.querySelector('.date-time');
    const temperatureLink = document.getElementById('temperature-link');
    const iconLink = document.getElementById('icon-link');
    const forecastContainer = document.querySelector('.forecast');
    let currentCity = localStorage.getItem('weatherCity') || '–ù—É—Ä–ª–∞—Ç';
    const API_KEY = '0591dccfc470fe491d729d2a617f70c2';
    const GEONAMES_USERNAME = 'mapru'; // –í–∞—à –ª–æ–≥–∏–Ω GeoNames
    let cityCoordinates = null;
    let timezone = 'UTC'; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—Ä–µ–º–µ–Ω–Ω–∞—è –∑–æ–Ω–∞ UTC
    
    const distanceInfo = document.getElementById('distance-info');
let previousCityName = '';
let previousCityCoords = null;

let originCoords = null;
let originCityName = '';



const countryNames = {
    'RU': '–†–æ—Å—Å–∏—è',    'US': '–°–®–ê',    'CA': '–ö–∞–Ω–∞–¥–∞',    'GB': '–í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—è',    'DE': '–ì–µ—Ä–º–∞–Ω–∏—è',    'FR': '–§—Ä–∞–Ω—Ü–∏—è',    'JP': '–Ø–ø–æ–Ω–∏—è',    'CN': '–ö–∏—Ç–∞–π',    'IN': '–ò–Ω–¥–∏—è',    'BR': '–ë—Ä–∞–∑–∏–ª–∏—è',    'AU': '–ê–≤—Å—Ç—Ä–∞–ª–∏—è',    'UA': '–£–∫—Ä–∞–∏–Ω–∞',    'KZ': '–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω',    'BY': '–ë–µ–ª–∞—Ä—É—Å—å',    'TR': '–¢—É—Ä—Ü–∏—è',    'UZ': '–£–∑–±–µ–∫–∏—Å—Ç–∞–Ω',    'AZ': '–ê–∑–µ—Ä–±–∞–π–¥–∂–∞–Ω',    'AM': '–ê—Ä–º–µ–Ω–∏—è',    'KG': '–ö—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω',    'TJ': '–¢–∞–¥–∂–∏–∫–∏—Å—Ç–∞–Ω',    'TM': '–¢—É—Ä–∫–º–µ–Ω–∏—Å—Ç–∞–Ω',    'PL': '–ü–æ–ª—å—à–∞',   
    'ES': '–ò—Å–ø–∞–Ω–∏—è',    'IT': '–ò—Ç–∞–ª–∏—è',    'KR': '–Æ–∂–Ω–∞—è –ö–æ—Ä–µ—è',    'MX': '–ú–µ–∫—Å–∏–∫–∞',    'EG': '–ï–≥–∏–ø–µ—Ç',    'TH': '–¢–∞–π–ª–∞–Ω–¥',    'VN': '–í—å–µ—Ç–Ω–∞–º',    'ID': '–ò–Ω–¥–æ–Ω–µ–∑–∏—è',    'IR': '–ò—Ä–∞–Ω',    'SA': '–°–∞—É–¥–æ–≤—Å–∫–∞—è –ê—Ä–∞–≤–∏—è',    'ZA': '–Æ–∂–Ω–∞—è –ê—Ñ—Ä–∏–∫–∞',    'AR': '–ê—Ä–≥–µ–Ω—Ç–∏–Ω–∞',    'NG': '–ù–∏–≥–µ—Ä–∏—è',    'KE': '–ö–µ–Ω–∏—è',    'SE': '–®–≤–µ—Ü–∏—è',    'FI': '–§–∏–Ω–ª—è–Ω–¥–∏—è',    'NO': '–ù–æ—Ä–≤–µ–≥–∏—è',    'DK': '–î–∞–Ω–∏—è',    'CH': '–®–≤–µ–π—Ü–∞—Ä–∏—è',    'NL': '–ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã',    'BE': '–ë–µ–ª—å–≥–∏—è',    'PT': '–ü–æ—Ä—Ç—É–≥–∞–ª–∏—è',   
    'AT': '–ê–≤—Å—Ç—Ä–∏—è',    'GR': '–ì—Ä–µ—Ü–∏—è',    'HU': '–í–µ–Ω–≥—Ä–∏—è',    'CZ': '–ß–µ—Ö–∏—è',    'RO': '–†—É–º—ã–Ω–∏—è',    'SK': '–°–ª–æ–≤–∞–∫–∏—è',    'BG': '–ë–æ–ª–≥–∞—Ä–∏—è',    'HR': '–•–æ—Ä–≤–∞—Ç–∏—è',    'RS': '–°–µ—Ä–±–∏—è',    'SI': '–°–ª–æ–≤–µ–Ω–∏—è',    'LT': '–õ–∏—Ç–≤–∞',    'LV': '–õ–∞—Ç–≤–∏—è',    'EE': '–≠—Å—Ç–æ–Ω–∏—è',    'IE': '–ò—Ä–ª–∞–Ω–¥–∏—è',    'IL': '–ò–∑—Ä–∞–∏–ª—å',    'PK': '–ü–∞–∫–∏—Å—Ç–∞–Ω',    'BD': '–ë–∞–Ω–≥–ª–∞–¥–µ—à',    'IQ': '–ò—Ä–∞–∫',    'CO': '–ö–æ–ª—É–º–±–∏—è',    'PE': '–ü–µ—Ä—É',    'VE': '–í–µ–Ω–µ—Å—É—ç–ª–∞',    'CL': '–ß–∏–ª–∏',    'EC': '–≠–∫–≤–∞–¥–æ—Ä',    'CU': '–ö—É–±–∞',   
    'DO': '–î–æ–º–∏–Ω–∏–∫–∞–Ω—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞',    'GT': '–ì–≤–∞—Ç–µ–º–∞–ª–∞',    'HN': '–ì–æ–Ω–¥—É—Ä–∞—Å',    'NI': '–ù–∏–∫–∞—Ä–∞–≥—É–∞',    'SV': '–°–∞–ª—å–≤–∞–¥–æ—Ä',    'CR': '–ö–æ—Å—Ç–∞-–†–∏–∫–∞',    'PA': '–ü–∞–Ω–∞–º–∞',    'MY': '–ú–∞–ª–∞–π–∑–∏—è',    'PH': '–§–∏–ª–∏–ø–ø–∏–Ω—ã',    'SG': '–°–∏–Ω–≥–∞–ø—É—Ä',    'NZ': '–ù–æ–≤–∞—è –ó–µ–ª–∞–Ω–¥–∏—è',    'AE': '–û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ –ê—Ä–∞–±—Å–∫–∏–µ –≠–º–∏—Ä–∞—Ç—ã',    'QA': '–ö–∞—Ç–∞—Ä',    'KW': '–ö—É–≤–µ–π—Ç',    'OM': '–û–º–∞–Ω',    'BH': '–ë–∞—Ö—Ä–µ–π–Ω',    'JO': '–ò–æ—Ä–¥–∞–Ω–∏—è',    'LB': '–õ–∏–≤–∞–Ω',    'SY': '–°–∏—Ä–∏—è',    'AF': '–ê—Ñ–≥–∞–Ω–∏—Å—Ç–∞–Ω',    'MM': '–ú—å—è–Ω–º–∞',    
    'NP': '–ù–µ–ø–∞–ª',    'LK': '–®—Ä–∏-–õ–∞–Ω–∫–∞',    'KH': '–ö–∞–º–±–æ–¥–∂–∞',    'LA': '–õ–∞–æ—Å',    'BN': '–ë—Ä—É–Ω–µ–π',    'AL': '–ê–ª–±–∞–Ω–∏—è',    'BA': '–ë–æ—Å–Ω–∏—è –∏ –ì–µ—Ä—Ü–µ–≥–æ–≤–∏–Ω–∞',    'MK': '–°–µ–≤–µ—Ä–Ω–∞—è –ú–∞–∫–µ–¥–æ–Ω–∏—è',    'ME': '–ß–µ—Ä–Ω–æ–≥–æ—Ä–∏—è',    'MT': '–ú–∞–ª—å—Ç–∞',    'MD': '–ú–æ–ª–¥–æ–≤–∞',    'IS': '–ò—Å–ª–∞–Ω–¥–∏—è',    'LU': '–õ—é–∫—Å–µ–º–±—É—Ä–≥',    'LI': '–õ–∏—Ö—Ç–µ–Ω—à—Ç–µ–π–Ω',    'MC': '–ú–æ–Ω–∞–∫–æ',    'AD': '–ê–Ω–¥–æ—Ä—Ä–∞',    'SM': '–°–∞–Ω-–ú–∞—Ä–∏–Ω–æ',    'VA': '–í–∞—Ç–∏–∫–∞–Ω',    'GG': '–ì–µ—Ä–Ω—Å–∏',    'JE': '–î–∂–µ—Ä—Å–∏',    'IM': '–û—Å—Ç—Ä–æ–≤ –ú—ç–Ω',    'FO': '–§–∞—Ä–µ—Ä—Å–∫–∏–µ –æ—Å—Ç—Ä–æ–≤–∞',   
    'GI': '–ì–∏–±—Ä–∞–ª—Ç–∞—Ä',    'AQ': '–ê–Ω—Ç–∞—Ä–∫—Ç–∏–¥–∞',    'AX': '–ê–ª–∞–Ω–¥—Å–∫–∏–µ –æ—Å—Ç—Ä–æ–≤–∞',    'BV': '–û—Å—Ç—Ä–æ–≤ –ë—É–≤–µ',    'CC': '–ö–æ–∫–æ—Å–æ–≤—ã–µ –æ—Å—Ç—Ä–æ–≤–∞',    'CX': '–û—Å—Ç—Ä–æ–≤ –†–æ–∂–¥–µ—Å—Ç–≤–∞',    'HM': '–û—Å—Ç—Ä–æ–≤ –•–µ—Ä–¥ –∏ –æ—Å—Ç—Ä–æ–≤–∞ –ú–∞–∫–¥–æ–Ω–∞–ª—å–¥',    'MP': '–°–µ–≤–µ—Ä–Ω—ã–µ –ú–∞—Ä–∏–∞–Ω—Å–∫–∏–µ –æ—Å—Ç—Ä–æ–≤–∞',    'NU': '–ù–∏—É—ç',    'NF': '–û—Å—Ç—Ä–æ–≤ –ù–æ—Ä—Ñ–æ–ª–∫',    'CK': '–û—Å—Ç—Ä–æ–≤–∞ –ö—É–∫–∞',    'PN': '–û—Å—Ç—Ä–æ–≤–∞ –ü–∏—Ç–∫—ç—Ä–Ω',    'TC': '–û—Å—Ç—Ä–æ–≤–∞ –¢–µ—Ä–∫—Å –∏ –ö–∞–π–∫–æ—Å',    'TK': '–¢–æ–∫–µ–ª–∞—É',    'UM': '–í–Ω–µ—à–Ω–∏–µ –º–∞–ª—ã–µ –æ—Å—Ç—Ä–æ–≤–∞ –°–®–ê',    'VG': '–ë—Ä–∏—Ç–∞–Ω—Å–∫–∏–µ –í–∏—Ä–≥–∏–Ω—Å–∫–∏–µ –æ—Å—Ç—Ä–æ–≤–∞',  
    'VI': '–í–∏—Ä–≥–∏–Ω—Å–∫–∏–µ –æ—Å—Ç—Ä–æ–≤–∞ –°–®–ê',    'WF': '–£–æ–ª–ª–∏—Å –∏ –§—É—Ç—É–Ω–∞',    'AS': '–ê–º–µ—Ä–∏–∫–∞–Ω—Å–∫–æ–µ –°–∞–º–æ–∞',    'AI': '–ê–Ω–≥–∏–ª—å—è',    'AW': '–ê—Ä—É–±–∞',    'BM': '–ë–µ—Ä–º—É–¥—Å–∫–∏–µ –æ—Å—Ç—Ä–æ–≤–∞',    'BQ': '–ö–∞—Ä–∏–±—Å–∫–∏–µ –ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã',    'IO': '–ë—Ä–∏—Ç–∞–Ω—Å–∫–∞—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è –≤ –ò–Ω–¥–∏–π—Å–∫–æ–º –æ–∫–µ–∞–Ω–µ',    'KY': '–û—Å—Ç—Ä–æ–≤–∞ –ö–∞–π–º–∞–Ω',    'CW': '–ö—é—Ä–∞—Å–∞–æ',    'DM': '–î–æ–º–∏–Ω–∏–∫–∞',    'FK': '–§–æ–ª–∫–ª–µ–Ω–¥—Å–∫–∏–µ –æ—Å—Ç—Ä–æ–≤–∞',    'GF': '–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∞—è –ì–≤–∏–∞–Ω–∞',    'GD': '–ì—Ä–µ–Ω–∞–¥–∞',    'GP': '–ì–≤–∞–¥–µ–ª—É–ø–∞',    'GU': '–ì—É–∞–º',    'GY': '–ì–∞–π–∞–Ω–∞',    'HT': '–ì–∞–∏—Ç–∏',   
    'JM': '–Ø–º–∞–π–∫–∞',    'MQ': '–ú–∞—Ä—Ç–∏–Ω–∏–∫–∞',    'MS': '–ú–æ–Ω—Ç—Å–µ—Ä—Ä–∞—Ç',    'NC': '–ù–æ–≤–∞—è –ö–∞–ª–µ–¥–æ–Ω–∏—è',    'PF': '–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∞—è –ü–æ–ª–∏–Ω–µ–∑–∏—è',    'PR': '–ü—É—ç—Ä—Ç–æ-–†–∏–∫–æ',    'RE': '–†–µ—é–Ω—å–æ–Ω',    'BL': '–°–µ–Ω-–ë–∞—Ä—Ç–µ–ª–µ–º–∏',    'SH': '–û—Å—Ç—Ä–æ–≤ –°–≤—è—Ç–æ–π –ï–ª–µ–Ω—ã',    'KN': '–°–µ–Ω—Ç-–ö–∏—Ç—Å –∏ –ù–µ–≤–∏—Å',    'LC': '–°–µ–Ω—Ç-–õ—é—Å–∏—è',    'MF': '–°–µ–Ω-–ú–∞—Ä—Ç–µ–Ω',    'PM': '–°–µ–Ω-–ü—å–µ—Ä –∏ –ú–∏–∫–µ–ª–æ–Ω',    'VC': '–°–µ–Ω—Ç-–í–∏–Ω—Å–µ–Ω—Ç –∏ –ì—Ä–µ–Ω–∞–¥–∏–Ω—ã',    'SR': '–°—É—Ä–∏–Ω–∞–º',    'TT': '–¢—Ä–∏–Ω–∏–¥–∞–¥ –∏ –¢–æ–±–∞–≥–æ',    'TV': '–¢—É–≤–∞–ª—É',    'YT': '–ú–∞–π–æ—Ç—Ç–∞',    'WS': '–°–∞–º–æ–∞',   
    'FM': '–ú–∏–∫—Ä–æ–Ω–µ–∑–∏—è',    'MH': '–ú–∞—Ä—à–∞–ª–ª–æ–≤—ã –û—Å—Ç—Ä–æ–≤–∞',    'PW': '–ü–∞–ª–∞—É',    'SB': '–°–æ–ª–æ–º–æ–Ω–æ–≤—ã –û—Å—Ç—Ä–æ–≤–∞',    'VU': '–í–∞–Ω—É–∞—Ç—É',    'KI': '–ö–∏—Ä–∏–±–∞—Ç–∏',    'NR': '–ù–∞—É—Ä—É',    'TO': '–¢–æ–Ω–≥–∞',    'CV': '–ö–∞–±–æ-–í–µ—Ä–¥–µ',    'ST': '–°–∞–Ω-–¢–æ–º–µ –∏ –ü—Ä–∏–Ω—Å–∏–ø–∏',    'KM': '–ö–æ–º–æ—Ä—ã',    'ER': '–≠—Ä–∏—Ç—Ä–µ—è',    'DJ': '–î–∂–∏–±—É—Ç–∏',    'ET': '–≠—Ñ–∏–æ–ø–∏—è',    'SO': '–°–æ–º–∞–ª–∏',    'SS': '–Æ–∂–Ω—ã–π –°—É–¥–∞–Ω',    'GN': '–ì–≤–∏–Ω–µ—è',    'GW': '–ì–≤–∏–Ω–µ—è-–ë–∏—Å–∞—É',    'LR': '–õ–∏–±–µ—Ä–∏—è',    'SL': '–°—å–µ—Ä—Ä–∞-–õ–µ–æ–Ω–µ',    'BF': '–ë—É—Ä–∫–∏–Ω–∞-–§–∞—Å–æ',    'ML': '–ú–∞–ª–∏',  
    'MR': '–ú–∞–≤—Ä–∏—Ç–∞–Ω–∏—è',    'NE': '–ù–∏–≥–µ—Ä',    'TD': '–ß–∞–¥',    'CF': '–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–∞—Ñ—Ä–∏–∫–∞–Ω—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞',    'CM': '–ö–∞–º–µ—Ä—É–Ω',    'GA': '–ì–∞–±–æ–Ω',    'CG': '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö–æ–Ω–≥–æ',    'CD': '–î–† –ö–æ–Ω–≥–æ',    'AO': '–ê–Ω–≥–æ–ª–∞',    'MZ': '–ú–æ–∑–∞–º–±–∏–∫',    'ZM': '–ó–∞–º–±–∏—è',    'ZW': '–ó–∏–º–±–∞–±–≤–µ',    'MG': '–ú–∞–¥–∞–≥–∞—Å–∫–∞—Ä',    'MW': '–ú–∞–ª–∞–≤–∏',    'LS': '–õ–µ—Å–æ—Ç–æ',    'BW': '–ë–æ—Ç—Å–≤–∞–Ω–∞',    'NA': '–ù–∞–º–∏–±–∏—è',    'SZ': '–≠—Å–≤–∞—Ç–∏–Ω–∏',    'GM': '–ì–∞–º–±–∏—è',    'SN': '–°–µ–Ω–µ–≥–∞–ª',    'TG': '–¢–æ–≥–æ',    'BJ': '–ë–µ–Ω–∏–Ω',    
    'CI': '–ö–æ—Ç-–¥‚Äô–ò–≤—É–∞—Ä',     'GH': '–ì–∞–Ω–∞',    'MU': '–ú–∞–≤—Ä–∏–∫–∏–π',    'BI': '–ë—É—Ä—É–Ω–¥–∏',    'RW': '–†—É–∞–Ω–¥–∞',    'UG': '–£–≥–∞–Ω–¥–∞',    'TZ': '–¢–∞–Ω–∑–∞–Ω–∏—è',     'TL': '–í–æ—Å—Ç–æ—á–Ω—ã–π –¢–∏–º–æ—Ä'
};


// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ–∫—É—Å –Ω–∞ body –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
document.body.setAttribute('tabindex', '0'); // –î–µ–ª–∞–µ–º body —Ñ–æ–∫—É—Å–∏—Ä—É–µ–º—ã–º
document.body.focus();

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∑–æ–Ω—ã –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º
async function getTimezoneByCoordinates(lat, lon) {
    const url = `https://secure.geonames.org/timezoneJSON?lat=${lat}&lng=${lon}&username=${GEONAMES_USERNAME}`;
    try {
        const response = await fetch(url);
        const data = await response.json();
        if (data.timezoneId) {
            return data.timezoneId; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –∑–æ–Ω—É, –Ω–∞–ø—Ä–∏–º–µ—Ä, "Europe/Moscow"
        }
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∑–æ–Ω—ã:', error);
    }
    return 'UTC'; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω–∞—è –∑–æ–Ω–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
}


    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ —Å —É—á–µ—Ç–æ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∑–æ–Ω—ã
function updateDateTime() {
    const now = new Date();
    let options;

    if (timezone !== 'UTC') {
        // –ï—Å–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω–∞—è –∑–æ–Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ—ë
        options = {
            weekday: 'short',
            year: 'numeric',
            month: 'short',
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit',
            timeZone: timezone // –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –∑–æ–Ω—É
        };
    } else {
        // –ï—Å–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω–∞—è –∑–æ–Ω–∞ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
        options = {
            weekday: 'short',
            year: 'numeric',
            month: 'short',
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
        };
    }

    const formattedDateTime = new Intl.DateTimeFormat('ru-RU', options).format(now);
    dateTimeElement.textContent = formattedDateTime;
}

function calculateDistance(lat1, lon1, lat2, lon2) {
    const toRadians = (degrees) => degrees * (Math.PI / 180);
    const R = 6371;
    const dLat = toRadians(lat2 - lat1);
    const dLon = toRadians(lon2 - lon1);
    const a =
        Math.sin(dLat / 2) * Math.sin(dLat / 2) +
        Math.cos(toRadians(lat1)) * Math.cos(toRadians(lat2)) *
        Math.sin(dLon / 2) * Math.sin(dLon / 2);
    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
    return R * c;
}


function animateDistance(distanceElement, finalDistance) {
    let currentDistance = 0;
    const increment = finalDistance / 100;
    const interval = setInterval(() => {
        currentDistance += increment;
        if (currentDistance >= finalDistance) {
            currentDistance = finalDistance;
            clearInterval(interval);
        }
        distanceElement.textContent = `${Math.round(currentDistance)} –∫–º`;
    }, 20);
}

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–≥–æ–¥—ã

async function updateWeather(city) {
    const apiUrl = `https://api.openweathermap.org/data/2.5/forecast?q=${city}&appid=${API_KEY}&units=metric&lang=ru`;
    try {
        const response = await fetch(apiUrl);
        const data = await response.json();
        if (data.cod === "200") {
            const current = data.list[0];
            const temperature = Math.round(current.main.temp);
            const description = current.weather[0].description;
            const feelsLike = Math.round(current.main.feels_like);
            const humidity = current.main.humidity;
            const windSpeed = current.wind.speed;
            const iconCode = current.weather[0].icon;
            const countryCode = data.city.country;
            const countryName = countryNames[countryCode] || countryCode;

            temperatureElement.textContent = `${temperature}¬∞C`;
            temperatureLink.href = `https://www.google.ru/search?q=${encodeURIComponent(data.city.name)} –ø–æ–≥–æ–¥–∞`;
            descriptionElement.textContent = description;
            feelsLikeElement.textContent = `${feelsLike}¬∞C`;
            humidityElement.textContent = `${humidity}%`;
            windSpeedElement.textContent = `${windSpeed} –º/—Å`;
            cityNameElement.textContent = `${data.city.name}, ${countryName}`;
            iconLink.href = `https://www.google.ru/search?q=${encodeURIComponent(data.city.name)} –ø–æ–≥–æ–¥–∞`;

            weatherIcon.className = 'weather-icon fas';
            updateWeatherIcon(iconCode);
            forecastContainer.innerHTML = '';

            const today = new Date().getDate();
            data.list
                .filter(item => new Date(item.dt_txt).getDate() > today && new Date(item.dt_txt).getHours() === 12)
                .slice(0, 1)
                .forEach(item => {
                    const forecastDay = document.createElement('div');
                    forecastDay.innerHTML = `
                        <div><i class="fas weather-icon-forecast"></i></div>
                        <div>${Math.round(item.main.temp)}¬∞C</div>
                        <div>${item.weather[0].description}</div>
                    `;
                    const iconCode = item.weather[0].icon;
                    updateForecastIcon(forecastDay.querySelector('.weather-icon-forecast'), iconCode);
                    forecastContainer.appendChild(forecastDay);
                });

            // –ü–æ–ª—É—á–∞–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≥–æ—Ä–æ–¥–∞
            cityCoordinates = {
                lat: data.city.coord.lat,
                lon: data.city.coord.lon
            };

            // –ü–æ–ª—É—á–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –∑–æ–Ω—É –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º
            timezone = await getTimezoneByCoordinates(cityCoordinates.lat, cityCoordinates.lon);

            // –õ–æ–≥–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
            console.log('–¢–µ–∫—É—â–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:', cityCoordinates);
            console.log('–ü—Ä–µ–¥—ã–¥—É—â–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:', previousCityCoords);

            // –ï—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ
            if (previousCityCoords) {
                const distance = calculateDistance(
                    previousCityCoords.lat,
                    previousCityCoords.lon,
                    cityCoordinates.lat,
                    cityCoordinates.lon
                );

                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞ –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
                originCoords = { ...previousCityCoords };
                originCityName = previousCityName;

                // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç —Å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º
                distanceInfo.innerHTML = `
                    <span>${originCityName}  <i class="fas fa-plane"></i>  ${data.city.name}:  </span>
                    <span class="distance-value"><strong>0</strong> –∫–º</span>
                `;
                distanceInfo.classList.add('visible');
                const distanceValueElement = distanceInfo.querySelector('.distance-value');
                animateDistance(distanceValueElement, distance);

                // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å
                distanceInfo.removeEventListener('click', handleDistanceInfoClick);

                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
                distanceInfo.addEventListener('click', handleDistanceInfoClick);
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º previousCityCoords –∏ previousCityName
            previousCityCoords = {
                lat: data.city.coord.lat,
                lon: data.city.coord.lon
            };
            previousCityName = data.city.name;

            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –∏ —Ñ–æ–Ω
            updateDateTime();
            updateBackground(iconCode, windSpeed);

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–∏–π –≥–æ—Ä–æ–¥ –≤ localStorage
            currentCity = city;
            localStorage.setItem('weatherCity', city);

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –∫–∞—Ä—Ç—ã
            cityNameElement.href = `https://yandex.ru/maps/?ll=${cityCoordinates.lon},${cityCoordinates.lat}&z=12`;

        } else {
            throw new Error('–ì–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω');
        }
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–≥–æ–¥–µ:', error);
        temperatureElement.textContent = '--¬∞C';
        descriptionElement.textContent = '';
        feelsLikeElement.textContent = '--¬∞C';
        humidityElement.textContent = '--%';
        windSpeedElement.textContent = '-- –º/—Å';
        cityNameElement.textContent = '–û—à–∏–±–∫–∞';
        cityNameElement.href = '#';
        temperatureLink.href = '#';
        iconLink.href = '#';
        weatherIcon.className = 'weather-icon fas fa-exclamation-triangle';
        forecastContainer.innerHTML = '';
        updateBackground('error');
    }
}

// –§—É–Ω–∫—Ü–∏—è-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ distance-info
function handleDistanceInfoClick() {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ originCoords –∏ cityCoordinates –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
    if (!originCoords || !cityCoordinates) {
        console.error('–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã');
        return;
    }

    // –õ–æ–≥–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –ø—Ä–∏ –∫–ª–∏–∫–µ
    console.log('–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø—Ä–∏ –∫–ª–∏–∫–µ:', {
        origin: originCoords,
        destination: cityCoordinates
    });

    // –§–æ—Ä–º–∏—Ä—É–µ–º —Å—Å—ã–ª–∫—É –¥–ª—è –Ø–Ω–¥–µ–∫—Å.–ù–∞–≤–∏–≥–∞—Ç–æ—Ä–∞
    const rtext = `${originCoords.lat},${originCoords.lon}~${cityCoordinates.lat},${cityCoordinates.lon}`;
    const yandexMapsUrl = `https://yandex.ru/maps/?rtext=${rtext}&rtt=auto`;
    console.log('–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞:', yandexMapsUrl);

    // –û—Ç–∫—Ä—ã–≤–∞–µ–º —Å—Å—ã–ª–∫—É –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ
  //  window.open(yandexMapsUrl, '_blank');
}
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∫–æ–Ω–∫–∏ –ø–æ–≥–æ–¥—ã
    function updateWeatherIcon(iconCode) {
        const iconMapping = {
            '01d': 'fa-sun',
            '01n': 'fa-moon',
            '02d': 'fa-cloud-sun',
            '02n': 'fa-cloud-moon',
            '03d': 'fa-cloud',
            '03n': 'fa-cloud',
            '04d': 'fa-cloud-meatball',
            '04n': 'fa-cloud-meatball',
            '09d': 'fa-cloud-showers-heavy',
            '09n': 'fa-cloud-showers-heavy',
            '10d': 'fa-cloud-rain',
            '10n': 'fa-cloud-rain',
            '11d': 'fa-bolt',
            '11n': 'fa-bolt',
            '13d': 'fa-snowflake',
            '13n': 'fa-snowflake',
            '50d': 'fa-smog',
            '50n': 'fa-smog',
        };
        const iconClass = iconMapping[iconCode] || 'fa-question';
        weatherIcon.classList.add(iconClass);
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∫–æ–Ω–∫–∏ –ø—Ä–æ–≥–Ω–æ–∑–∞ –ø–æ–≥–æ–¥—ã
    function updateForecastIcon(iconElement, iconCode) {
        const iconMapping = {
            '01d': 'fa-sun',
            '01n': 'fa-moon',
            '02d': 'fa-cloud-sun',
            '02n': 'fa-cloud-moon',
            '03d': 'fa-cloud',
            '03n': 'fa-cloud',
            '04d': 'fa-cloud-meatball',
            '04n': 'fa-cloud-meatball',
            '09d': 'fa-cloud-showers-heavy',
            '09n': 'fa-cloud-showers-heavy',
            '10d': 'fa-cloud-rain',
            '10n': 'fa-cloud-rain',
            '11d': 'fa-bolt',
            '11n': 'fa-bolt',
            '13d': 'fa-snowflake',
            '13n': 'fa-snowflake',
            '50d': 'fa-smog',
            '50n': 'fa-smog',
        };
        const iconClass = iconMapping[iconCode] || 'fa-question';
        iconElement.classList.add(iconClass);
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ñ–æ–Ω–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–æ–≥–æ–¥—ã
    function updateBackground(iconCode, windSpeed = 0) {
        const backgroundMapping = {
            '01d': {
                image: 'https://images.unsplash.com/photo-1449312605762-1df9d89ee6b7?q=80&w=1476&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by-wYWdlfHx8fGVufDB8fHx8fA%3D%3D'
            }, // –Ø—Å–Ω—ã–π –¥–µ–Ω—å
            '01n': {
                image: 'https://images.unsplash.com/photo-1683337684248-9fc5c4c7051d?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'
            }, // –Ø—Å–Ω–∞—è –Ω–æ—á—å
            '02d': {
                image: 'https://images.unsplash.com/photo-1525490829609-d166ddb58678?q=80&w=1469&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by-wYWdlfHx8fGVufDB8fHx8fA%3D%3D'
            }, // –ú–∞–ª–æ–æ–±–ª–∞—á–Ω–æ –¥–µ–Ω—å
            '02n': {
                image: 'https://images.unsplash.com/photo-1490642914619-7955a3fd483c?q=80&w=1493&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by-wYWdlfHx8fGVufDB8fHx8fA%3D%3D'
            }, // –ú–∞–ª–æ–æ–±–ª–∞—á–Ω–æ –Ω–æ—á—å
            '03d': {
                image: 'https://images.unsplash.com/photo-1414269665217-a57681e266b3?q=80&w=1412&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by-wYWdlfHx8fGVufDB8fHx8fA%3D%3D'
            },  // –û–±–ª–∞—á–Ω–æ –¥–µ–Ω—å
            '03n': {
                image: 'https://images.unsplash.com/photo-1516007656130-a430110d6363?q=80&w=1474&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by-wYWdlfHx8fGVufDB8fHx8fA%3D%3D'
            },  // –û–±–ª–∞—á–Ω–æ –Ω–æ—á—å
         '04d': {
                image: 'https://images.unsplash.com/photo-1475924156734-496f6cac6ec1?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by-wYWdlfHx8fGVufDB8fHx8fA%3D%3D'
            }, // –ü–∞—Å–º—É—Ä–Ω–æ –¥–µ–Ω—å
            '04n': {
                image: 'https://images.unsplash.com/photo-1598330821260-e47371714f64?q=80&w=1582&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by-wYWdlfHx8fGVufDB8fHx8fA%3D%3D'
            },  // –ü–∞—Å–º—É—Ä–Ω–æ –Ω–æ—á—å
            '09d': {
                image: 'https://images.unsplash.com/photo-1689786180097-6ff2da88170c?q=80&w=1469&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by-wYWdlfHx8fGVufDB8fHx8fA%3D%3D',
                isRain: true
            }, // –ù–µ–±–æ–ª—å—à–æ–π –¥–æ–∂–¥—å –¥–µ–Ω—å, —Å —ç—Ñ—Ñ–µ–∫—Ç–æ–º –¥–æ–∂–¥—è
            '09n': {
                image: 'https://images.unsplash.com/photo-1516389207633-e5784a9518d2?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by-wYWdlfHx8fGVufDB8fHx8fA%3D%3D',
                isRain: true
            }, // –ù–µ–±–æ–ª—å—à–æ–π –¥–æ–∂–¥—å –Ω–æ—á—å, —Å —ç—Ñ—Ñ–µ–∫—Ç–æ–º –¥–æ–∂–¥—è
            '10d': {
                image: 'https://images.unsplash.com/photo-1715798820927-77ffa4df35df?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by-wYWdlfHx8fA%3D%3D',
                isRain: true
            }, // –î–æ–∂–¥—å –¥–µ–Ω—å, —Å —ç—Ñ—Ñ–µ–∫—Ç–æ–º –¥–æ–∂–¥—è
            '10n': {
                image: 'https://images.unsplash.com/photo-1667862086507-63877555770e?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by-wYWdlfHx8fGVufDB8fHx8fA%3D%3D',
                isRain: true
            }, // –î–æ–∂–¥—å –Ω–æ—á—å, —Å —ç—Ñ—Ñ–µ–∫—Ç–æ–º –¥–æ–∂–¥—è
            '11d': {
                image: 'https://images.unsplash.com/19/drops.JPG?q=80&w=1377&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by-wYWdlfHx8fGVufDB8fHx8fA%3D%3D',
                isRain: true
            }, // –ì—Ä–æ–∑–∞ –¥–µ–Ω—å, —Å —ç—Ñ—Ñ–µ–∫—Ç–æ–º –¥–æ–∂–¥—è
            '11n': {
                image: 'https://images.unsplash.com/photo-1536936343740-68cb2a95f935?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by-wYWdlfHx8fGVufDB8fHx8fA%3D%3D',
                isRain: true
            }, // –ì—Ä–æ–∑–∞ –Ω–æ—á—å, —Å —ç—Ñ—Ñ–µ–∫—Ç–æ–º –¥–æ–∂–¥—è
            '13d': {
                image: 'https://images.unsplash.com/photo-1639787422603-67df3f9759e2?q=80&w=1529&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by-wYWdlfHx8fGVufDB8fHx8fA%3D%3D',
                isSnow: true
            }, // –°–Ω–µ–≥ –¥–µ–Ω—å, —Å —ç—Ñ—Ñ–µ–∫—Ç–æ–º —Å–Ω–µ–≥–∞
            '13n': {
                image: 'https://images.unsplash.com/photo-1680952120987-94e0b0b72a6f?q=80&w=1472&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by-wYWdlfHx8fGVufDB8fHx8fA%3D%3D',
                isSnow: true
            },  // –°–Ω–µ–≥ –Ω–æ—á—å, —Å —ç—Ñ—Ñ–µ–∫—Ç–æ–º —Å–Ω–µ–≥–∞
            '50d': {
                image: 'https://images.unsplash.com/photo-1484862175261-080871e01911?q=80&w=1452&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by-wYWdlfHx8fGVufDB8fHx8fA%3D%3D'
            }, // –¢—É–º–∞–Ω –¥–µ–Ω—å
            '50n': {
                image: 'https://images.unsplash.com/photo-1623763749249-3299a7c1b25f?q=80&w=1469&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by-wYWdlfHx8fGVufDB8fHx8fA%3D%3D'
            },  // –¢—É–º–∞–Ω –Ω–æ—á—å
            'error': {
                image: 'https://images.unsplash.com/photo-1525490829609-d166ddb58678?q=80&w=1469&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by-wYWdlfHx8fGVufDB8fHx8fA%3D%3D'
            }  // –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –∫–æ–¥ –ø–æ–≥–æ–¥—ã –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω
        };

        const backgroundData = backgroundMapping[iconCode] || backgroundMapping['error'];
        body.style.backgroundImage = `url(${backgroundData.image})`;
        body.classList.remove('rain-bg', 'snow-bg');
        document.querySelectorAll('.rain, .snow').forEach(el => el.remove());
        if (backgroundData.isRain) {
            body.classList.add('rain-bg');
            createRain(iconCode, windSpeed);
        } else if (backgroundData.isSnow) {
            body.classList.add('snow-bg');
            createSnow(iconCode, windSpeed);
        }
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∞ –¥–æ–∂–¥—è
    function createRain(iconCode, windSpeed = 0) {
        const rainDrops = 100;
        for (let i = 0; i < rainDrops; i++) {
            const rainDrop = document.createElement('div');
            rainDrop.textContent = 'üíß';
            rainDrop.classList.add('rain');
            rainDrop.style.left = `${getRandomNumber(0, 100)}vw`;
            rainDrop.style.top = `-${getRandomNumber(10, 50)}px`;
            rainDrop.style.animationDuration = `${getRandomNumber(5, 15) - windSpeed / 2}s`;
            rainDrop.style.animationDelay = `${getRandomNumber(0, 5)}s`;
            rainDrop.style.opacity = Math.random() / 1.5 + 0.3;
            rainDrop.style.fontSize = `${getRandomNumber(1, 1.4)}rem`;
            rainDrop.style.transform = `skewY(${windSpeed * 3 - 10}deg)`;
            document.body.appendChild(rainDrop);
            rainDrop.addEventListener('animationend', () => {
                rainDrop.remove();
            });
        }
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∞ —Å–Ω–µ–≥–∞
    function createSnow(iconCode, windSpeed = 0) {
        const snowFlakes = 100;
        for (let i = 0; i < snowFlakes; i++) {
            const snowFlake = document.createElement('div');
            snowFlake.textContent = '‚ùÖ';
            snowFlake.classList.add('snow');
            snowFlake.style.left = `${getRandomNumber(0, 100)}vw`;
            snowFlake.style.top = `-${getRandomNumber(10, 50)}px`;
            snowFlake.style.fontSize = `${getRandomNumber(1, 2)}rem`;
            snowFlake.style.animationDuration = `${getRandomNumber(5, 15) - windSpeed / 4}s`;
            snowFlake.style.transform = `skewX(${windSpeed * 3}deg)`;
            snowFlake.style.animationDelay = `${getRandomNumber(0, 5)}s`;
            snowFlake.style.opacity = Math.random() / 1.5 + 0.3;
            document.body.appendChild(snowFlake);
            snowFlake.addEventListener('animationend', () => {
                snowFlake.remove();
            });
        }
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —á–∏—Å–ª–∞
    function getRandomNumber(min, max) {
        return Math.random() * (max - min) + min;
    }


    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π



// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à–∏ Enter
document.addEventListener('keydown', function (event) {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞–∂–∞—Ç–∞ –ª–∏ –∫–ª–∞–≤–∏—à–∞ Enter (–∫–æ–¥ 13)
    if (event.key === 'Enter' || event.keyCode === 13) {
        // –ï—Å–ª–∏ city-input —Å–∫—Ä—ã—Ç, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –µ–≥–æ
        if (cityInput.style.display === 'none') {
            cityInput.style.display = 'block';
            cityInput.focus();
        }
    }
});;

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–≤–æ–π–Ω–æ–≥–æ –∫–ª–∏–∫–∞ –≤–Ω–µ –≤–∏–¥–∂–µ—Ç–∞
document.body.addEventListener('dblclick', function (event) {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–ª–∏–∫ –ø—Ä–æ–∏–∑–æ—à–µ–ª –≤–Ω–µ –≤–∏–¥–∂–µ—Ç–∞
    if (!weatherWidget.contains(event.target)) {
        // –ï—Å–ª–∏ city-input –≤–∏–¥–µ–Ω, —Å–∫—Ä—ã–≤–∞–µ–º –µ–≥–æ
        if (cityInput.style.display === 'block') {
            cityInput.style.display = 'none';
        } else {
            // –ò–Ω–∞—á–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º city-input
            cityInput.style.display = 'block';
            cityInput.focus();
        }
    }
});

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ city-input (—á—Ç–æ–±—ã –Ω–µ —Å–∫—Ä—ã–≤–∞—Ç—å –µ–≥–æ –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ —Å–∞–º–æ –ø–æ–ª–µ)
cityInput.addEventListener('click', function (event) {
    event.stopPropagation();
});

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤–≤–æ–¥–∞ –≤ city-input
cityInput.addEventListener('keydown', function (event) {
    if (event.key === 'Enter') {
        const newCity = cityInput.value.trim();
        if (newCity) {
            updateWeather(newCity);
        }
        cityInput.style.display = 'none';
        cityInput.value = '';
    }
});

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à–∏ Esc
document.addEventListener('keydown', function (event) {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞–∂–∞—Ç–∞ –ª–∏ –∫–ª–∞–≤–∏—à–∞ Esc (–∫–æ–¥ 27)
    if (event.key === 'Escape' || event.keyCode === 27) {
        // –ï—Å–ª–∏ city-input –≤–∏–¥–µ–Ω, —Å–∫—Ä—ã–≤–∞–µ–º –µ–≥–æ
        if (cityInput.style.display === 'block') {
            cityInput.style.display = 'none';
            cityInput.value = ''; // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
        }
    }
});







// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ distance-info
distanceInfo.addEventListener('click', function () {
    // –õ–æ–≥–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –ø—Ä–∏ –∫–ª–∏–∫–µ
    console.log('–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø—Ä–∏ –∫–ª–∏–∫–µ:', {
        origin: originCoords,
        destination: cityCoordinates
    });

    // –§–æ—Ä–º–∏—Ä—É–µ–º —Å—Å—ã–ª–∫—É –¥–ª—è –Ø–Ω–¥–µ–∫—Å.–ù–∞–≤–∏–≥–∞—Ç–æ—Ä–∞
    const yandexRtext = `${originCoords.lat},${originCoords.lon}~${cityCoordinates.lat},${cityCoordinates.lon}`;
    const yandexMapsUrl = `https://yandex.ru/maps/?rtext=${yandexRtext}&rtt=auto`;
    console.log('–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞ (–Ø–Ω–¥–µ–∫—Å):', yandexMapsUrl);

    // –§–æ—Ä–º–∏—Ä—É–µ–º —Å—Å—ã–ª–∫—É –¥–ª—è Google Maps
    const googleMapsUrl = `https://www.google.com/maps/dir/${originCoords.lat},${originCoords.lon}/${cityCoordinates.lat},${cityCoordinates.lon}`;
    console.log('–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞ (Google):', googleMapsUrl);

    // –ü—Ä–æ–±—É–µ–º –æ—Ç–∫—Ä—ã—Ç—å –Ø–Ω–¥–µ–∫—Å.–ù–∞–≤–∏–≥–∞—Ç–æ—Ä
    const yandexWindow = window.open(yandexMapsUrl, '_blank');

  
});

    cityNameElement.addEventListener('click', function (event) {
        if (!cityCoordinates) {
            event.preventDefault();
        }
    });

      dateTimeElement.addEventListener('click', function(event) {
      if (cityCoordinates) {
        window.open(`https://yandex.ru/images/search?text=${encodeURIComponent(currentCity)}`, '_blank');
      } else {
            event.preventDefault();
        }
    });
    
    const currentWeatherElement = document.querySelector('.current-weather');
    currentWeatherElement.addEventListener('click', function (event) {
        if (!iconLink.href || iconLink.href === '#') {
            event.preventDefault();
        }
    });
    


    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    updateWeather(currentCity);
    setInterval(updateDateTime, 10000); // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫
</script>
</body>
</html>