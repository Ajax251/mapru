<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windows 11 Cloud</title>
    <!-- Иконки -->
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <!-- Supabase Client -->
  
    <script src="webfonts/supabase-js@2.js"></script>
    <style>
        :root {
            --bg-color: #f3f3f3;
            --win-bg: rgba(255, 255, 255, 0.95);
            --taskbar-bg: rgba(243, 243, 243, 0.85);
            --primary-color: #0067c0;
            --sel-color: #cce8ff;
            --hover-color: #e5f3ff;
        }
        * { box-sizing: border-box; user-select: none; margin: 0; padding: 0; outline: none; font-family: 'Segoe UI', sans-serif; }
        
        body {
            overflow: hidden; height: 100vh;
            background: url('https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?q=80&w=2564') no-repeat center center/cover;
            display: flex; flex-direction: column;
        }

        /* --- Lock Screen --- */
        #lock-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: inherit; z-index: 10000;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            backdrop-filter: blur(10px);
            transition: top 0.6s ease-in-out, opacity 0.6s;
        }
        #lock-screen.hidden { top: -100%; opacity: 0; pointer-events: none; }
        
        .ls-content { display: flex; flex-direction: column; align-items: center; }
        .ls-time { font-size: 64px; color: white; margin-bottom: 10px; font-weight: 300; }
        .ls-date { font-size: 20px; color: white; margin-bottom: 60px; }
        
        .auth-box {
            background: rgba(255,255,255,0.9); padding: 30px; border-radius: 8px;
            width: 300px; text-align: center; display: flex; flex-direction: column; gap: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }
        .auth-avatar { width: 80px; height: 80px; background: #fff; border-radius: 50%; margin: 0 auto 10px; display: flex; justify-content: center; align-items: center; font-size: 40px; color: #555; }
        .auth-input { padding: 8px 12px; border: 1px solid #ccc; border-radius: 4px; width: 100%; }
        .auth-btn { padding: 8px; background: var(--primary-color); color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 500; }
        .auth-btn:hover { background: #005a9e; }
        .auth-link { font-size: 12px; color: var(--primary-color); cursor: pointer; margin-top: 5px; }
        .auth-link:hover { text-decoration: underline; }
        .error-msg { color: red; font-size: 11px; height: 15px; }

        /* --- Desktop --- */
        .desktop { flex: 1; padding: 10px; display: flex; flex-direction: column; gap: 10px; position: relative; align-items: flex-start; }
        
        .user-widget {
            position: absolute; top: 15px; right: 15px;
            background: rgba(0,0,0,0.2); padding: 5px 15px; border-radius: 20px;
            display: flex; align-items: center; gap: 10px; color: white;
            backdrop-filter: blur(5px); cursor: default;
        }
        .user-widget-avatar { width: 24px; height: 24px; background: white; border-radius: 50%; display: flex; justify-content: center; align-items: center; color: #333; font-size: 16px; }

        .desktop-icon {
            width: 80px; display: flex; flex-direction: column; align-items: center;
            cursor: pointer; padding: 8px 5px; border-radius: 4px; color: white;
            text-shadow: 0 1px 2px rgba(0,0,0,0.8); transition: 0.2s;
        }
        .desktop-icon:hover { background: rgba(255,255,255,0.1); }
        .desktop-icon i { font-size: 36px; margin-bottom: 5px; color: #4db2ff; }
        .desktop-icon span { font-size: 12px; text-align: center; line-height: 1.2; }

        /* --- Window System --- */
        .window {
            position: absolute; background: var(--win-bg); backdrop-filter: blur(20px);
            border-radius: 8px; box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            border: 1px solid #aaa; display: flex; flex-direction: column;
            overflow: hidden; opacity: 0; pointer-events: none; transform: scale(0.95);
            transition: 0.2s;
        }
        .window.show { opacity: 1; pointer-events: auto; transform: scale(1); }
        .window.maximized { top: 0 !important; left: 0 !important; width: 100% !important; height: calc(100% - 48px) !important; border-radius: 0; transform: none !important; }

        .win-header {
            height: 32px; display: flex; justify-content: space-between; align-items: center;
            padding-left: 10px; background: transparent; flex-shrink: 0;
        }
        .win-title { font-size: 12px; color: #333; display: flex; align-items: center; gap: 8px; }
        .win-controls { display: flex; height: 100%; }
        .win-btn { width: 45px; height: 100%; display: flex; justify-content: center; align-items: center; font-size: 14px; cursor: pointer; transition: 0.2s; }
        .win-btn:hover { background: rgba(0,0,0,0.1); }
        .win-btn.close:hover { background: #e81123; color: white; }

        /* Explorer */
        #explorer { width: 800px; height: 500px; top: 10%; left: 15%; }
        .exp-toolbar { padding: 8px; border-bottom: 1px solid #eee; display: flex; gap: 10px; background: rgba(255,255,255,0.5); }
        .exp-btn { display: flex; align-items: center; gap: 5px; padding: 4px 10px; border-radius: 4px; cursor: pointer; font-size: 13px; border: 1px solid transparent; background: transparent; }
        .exp-btn:hover { background: rgba(0,0,0,0.05); }
        .exp-btn.blue { color: var(--primary-color); }
        
        .exp-layout { flex: 1; display: flex; overflow: hidden; }
        .exp-sidebar { width: 180px; padding: 10px; background: rgba(255,255,255,0.4); border-right: 1px solid #eee; }
        .side-item { padding: 8px; border-radius: 4px; cursor: pointer; display: flex; gap: 10px; font-size: 13px; align-items: center; color: #444; }
        .side-item:hover { background: rgba(0,0,0,0.05); }
        .side-item.active { background: rgba(0,0,0,0.08); color: var(--primary-color); font-weight: 500; }
        
        .exp-content { flex: 1; padding: 10px; background: white; overflow-y: auto; }
        .file-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 10px; }
        .file-item { display: flex; flex-direction: column; align-items: center; padding: 10px; border-radius: 4px; cursor: pointer; text-align: center; border: 1px solid transparent; }
        .file-item:hover { background: var(--hover-color); }
        .file-item.selected { background: var(--sel-color); border-color: #99d1ff; }
        .f-icon { font-size: 36px; margin-bottom: 5px; }
        .f-name { font-size: 11px; word-break: break-word; line-height: 1.3; }

        /* Notepad */
        #notepad { width: 500px; height: 400px; top: 15%; left: 30%; background: white; }
        .np-menu { padding: 5px 10px; border-bottom: 1px solid #eee; font-size: 12px; }
        .np-area { flex: 1; border: none; resize: none; padding: 10px; font-family: monospace; font-size: 14px; }

        /* Photo Viewer */
        #photoviewer { width: 700px; height: 500px; top: 12%; left: 20%; background: #222; }
        #photoviewer .win-title { color: white; } #photoviewer .win-btn { color: white; }
        .pv-body { flex: 1; display: flex; justify-content: center; align-items: center; overflow: hidden; }
        #pv-img { max-width: 100%; max-height: 100%; object-fit: contain; }

        /* Taskbar */
        .taskbar {
            height: 48px; background: var(--taskbar-bg); backdrop-filter: blur(20px);
            display: flex; justify-content: center; align-items: center; z-index: 9999;
            border-top: 1px solid rgba(255,255,255,0.4);
        }
        .tb-icons { display: flex; gap: 5px; }
        .tb-icon {
            width: 40px; height: 40px; border-radius: 4px; display: flex;
            justify-content: center; align-items: center; cursor: pointer; transition: 0.2s; position: relative;
        }
        .tb-icon:hover { background: rgba(255,255,255,0.5); }
        .tb-icon.active::after { content: ''; position: absolute; bottom: 3px; width: 12px; height: 3px; background: var(--primary-color); border-radius: 2px; }
        .tb-icon i { font-size: 24px; }
        
        .start-btn { position: absolute; left: 10px; cursor: pointer; }
        .tb-clock { position: absolute; right: 15px; text-align: right; font-size: 12px; color: #222; }

        /* Context Menu */
        #ctxMenu {
            position: absolute; width: 150px; background: #f9f9f9; 
            border: 1px solid #ccc; border-radius: 5px; box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            display: none; flex-direction: column; padding: 4px; z-index: 100000;
        }
        .ctx-item { padding: 6px 10px; display: flex; align-items: center; gap: 8px; font-size: 12px; cursor: pointer; border-radius: 3px; color: #333; }
        .ctx-item:hover { background: var(--primary-color); color: white; }

        .c-yellow { color: #ffe68e; } .c-blue { color: #4db2ff; }
    </style>
</head>
<body>

    <!-- LOCK SCREEN & AUTH -->
    <div id="lock-screen">
        <div class="ls-content">
            <div class="ls-time" id="ls-time">12:00</div>
            <div class="ls-date" id="ls-date">Дата</div>
            
           <div class="auth-box">
                <div class="auth-avatar"><i class='bx bxs-user'></i></div>
                <div style="font-weight:bold; font-size:18px; margin-bottom: 10px;">Вход</div>
                
                <!-- Единственная кнопка входа -->
                <button class="auth-btn" style="background: #fff; color: #444; border: 1px solid #ddd; display: flex; align-items: center; justify-content: center; gap: 10px;" onclick="loginWithGoogle()">
                    <i class='bx bxl-google' style="color: #db4437; font-size: 20px;"></i>
                    Войти через Google
                </button>
                
                <div class="error-msg" id="auth-error"></div>
            </div>
        </div>
    </div>

    <!-- DESKTOP -->
    <div id="ctxMenu"></div>
    
    <div class="desktop" id="desktop" onclick="deselectAll()">
        <div class="user-widget">
            <div class="user-widget-avatar"><i class='bx bxs-user'></i></div>
            <span id="widget-username">Пользователь</span>
        </div>

        <div class="desktop-icon" onclick="openApp('explorer')">
            <i class='bx bxs-folder'></i>
            <span>Этот<br>компьютер</span>
        </div>
        <div class="desktop-icon" onclick="openApp('yandex')">
            <div style="width:32px; height:32px; background:white; border-radius:50%; display:flex; justify-content:center; align-items:center; margin-bottom:5px">
                <span style="color:red; font-weight:bold; font-size:18px">Я</span>
            </div>
            <span>Yandex</span>
        </div>
    </div>

    <!-- WINDOW: EXPLORER -->
    <div class="window" id="explorer" onmousedown="focusWin('explorer')">
        <div class="win-header" id="explorer-header">
            <div class="win-title"><i class='bx bxs-folder c-yellow'></i> Проводник</div>
            <div class="win-controls">
                <div class="win-btn" onclick="minWindow('explorer')"><i class='bx bx-minus'></i></div>
                <div class="win-btn" onclick="maxWindow('explorer')"><i class='bx bx-square'></i></div>
                <div class="win-btn close" onclick="closeWindow('explorer')"><i class='bx bx-x'></i></div>
            </div>
        </div>
        <div class="exp-toolbar">
            <button class="exp-btn blue" onclick="document.getElementById('upl').click()"><i class='bx bx-plus'></i> Создать / Загрузить</button>
            <input type="file" id="upl" hidden multiple onchange="uploadFiles(event)">
            <div style="width:1px; background:#ddd; height:20px"></div>
            <button class="exp-btn" onclick="fsCreateFolder()"><i class='bx bx-folder-plus'></i> Папка</button>
            <button class="exp-btn" onclick="fsDelete()"><i class='bx bx-trash'></i> Удалить</button>
            <button class="exp-btn" onclick="loadFiles()"><i class='bx bx-refresh'></i></button>
        </div>
        <div class="exp-layout">
            <div class="exp-sidebar">
                <div class="side-item active" id="nav-desktop" onclick="navigate('desktop')"><i class='bx bx-desktop'></i> Рабочий стол</div>
                <div class="side-item" id="nav-downloads" onclick="navigate('downloads')"><i class='bx bx-download'></i> Загрузки</div>
                <div class="side-item" id="nav-documents" onclick="navigate('documents')"><i class='bx bx-file'></i> Документы</div>
                <div class="side-item" id="nav-images" onclick="navigate('images')"><i class='bx bx-image'></i> Изображения</div>
            </div>
            <div class="exp-content" id="file-view" onclick="event.stopPropagation(); deselectAll()">Loading...</div>
        </div>
    </div>

    <!-- WINDOW: NOTEPAD -->
    <div class="window" id="notepad" onmousedown="focusWin('notepad')">
        <div class="win-header" id="notepad-header">
            <div class="win-title"><i class='bx bxs-notepad c-blue'></i> Блокнот</div>
            <div class="win-controls">
                <div class="win-btn close" onclick="closeWindow('notepad')"><i class='bx bx-x'></i></div>
            </div>
        </div>
        <div class="np-menu">
            <span style="cursor:pointer; font-weight:bold" onclick="saveNotepad()">Файл (Сохранить)</span>
        </div>
        <textarea class="np-area" id="np-text"></textarea>
    </div>

    <!-- WINDOW: PHOTO VIEWER -->
    <div class="window" id="photoviewer" onmousedown="focusWin('photoviewer')">
        <div class="win-header" id="photoviewer-header">
            <div class="win-title"><i class='bx bxs-image'></i> Фотографии</div>
            <div class="win-controls">
                <div class="win-btn close" onclick="closeWindow('photoviewer')"><i class='bx bx-x'></i></div>
            </div>
        </div>
        <div class="pv-body">
            <img id="pv-img" src="">
        </div>
    </div>

    <!-- TASKBAR -->
    <div class="taskbar">
        <div class="start-btn" onclick="doLogout()"><i class='bx bx-power-off' style="font-size:24px; color:#333"></i></div>
        <div class="tb-icons">
            <div class="tb-icon" id="tb-explorer" onclick="openApp('explorer')"><i class='bx bxs-folder c-yellow'></i></div>
            <div class="tb-icon" id="tb-yandex" onclick="window.open('https://ya.ru', '_blank')"><span style="color:red; font-weight:bold">Я</span></div>
            <div class="tb-icon" id="tb-notepad" onclick="openApp('notepad')" style="display:none"><i class='bx bxs-notepad c-blue'></i></div>
            <div class="tb-icon" id="tb-photoviewer" onclick="openApp('photoviewer')" style="display:none"><i class='bx bxs-image'></i></div>
        </div>
        <div class="tb-clock" id="clock">12:00<br>01.01.2025</div>
    </div>

    <script>
        // ===============================================
        //  НАСТРОЙКИ SUPABASE (ЗАМЕНИТЕ НА СВОИ!)
        // ===============================================
        const SUPABASE_URL = 'https://qgycxcmxlbyrjpdikyyz.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFneWN4Y214bGJ5cmpwZGlreXl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQzOTAxNTgsImV4cCI6MjA3OTk2NjE1OH0.UtamcsWCKPpMJwH1cWJhRhh8TL7Jb_NPA0-xLpyk_YU';
        // ===============================================

         const sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        let currentUser = null;
        let isRegister = false;
        let files = [];
        let currentPath = 'desktop';
        let selectedIds = [];
        let openFileId = null;

       // --- AUTH ---
        window.addEventListener('load', async () => {
            updateClock(); setInterval(updateClock, 1000);
            
            // Проверка сессии (в том числе после возврата от Google)
            const { data: { session } } = await sb.auth.getSession();
            
            if(session) {
                authSuccess(session.user);
            }
            
            // Слушатель изменений авторизации (сработает сразу после редиректа от Google)
            sb.auth.onAuthStateChange((event, session) => {
                if (event === 'SIGNED_IN' && session) {
                    authSuccess(session.user);
                }
            });
        });

        async function loginWithGoogle() {
            const { data, error } = await sb.auth.signInWithOAuth({
                provider: 'google',
                options: {
                    // Важно: куда вернуть пользователя после Google
                    redirectTo: window.location.href 
                }
            });
            if (error) {
                document.getElementById('auth-error').innerText = error.message;
            }
        }

        function authSuccess(user) {
            currentUser = user;
            // Берем имя из Google аккаунта или email
            const name = user.user_metadata.full_name || user.email.split('@')[0];
            
            document.getElementById('widget-username').innerText = name;
            document.getElementById('lock-screen').classList.add('hidden');
            loadFiles();
        }

        async function doLogout() {
            await sb.auth.signOut();
            window.location.reload();
        }

        // --- FILESYSTEM ---
        async function loadFiles() {
            if(!currentUser) return;
            // Используем sb
            const { data, error } = await sb.from('files').select('*');
            if(!error) {
                files = data;
                renderFiles();
            }
        }

        async function uploadFiles(e) {
            const upFiles = Array.from(e.target.files);
            if(!upFiles.length) return;

            for(let file of upFiles) {
                const safeName = file.name.replace(/[<>:"/\\|?*]/g, '');
                
                let type = 'file';
                if(file.type.startsWith('image/')) type = 'img';
                else if(file.type.includes('text')) type = 'txt';

                let storagePath = null;
                let content = null;

                if(type === 'txt' && file.size < 100000) {
                    content = await file.text();
                } else {
                    const path = `${currentUser.id}/${Date.now()}_${safeName}`;
                    // Используем sb.storage
                    const { error } = await sb.storage.from('user_files').upload(path, file);
                    if(error) { alert('Ошибка загрузки: ' + error.message); continue; }
                    storagePath = path;
                }

                // Используем sb.from
                await sb.from('files').insert({
                    name: safeName,
                    type: type,
                    parent_id: currentPath,
                    content: content,
                    storage_path: storagePath,
                    user_id: currentUser.id
                });
            }
            e.target.value = '';
            loadFiles();
        }

        async function fsCreateFolder() {
            const name = prompt("Имя папки:", "Новая папка");
            if(name) {
                await sb.from('files').insert({
                    name: name, type: 'folder', parent_id: currentPath, user_id: currentUser.id
                });
                loadFiles();
            }
        }

        async function fsDelete() {
            if(!selectedIds.length) return;
            const toDel = files.filter(f => selectedIds.includes(f.id));
            
            for(let f of toDel) {
                if(f.storage_path) {
                    await sb.storage.from('user_files').remove([f.storage_path]);
                }
                await sb.from('files').delete().eq('id', f.id);
            }
            selectedIds = [];
            loadFiles();
        }

        async function saveNotepad() {
            const val = document.getElementById('np-text').value;
            if(openFileId) {
                await sb.from('files').update({ content: val }).eq('id', openFileId);
            } else {
                await sb.from('files').insert({
                    name: 'New Text.txt', type: 'txt', parent_id: 'desktop', content: val, user_id: currentUser.id
                });
            }
            loadFiles();
            alert('Сохранено!');
        }

        // --- NAVIGATION & UI ---
        function navigate(path) {
            currentPath = path;
            selectedIds = [];
            document.querySelectorAll('.side-item').forEach(el => el.classList.remove('active'));
            const btn = document.getElementById('nav-'+path);
            if(btn) btn.classList.add('active');
            renderFiles();
        }

        function enterFolder(id) {
            currentPath = id;
            selectedIds = [];
            renderFiles();
        }

        function renderFiles() {
            const view = document.getElementById('file-view');
            view.innerHTML = '';
            const currentFiles = files.filter(f => f.parent_id === String(currentPath));

            if(currentFiles.length === 0) {
                view.innerHTML = '<div style="color:#999; text-align:center; margin-top:50px">Пусто</div>';
                return;
            }

            const grid = document.createElement('div');
            grid.className = 'file-grid';
            currentFiles.forEach(f => {
                const el = document.createElement('div');
                el.className = `file-item ${selectedIds.includes(f.id) ? 'selected' : ''}`;
                el.innerHTML = `${getIcon(f.type)}<div class="f-name">${f.name}</div>`;
                el.onclick = (e) => { e.stopPropagation(); selectedIds = [f.id]; renderFiles(); };
                el.ondblclick = () => openFile(f);
                el.oncontextmenu = (e) => showContext(e, f);
                grid.appendChild(el);
            });
            view.appendChild(grid);
        }

        function getIcon(type) {
            if(type==='folder') return `<i class='bx bxs-folder c-yellow f-icon'></i>`;
            if(type==='img') return `<i class='bx bxs-image c-blue f-icon'></i>`;
            if(type==='txt') return `<i class='bx bxs-file-txt f-icon' style="color:#777"></i>`;
            return `<i class='bx bxs-file f-icon' style="color:#aaa"></i>`;
        }

        function deselectAll() { selectedIds = []; renderFiles(); }

        // --- APP LAUNCHER ---
        async function openFile(f) {
            if(f.type === 'folder') enterFolder(f.id);
            else if(f.type === 'txt') {
                openApp('notepad');
                document.getElementById('np-text').value = f.content || '';
                openFileId = f.id;
            }
            else if(f.type === 'img' && f.storage_path) {
                // Используем sb.storage
                const { data } = await sb.storage.from('user_files').createSignedUrl(f.storage_path, 3600);
                if(data) {
                    openApp('photoviewer');
                    document.getElementById('pv-img').src = data.signedUrl;
                }
            }
        }

        let zIndex = 100;
        function openApp(id) {
            const win = document.getElementById(id);
            const tb = document.getElementById('tb-' + id);
            win.classList.add('show');
            if(tb) { tb.style.display = 'flex'; tb.classList.add('active'); }
            focusWin(id);
            if(id === 'notepad' && !openFileId) document.getElementById('np-text').value = '';
        }

        function closeWindow(id) {
            const win = document.getElementById(id);
            win.classList.remove('show'); win.classList.remove('maximized');
            const tb = document.getElementById('tb-' + id);
            if(tb) { tb.classList.remove('active'); if(id!=='explorer') setTimeout(()=>tb.style.display='none', 200); }
            if(id==='notepad') openFileId = null;
        }

        function focusWin(id) {
            document.getElementById(id).style.zIndex = ++zIndex;
        }
        function minWindow(id) { document.getElementById(id).classList.remove('show'); }
        function maxWindow(id) { document.getElementById(id).classList.toggle('maximized'); }

        // --- CONTEXT MENU & DOWNLOAD ---
        const ctxMenu = document.getElementById('ctxMenu');
        function showContext(e, f) {
            e.preventDefault(); 
            if(!selectedIds.includes(f.id)) { selectedIds=[f.id]; renderFiles(); }
            ctxMenu.style.display = 'flex';
            ctxMenu.style.left = e.pageX + 'px'; ctxMenu.style.top = e.pageY + 'px';
            ctxMenu.innerHTML = `<div class="ctx-item" onclick="downloadFile('${f.id}')"><i class='bx bx-download'></i> Скачать</div>`;
        }
        document.addEventListener('click', () => ctxMenu.style.display = 'none');

        async function downloadFile(id) {
            const f = files.find(x => x.id === id);
            if(!f) return;

            let url, blob;
            if(f.content) {
                blob = new Blob([f.content], {type: 'text/plain'});
                url = URL.createObjectURL(blob);
            } else if(f.storage_path) {
                // Используем sb.storage
                const { data, error } = await sb.storage.from('user_files').download(f.storage_path);
                if(error) return alert('Ошибка: ' + error.message);
                url = URL.createObjectURL(data);
            }

            const a = document.createElement('a');
            a.href = url; a.download = f.name;
            document.body.appendChild(a); a.click(); document.body.removeChild(a);
        }

        // --- DRAG & DROP ---
        function makeDraggable(id) {
            const win = document.getElementById(id);
            const head = document.getElementById(id + '-header');
            let isDown = false, offX, offY;
            head.onmousedown = (e) => { 
                if(e.target.closest('.win-btn')) return;
                isDown = true; 
                offX = e.clientX - win.offsetLeft; offY = e.clientY - win.offsetTop;
                focusWin(id);
            };
            window.onmousemove = (e) => {
                if(isDown && !win.classList.contains('maximized')) {
                    win.style.left = (e.clientX - offX) + 'px';
                    win.style.top = (e.clientY - offY) + 'px';
                }
            };
            window.onmouseup = () => isDown = false;
        }
        makeDraggable('explorer'); makeDraggable('notepad'); makeDraggable('photoviewer');

        function updateClock() {
            const d = new Date();
            document.getElementById('clock').innerHTML = d.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'}) + '<br>' + d.toLocaleDateString();
            document.getElementById('ls-time').innerText = d.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
            document.getElementById('ls-date').innerText = d.toLocaleDateString('ru-RU', {weekday:'long', day:'numeric', month:'long'});
        }
    
    </script>
</body>
</html>